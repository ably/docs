---
title: "Error 40164 - API key missing revocable tokens attribute"
meta_description: "Information and troubleshooting for Ably error code 40164 - API key missing revocableTokens attribute for token revocation"
meta_keywords: "Ably, error, error codes, 40164, token revocation, revocableTokens, API key attributes"
---

{/* Generated by: ably-os errors document-error-codes */}
{/* Repository: https://github.com/ably/ably-os */}
{/* Command: ./bin/ably-os errors document-error-codes 40164 */}
{/* Generated: 2025-11-07T01-37-30-412Z */}
{/* Sources:
     - Analysis: https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40164-analysis.md
     - Knowledge: https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40164-knowledge.md
     - Editorial notes: https://github.com/ably/ably-os/blob/b819713/src/prompts/errors/editorial-notes.md
*/}
{/* Key Approach: Document a security validation error that requires specific API key configuration to enable token revocation functionality */}
{/* Citations: Complete source attribution with line numbers available at bottom of document */}

This error occurs when attempting to revoke tokens using an API key that doesn't have the `revocableTokens` attribute enabled.

| Error code | HTTP status code | Category | Retryable |
| ---------- | ---------------- | -------- | --------- |
| 40164 | 401 | Client error (authentication) | No |

## Error messages

The following error message is returned with error code 40164:

| Message | Description |
| ------- | ----------- |
| Can only revoke tokens issued from a key with the revocableTokens attribute set | The API key being used lacks the required `revocableTokens` attribute for performing token revocation operations. |

## Impact

This error prevents the token revocation operation from completing. However, it has no impact on:

- Existing authenticated connections or active tokens.
- Other API key capabilities like publishing, subscribing, or presence.
- Token creation or standard authentication operations.

This is an authorization error that will not be automatically retried. The API key configuration must be updated to include the `revocableTokens` attribute before token revocation operations will succeed.

## Troubleshooting

### API key missing revocableTokens attribute

This occurs when:

- The API key was created without the `revocableTokens` attribute.
- Using a legacy API key that predates the token revocation feature.
- The API key template doesn't include revocation capabilities.

To resolve this:

1. **Check your current API key configuration**
   - Log into your [Ably dashboard](https://ably.com/dashboard)
   - Navigate to your app and select the "API Keys" tab
   - Check if your key has the `revocableTokens` attribute enabled

2. **Enable the revocableTokens attribute**
   - If the key can be edited, enable the `revocableTokens` attribute
   - Save the configuration changes
   - The key can now be used for token revocation

3. **Create a new API key with revocation capability**
   - If editing isn't available, create a new API key
   - Ensure `revocableTokens` is enabled during creation
   - Replace the old key in your application configuration

{/* Source: Knowledge file advice from https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40164-knowledge.md lines 39-58 */}

### Security considerations

The `revocableTokens` attribute is a security feature that:

- Prevents accidental exposure of privileged revocation operations.
- Follows the principle of least privilege for API keys.
- Provides clear audit trails for administrative operations.
- Limits the potential impact of compromised keys.

Only enable this attribute on API keys that specifically need token revocation capabilities. Use separate keys for different operational purposes to maintain security boundaries.

{/* Source: Knowledge file security context from https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40164-knowledge.md lines 92-102 */}

## Prevention

To prevent this error:

- **Plan API key capabilities**: Identify which keys need revocation capabilities during initial setup.
- **Use key templates**: Create templates with appropriate attribute combinations for different use cases.
- **Document key purposes**: Maintain clear documentation about which keys have which capabilities.
- **Regular audits**: Periodically review API key configurations to ensure they match current requirements.

{/* Source: Prevention guidance from https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40164-knowledge.md lines 65-77 */}

## Alternative approaches

If token revocation isn't available or you choose not to enable it:

- **Use shorter token TTL**: Configure tokens with brief lifetimes to minimize the window of exposure.
- **Implement token refresh patterns**: Use regular token renewal instead of long-lived tokens.
- **Restrict token capabilities**: Grant only the minimum necessary permissions to each token.
- **Application-level session management**: Handle user sessions without relying on token revocation.

{/* Source: Alternative approaches from https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40164-knowledge.md lines 105-115 */}

## Related errors

The following errors are related to error code 40164:

| Error code | Description |
| ---------- | ----------- |
| [40133 - Wrong key for token revocation](/docs/platform/errors/codes/40133) | Occurs when attempting to revoke tokens using a different key than the one that issued them. |
| [40121 - Token revocation not enabled](/docs/platform/errors/codes/40121) | Application-level check indicating token revocation feature is not enabled for the application. |

{/* Source: Related errors from https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40164-analysis.md lines 54-56 */}

## Need further help?

Contact [Ably support](https://ably.com/support) if you're still experiencing issues after trying the steps listed above.

You'll need to provide:

- Your account ID and app ID.
- The full error message including the error code.
- Steps to reproduce the issue.
- Any relevant code snippets (without any sensitive credentials).
- The SDK and version you're using.

### Resources

The following resources provide further context or assistance with this error:

- [Authentication documentation](/docs/auth)
- [API key management](/docs/auth#api-keys)
- [Token authentication](/docs/auth#token-authentication)

{/* =============================================== */}
{/* INTERNAL DOCUMENTATION (NOT RENDERED) */}
{/* =============================================== */}

{/* SOURCES USED (ALWAYS use GitHub URLs with current SHA, never local paths):
- Analysis File: https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40164-analysis.md
- Knowledge File: https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40164-knowledge.md
- Editorial Notes: https://github.com/ably/ably-os/blob/b819713/src/prompts/errors/editorial-notes.md (No specific error-specific notes for 40164)
- Existing Documentation: None - this is new documentation
*/}

{/* CONTENT DECISIONS:
- FAQ Content Preserved: Knowledge file contained comprehensive guidance on resolution steps and security considerations
  - Resolution steps from lines 39-63
  - Security context from lines 92-102
  - Alternative approaches from lines 105-115
- Content Excluded: Repository overview files not needed as error is only in realtime server
- Recommendations Source:
  - Primary resolution from knowledge file lines 39-58 (check configuration, enable attribute, create new key)
  - Security guidance from knowledge file lines 92-102
  - Prevention from knowledge file lines 65-77
- Code Examples Rationale: No code examples included as this is a configuration issue resolved through dashboard, not code changes
*/}

{/* ATTRIBUTION BY SECTION:
- Error description: Based on analysis file line 9 and knowledge file lines 3-4
- Error messages: From analysis file line 19
- Impact: Based on knowledge context and error behavior analysis
- Troubleshooting:
  - Main resolution: Knowledge file lines 39-58
  - Security context: Knowledge file lines 92-102
- Prevention: Knowledge file lines 65-77
- Alternative approaches: Knowledge file lines 105-115
- Related errors: Analysis file lines 54-56
*/}

{/* URL Validation Completed: 2025-11-07T01-37-30-412Z */}
{/* External URLs verified: 2 | Corrected: 0 | Exempted internal: 5 */}

{/* IMPROVEMENT INSTRUCTIONS:
To improve this error code documentation:
1. First approach: Update editorial-notes.md in ably-os repository with specific guidance for error 40164
2. Regenerate: Run `./bin/ably-os errors document-error-codes 40164 --force`
3. For broader improvements: Review and update ably-os prompt templates
4. Context: See https://github.com/ably/ably-os/blob/b819713/docs/ERROR_COMMANDS_GUIDE.md
5. Source repository: https://github.com/ably/ably-os
*/}