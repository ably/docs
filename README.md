# Ably Docs

This repository is the source for content published to [https://ably.com/docs](https://ably.com/docs).

The source content is written in [Textile](https://github.com/textile/textile-spec) and the site is generated by [Gatsby](https://www.gatsbyjs.com/).

## Run locally

To run the docs site locally, follow these steps:

1. Meet these prerequisites:
  * Install Node
  * Install Yarn

2. Clone this repository and make it your working directory.

3. Run `yarn install` to install all dependencies.

4. If this is the first time running the site, run `yarn run develop:env-setup` to setup your environment variables. Visit `localhost:8000` to view the site.

5. Run `yarn run develop` and visit `localhost:8000` to view the site.

## Contribute

View the [contribution guide](CONTRIBUTING.md) for information on how to write content and contribute to Ably docs.

## Support

If you have any questions or suggestions, please [raise an issue](https://github.com/ably/docs/issues).

## Website Proxy
The Website app forwards requests to `/docs` to the `docs.ably.com` site.

Asset prefixing is applied only during the app build process and is not available in the dev version.

To ensure proper setup in your local:
1. Set the `ASSET_PREFIX=http://localhost:9000` variable in your environment.
2. Add `DOCS_BASE_URL=http://localhost:9000` to your `.env` file in the root of the Website app.
3. Ensure that `.env.production` exists in the app root for the Yarn build to function correctly.
4. You should be able to view the content and toggle between signed in and signed-out states.

## Review Apps

Review apps allow Ably organization members to create temporary deployments of the documentation site for sharing changes with stakeholders without requiring local development setup.

### Creating a Review App

To create a review app:

1. Create a pull request with your changes
2. Add the `review-app` label to your PR
3. A Heroku review app will be automatically created and deployed
4. The deployment will appear in the deployments section of your PR

### Access and Authentication

Review apps are protected with basic authentication. Contact team members for credentials if needed.

### Cleanup

Review apps are automatically cleaned up when:
- The PR is closed
- The `review-app` label is removed

### Requirements

- Only members of the Ably organization can create review apps
- The label creator's organization membership is validated before deployment
