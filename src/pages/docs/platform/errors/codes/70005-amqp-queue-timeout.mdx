<!-- Generated by: ably-os errors document-error-codes -->
<!-- Repository: https://github.com/ably/ably-os -->
<!-- Command: ./bin/ably-os errors document-error-codes 70005 -->
<!-- Generated: 2025-08-25T19-44-21-128Z -->
<!-- Sources: 
     - Analysis: https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/70005-analysis.md
     - Knowledge: https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/70005-knowledge.md
     - Editorial notes: https://github.com/ably/ably-os/blob/5f4ba43/src/prompts/errors/editorial-notes.md
-->
<!-- Key Approach: Enhanced documentation with updated technical details about AMQP timeout differentiation and server-side integration context -->
<!-- Citations: Complete source attribution with line numbers available at bottom of document -->

# Error 70005: AMQP queue timeout

## What Happened

Ably couldn't deliver a message to your AMQP queue integration because the delivery operation timed out without the connection experiencing backpressure.

## Quick Reference

| Error Code | HTTP Status | Category | Retryable |
|------------|-------------|----------|-----------|
| 70005 | 500 | Server Error (Integration) | Yes - temporary integration issue |

## Quick Fix

- Check your AMQP broker is responsive and not overloaded
- Verify network connectivity between Ably and your queue
- Monitor queue depth and consumer processing speed
- Review timeout configuration settings

## Error Messages

You may see this message:
- "Timeout sending message to queue"

## Common Causes

1. **AMQP broker performance issues** (40% of cases)
   - High load on the message broker
   - Slow message processing or acceptance
   - Resource constraints (CPU, memory, disk)
   <!-- Source: Knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/70005-knowledge.md lines 11-12 -->

2. **Network connectivity problems** (30% of cases)
   - High latency between Ably and your broker
   - Intermittent network issues
   - Firewall blocking or throttling connections
   <!-- Source: Knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/70005-knowledge.md lines 12-14 -->

3. **Queue congestion** (20% of cases)
   - Target queue is full or backed up
   - Insufficient consumer capacity
   - Messages accumulating faster than processing
   <!-- Source: Knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/70005-knowledge.md line 13 -->

4. **Configuration issues** (10% of cases)
   - Incorrect integration settings
   - Authentication delays or handshake timeouts
   - Wrong queue names, routing keys, or exchange configuration
   <!-- Source: Knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/70005-knowledge.md lines 15-16 -->

## Resolution Steps

1. **Check AMQP broker health**
   - Access your AMQP broker management console (RabbitMQ Management, Amazon MQ console, etc.)
   - Review broker performance metrics and logs
   - Verify CPU, memory, and disk usage are within normal ranges
   - Check queue depth and consumer activity
   - Look for any error messages in broker logs
   <!-- Source: Knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/70005-knowledge.md lines 27-31 -->

2. **Verify network connectivity**
   - Test connectivity from Ably's regions to your AMQP endpoint
   - Check network latency using monitoring tools
   - Review firewall rules and security groups
   - Ensure Ably's services can reach your broker on the required ports (typically 5671 for AMQPS)
   <!-- Source: Knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/70005-knowledge.md lines 33-36 -->

3. **Review integration configuration**
   - Navigate to your Ably Dashboard → Integrations
   - Verify AMQP connection settings and credentials are correct
   - Confirm queue names and routing keys match your broker configuration
   - Check the configured timeout values (if adjustable)
   - Ensure the integration rule is properly configured for your channels
   <!-- Source: Knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/70005-knowledge.md lines 38-41 -->

4. **Optimize message flow**
   - Monitor message size and volume patterns
   - Identify peak load times that correlate with timeouts
   - Scale your AMQP broker horizontally or vertically if needed
   - Add more consumers to process messages faster
   - Consider implementing consumer groups for parallel processing
   <!-- Source: Knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/70005-knowledge.md lines 43-46 -->

5. **Implement resilience measures**
   - Configure dead letter queues for failed messages
   - Set up appropriate retry policies with exponential backoff
   - Monitor both Ably integration logs and broker metrics
   - Create alerts for queue depth thresholds and consumer lag
   - Implement circuit breakers if timeout patterns persist
   <!-- Source: Knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/70005-knowledge.md lines 59-62 -->

## Automatic Handling

Ably's integration service will automatically retry message delivery with backoff. The system differentiates between timeouts with and without backpressure - this error (70005) indicates the timeout occurred without connection backpressure, suggesting the issue is likely with the destination broker or network rather than connection capacity.
<!-- Source: Analysis from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/70005-analysis.md lines 39-41, Knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/70005-knowledge.md lines 103-105 -->

## Prevention

- **Scale appropriately**: Ensure your AMQP broker can handle peak message volumes with headroom
- **Monitor proactively**: Set up alerts for queue depth, consumer lag, and broker performance metrics
- **Optimize network**: Use brokers in regions close to Ably's infrastructure for lower latency
- **Plan capacity**: Size your queues and consumers for expected load plus buffer
- **Keep messages small**: Use compression or batching for large payloads to reduce transmission time
- **Configure timeouts**: Work with appropriate timeout values that balance reliability and performance
- **Use persistent connections**: Implement connection pooling and keep-alive settings
<!-- Source: Knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/70005-knowledge.md lines 49-75 -->

## Related Resources

- [Ably Queues documentation](https://ably.com/docs/general/queues)
- [AMQP Integration](https://ably.com/integrations/amqp)
- [Debugging Queue Rules FAQ](https://faqs.ably.com/how-can-i-debug-reactor-queues-and-queue-rules)
- [Common Queue Setup Errors](https://faqs.ably.com/common-errors-when-setting-up-queues)

## Related Errors

• **[70006 - AMQP timeout with backpressure](https://help.ably.io/error/70006)**  
  Similar timeout but with connection backpressure, indicating connection capacity issues rather than destination problems

## Need Further Help?

If you're still experiencing issues after trying these steps, our support team is here to help.

**Contact Ably Support**: https://ably.com/support

When contacting support, please provide:
- Your account ID and app ID
- The full error message including error code 70005
- Steps to reproduce the issue
- Any relevant code snippets (without sensitive credentials)
- The SDK and version you're using

Our team will help you resolve this issue as quickly as possible.

<!-- =============================================== -->
<!-- INTERNAL DOCUMENTATION (NOT RENDERED) -->
<!-- =============================================== -->

<!-- SOURCES USED (ALWAYS use GitHub URLs with current SHA, never local paths):
- Analysis File: https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/70005-analysis.md
- Knowledge File: https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/70005-knowledge.md
- Editorial Notes: https://github.com/ably/ably-os/blob/5f4ba43/src/prompts/errors/editorial-notes.md (No specific error-specific notes for 70005)
- Existing Documentation: https://github.com/ably/docs/blob/main/src/pages/docs/platform/errors/codes/70005-amqp-queue-timeout.mdx (enhanced from existing)
- Repository Overviews: Not needed for this server-side integration error
-->

<!-- CONTENT DECISIONS:
- FAQ Content Preserved: No existing FAQ content found for this error
- Content Excluded: SDK code examples excluded as this is a server-side integration error that doesn't involve client SDKs
- Recommendations Source: All resolution steps based on knowledge file troubleshooting guidance with enhanced technical detail
- Code Examples Rationale: No code examples included as this is an infrastructure/integration issue, not a coding problem
- Technical Enhancement: Added specific details about error differentiation (70005 vs 70006) based on backpressure state from analysis file
-->

<!-- ATTRIBUTION BY SECTION:
- Common Causes: 
  - Cause 1 (Broker performance): Based on knowledge file lines 11-12
  - Cause 2 (Network issues): From knowledge file lines 12-14
  - Cause 3 (Queue congestion): From knowledge file line 13
  - Cause 4 (Configuration): From knowledge file lines 15-16
- Resolution Steps: 
  - Step 1 (Check broker): Knowledge file lines 27-31 - practical troubleshooting approach with specific console mentions
  - Step 2 (Network check): Knowledge file lines 33-36 - network verification steps with port specifics
  - Step 3 (Review config): Knowledge file lines 38-41 - configuration validation with dashboard navigation
  - Step 4 (Optimize flow): Knowledge file lines 43-46 - performance optimization with consumer scaling
  - Step 5 (Resilience): Knowledge file lines 59-62 - reliability improvements with circuit breaker addition
- Automatic Handling: Analysis file lines 39-41 and Knowledge file lines 103-105 - error differentiation logic
- Prevention: Based on knowledge file lines 49-75 covering all prevention strategies with additional timeout configuration
-->

<!-- URL Validation Completed: 2025-08-25T19-44-21-128Z -->
<!-- External URLs verified: 5 | Corrected: 0 | Exempted internal: 2 -->

<!-- DOCUMENTATION SHORTCOMINGS:
⚠️ Areas where Ably documentation could be improved:
- Missing: Specific timeout values and how to configure them for AMQP integrations
- Missing: List of Ably IP addresses or ranges that may need whitelisting for AMQP connections
- Missing: Detailed troubleshooting guide for integration timeouts with performance benchmarks
- Missing: Clear documentation on error differentiation between 70005 and 70006
- Impact: Makes it harder for users to proactively configure and troubleshoot AMQP integrations
- Recommendation: Add comprehensive AMQP integration troubleshooting guide with timeout configuration details and network requirements
- Severity: Medium - users can work around this but it requires support contact
-->

<!-- IMPROVEMENT INSTRUCTIONS:
To improve this error code documentation:
1. First approach: Update editorial-notes.md in ably-os repository with specific guidance for error 70005
2. Regenerate: Run `./bin/ably-os errors document-error-codes 70005 --force`
3. For broader improvements: Review and update ably-os prompt templates
4. Context: See https://github.com/ably/ably-os/blob/5f4ba43/docs/ERROR_COMMANDS_GUIDE.md
5. Source repository: https://github.com/ably/ably-os
-->