<!-- Generated by: ably-os errors document-error-codes -->
<!-- Repository: https://github.com/ably/ably-os -->
<!-- Command: ./bin/ably-os errors document-error-codes 100003 -->
<!-- Generated: 2025-08-24T21-13-57-640Z -->
<!-- Sources: 
     - Analysis: https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/100003-analysis.md
     - Knowledge: https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/100003-knowledge.md
     - Editorial notes: https://github.com/ably/ably-os/blob/5f4ba43/src/prompts/errors/editorial-notes.md
-->
<!-- Key Approach: Enhanced documentation for Asset Tracking SDK authentication failure with comprehensive troubleshooting based on fail-fast authentication strategy insights -->
<!-- Citations: Complete source attribution with line numbers available at bottom of document -->

# Error 100003: Asset Tracking authentication failure

## What Happened

The Asset Tracking SDK couldn't authenticate with Ably due to invalid or insufficient credentials. This is a permanent authentication failure that won't resolve with retries.

## Quick Reference

| Error Code | HTTP Status | Category | Retryable |
|------------|-------------|----------|-----------|
| 100003 | 403 | Authentication (Asset Tracking) | No - requires fixing credentials |

## Quick Fix

- Verify your API key or token server credentials are valid
- Ensure credentials have Asset Tracking permissions
- Check you're using the correct environment (production vs sandbox)

## Error Messages

You'll see this message:
- "Token auth non-retriable failure"

This error occurs specifically in the Ably Asset Tracking Android SDK when authentication permanently fails.

## Common Causes

<!-- Source: Analysis from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/100003-analysis.md lines 25-30 and Knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/100003-knowledge.md lines 92-131 -->

1. **Invalid API key configuration** (Most common)
   - Using an expired or revoked API key
   - Copy-paste errors in the API key string (missing characters, extra spaces)
   - Using test credentials in production environment
   - API key from wrong Ably application

2. **Insufficient token permissions**
   - Token lacks Asset Tracking channel capabilities
   - Missing publish or presence permissions for tracking channels
   - Token server not configured with correct channel patterns
   - Capability restrictions preventing location updates

3. **Token server credential issues**
   - Token server using invalid or expired Ably credentials
   - Wrong application ID in token generation process
   - Environment variables not properly configured on server
   - Token server health check failures

4. **Environment mismatch**
   - Using sandbox credentials for production resources
   - Using production credentials for sandbox resources
   - Deployment scripts using wrong credential sets
   - Manual configuration errors during setup

## Resolution Steps

<!-- Source: Resolution patterns from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/100003-knowledge.md lines 92-131 and testing strategies from lines 156-200 -->

1. **Verify your API key**
   - Log into your [Ably dashboard](https://ably.com/dashboard)
   - Navigate to your app → "API Keys" tab
   - Copy the complete API key (including the app ID prefix like `xVLyHw.rPSJgQ:...`)
   - Replace the invalid key in your Asset Tracking configuration
   - Ensure no trailing spaces or line breaks in the key
   <!-- Source: Standard Ably API key verification process from dashboard -->

2. **Check token server configuration**
   - Verify the API key used by your token server is valid and not expired
   - Ensure the token includes Asset Tracking channel permissions (`tracking:*` or specific patterns)
   - Test token generation independently before SDK initialization
   - Verify the token includes necessary capabilities: `publish`, `subscribe`, `presence`
   <!-- Source: Token server architecture from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/100003-knowledge.md lines 136-148 -->

3. **Validate environment configuration**
   - Confirm you're using the correct Ably application (production vs sandbox)
   - Verify environment-specific configuration is properly deployed
   - Check that credential environment variables are correctly set
   - Review deployment logs for credential configuration warnings
   <!-- Source: Environment mismatch patterns from knowledge file lines 122-130 -->

4. **Test authentication separately**
   - Use the Ably dashboard's API Streamer to test your credentials
   - Verify basic channel publish/subscribe works with your credentials
   - Test with a simple Ably SDK connection before Asset Tracking initialization
   - Once confirmed, retry Asset Tracking SDK initialization
   <!-- Source: Testing strategies from knowledge file lines 156-200 -->

5. **Review SDK initialization code**
   - Check that credentials are properly passed to the SDK
   - Verify no hardcoded test credentials remain in production code
   - Ensure proper error handling is implemented for authentication failures
   <!-- Source: Development best practices from knowledge file lines 172-200 -->

## Automatic Handling

The Asset Tracking SDK does not automatically retry this error. Error 100003 indicates a permanent authentication failure that requires manual intervention to fix the credential configuration. The SDK uses a fail-fast authentication strategy to prevent resource waste on unrecoverable credential issues.
<!-- Source: Non-retriable nature and fail-fast strategy from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/100003-analysis.md lines 34-37, 57 -->

## Prevention

<!-- Source: Prevention strategies from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/100003-knowledge.md lines 132-154 -->

- **Credential validation**: Test credentials during development and in CI/CD pipelines before deployment
- **Environment management**: Use separate credentials for each environment with clear naming conventions
- **Secure storage**: Store credentials in secure systems like AWS Secrets Manager or Azure Key Vault
- **Regular rotation**: Implement credential rotation procedures with proper notification systems
- **Health monitoring**: Add authentication health checks to your token server endpoints
- **Configuration testing**: Include authentication testing in automated test suites
- **Documentation**: Maintain clear documentation of required configuration parameters

## Related Errors

• **[100002 - Retriable Token Fetch Failure](https://help.ably.io/error/100002)**  
  Temporary authentication issue that the SDK will automatically retry

• **[100004 - Subscriber Never Connected](https://help.ably.io/error/100004)**  
  Connection state error that may follow authentication failures

• **[40160 - Token Capability Issues](https://help.ably.io/error/40160)**  
  Core Ably error for insufficient token permissions

## Related Resources

- [Asset Tracking Android SDK](https://github.com/ably/ably-asset-tracking-android)
- [Authentication overview](https://ably.com/docs/auth)
- [Token authentication](https://ably.com/tutorials/token-authentication)
- [Capabilities and permissions](https://ably.com/docs/auth/capabilities)
- [Asset Tracking documentation](https://ably.com/docs/asset-tracking/using-the-sdks)

## Need Further Help?

If you're still experiencing issues after trying these steps, our support team is here to help.

**Contact Ably Support**: https://ably.com/support

When contacting support, please provide:
- Your account ID and app ID
- The full error message including error code 100003
- Steps to reproduce the issue
- Any relevant code snippets (without sensitive credentials)
- The SDK and version you're using

Our team will help you resolve this issue as quickly as possible.

<!-- =============================================== -->
<!-- INTERNAL DOCUMENTATION (NOT RENDERED) -->
<!-- =============================================== -->

<!-- SOURCES USED:
- Analysis File: https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/100003-analysis.md
- Knowledge File: https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/100003-knowledge.md
- Editorial Notes: https://github.com/ably/ably-os/blob/5f4ba43/src/prompts/errors/editorial-notes.md (No specific error-specific notes for 100003)
- Existing Documentation: https://github.com/ably/docs/blob/main/src/pages/docs/platform/errors/codes/100003-asset-tracking-authentication-failure.mdx (enhanced from existing)
-->

<!-- CONTENT DECISIONS:
- FAQ Content Preserved: No existing FAQ content found for this error code in knowledge research
- Content Excluded: 
  - Detailed Kotlin code examples from knowledge file (lines 158-200) - not essential for customer resolution
  - Internal SDK exception hierarchy details from analysis file (lines 39-45) - too technical for customer docs
- Recommendations Source: 
  - Invalid API key pattern: Knowledge file lines 92-100
  - Token permission issues: Knowledge file lines 102-110  
  - Token server configuration: Knowledge file lines 112-120, 136-148
  - Environment mismatch: Knowledge file lines 122-130
  - Testing strategies: Knowledge file lines 156-200
- Code Examples Rationale: No code examples included as resolution involves credential configuration, not code changes
-->

<!-- ATTRIBUTION BY SECTION:
- Common Causes: 
  - Cause 1 (Invalid API key): Based on knowledge file lines 92-100, enhanced with specific examples
  - Cause 2 (Token permissions): From knowledge file lines 102-110, added channel pattern details
  - Cause 3 (Token server): From knowledge file lines 112-120, expanded with health check mention
  - Cause 4 (Environment): From knowledge file lines 122-130, added deployment script context
- Resolution Steps: 
  - Step 1: Standard Ably dashboard navigation with API key format example from analysis
  - Step 2: Token server guidance from knowledge file lines 136-148, added capability list
  - Step 3: Environment configuration from knowledge file lines 122-130, added deployment log check
  - Step 4: Testing approach from Ably best practices and knowledge file testing section
  - Step 5: Added based on development best practices from knowledge file lines 172-200
- Prevention: Enhanced from knowledge file lines 132-154 with specific implementation details
- Automatic Handling: Fail-fast strategy insight from analysis file lines 34-37
-->

<!-- URL Validation Completed: 2025-08-24T21-13-57-640Z -->
<!-- External URLs verified: 7 | Corrected: 0 | Exempted internal: 2 -->

<!-- DOCUMENTATION SHORTCOMINGS:
⚠️ Areas where Ably documentation could be improved:
- Missing: Specific Asset Tracking authentication setup guide separate from general auth docs
- Impact: Developers must piece together information from multiple sources
- Recommendation: Create dedicated Asset Tracking authentication guide with SDK-specific examples
- Severity: Medium - current docs are comprehensive but scattered
-->

<!-- IMPROVEMENT INSTRUCTIONS:
To improve this error code documentation:
1. First approach: Update editorial-notes.md in ably-os repository with specific guidance for error 100003
2. Regenerate: Run `./bin/ably-os errors document-error-codes 100003 --force`
3. For broader improvements: Review and update ably-os prompt templates
4. Context: See https://github.com/ably/ably-os/blob/5f4ba43/docs/ERROR_COMMANDS_GUIDE.md
5. Source repository: https://github.com/ably/ably-os
-->