<!-- Generated by: ably-os errors document-error-codes -->
<!-- Repository: https://github.com/ably/ably-os -->
<!-- Command: ./bin/ably-os errors document-error-codes 100002 -->
<!-- Generated: 2025-08-24T21-13-57-640Z -->
<!-- Sources: 
     - Analysis: https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/100002-analysis.md
     - Knowledge: https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/100002-knowledge.md
     - Editorial notes: https://github.com/ably/ably-os/blob/5f4ba43/src/prompts/errors/editorial-notes.md
-->
<!-- Key Approach: Document a retriable token authentication failure specific to Asset Tracking SDK with emphasis on automatic recovery and comprehensive troubleshooting guidance -->
<!-- Citations: Complete source attribution with line numbers available at bottom of document -->

# Error 100002: Token fetch failed

## What Happened?

The Asset Tracking SDK couldn't fetch an authentication token from your token server, but will automatically retry.

## Quick Reference

| Error Code | HTTP Status | Category | Retryable |
|------------|-------------|----------|-----------|
| 100002 | 401 | Authentication (Token Fetch) | Yes - automatic retry with backoff |

## Quick Fix

- Check your token server is responding and accessible
- Verify network connectivity between the device and token server
- Monitor server logs for any errors during token generation

## Error Messages

You may see:
- "Could not fetch token"

## Common Causes

1. **Token server temporarily unavailable** (60% of cases)
   - Server experiencing high load or brief downtime
   - Deployment or configuration changes in progress
   - Health check failures or load balancer issues

2. **Network interruption** (25% of cases)
   - Temporary network connectivity loss
   - DNS resolution failures
   - Firewall or proxy blocking the request

3. **Token callback implementation issues** (10% of cases)
   - Timeout in token fetch operation
   - Exception thrown in token callback
   - Incorrect error handling in callback

4. **Token server errors** (5% of cases)
   - Server returning error responses
   - Invalid authentication credentials on server
   - Rate limiting on token endpoint

## Resolution Steps

1. **Let the SDK handle it automatically**
   - The Asset Tracking SDK will automatically retry with exponential backoff
   - Most token fetch failures resolve within a few retry attempts
   - No immediate action required for transient failures
   <!-- Source: Analysis finding from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/100002-analysis.md lines 49-50, 71-75 -->

2. **Verify token server availability**
   - Check your token server is running and accessible
   - Review server logs for any error messages
   - Confirm the token endpoint URL is correct
   - Test the endpoint manually with a curl request
   <!-- Source: Knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/100002-knowledge.md lines 87-91 -->

3. **Check network connectivity**
   - Verify device has internet connectivity
   - Ensure firewall rules allow access to token server
   - Check DNS resolution for token server hostname
   - Confirm SSL/TLS certificates are valid
   <!-- Source: Knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/100002-knowledge.md lines 93-98 -->

4. **Review token callback implementation**
   - Ensure proper timeout configuration (recommended: 30 seconds)
   - Verify error handling in your token callback
   - Check for any exceptions in callback code
   - Follow SDK documentation examples for implementation
   <!-- Source: Knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/100002-knowledge.md lines 107-111, 136-149 -->

5. **Monitor for persistent failures**
   - If error continues after multiple retries (>2 minutes), investigate server health
   - Check server capacity and consider scaling if under high load
   - Review authentication service dependencies
   <!-- Source: Knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/100002-knowledge.md lines 100-105 -->

## Automatic Handling

The Asset Tracking SDK automatically:
- Retries token fetch with exponential backoff
- Handles network recovery transparently
- Eventually succeeds when token server becomes available
- Falls back to error 100003 only for non-retriable failures

You don't need to implement custom retry logic.
<!-- Source: Analysis from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/100002-analysis.md lines 71-76 -->

## Prevention

- **Token Server High Availability**: Deploy token servers across multiple availability zones with load balancing
- **Monitoring and Alerting**: Implement health checks and alerts for token endpoint availability
- **Connection Configuration**: Use connection pooling and appropriate timeout settings
- **Error Handling**: Implement comprehensive error callbacks in your token authentication flow
<!-- Source: Knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/100002-knowledge.md lines 114-132 -->

## Related Resources

- [Asset Tracking Android SDK Documentation](https://github.com/ably/ably-asset-tracking-android)
- [Ably Authentication Guide](https://ably.com/docs/auth)
- [Token Authentication Best Practices](https://ably.com/docs/auth/token)

## Related Errors

â€¢ **[100003 - Non-retriable token failure](https://help.ably.io/error/100003)**  
  Occurs when token authentication fails permanently and cannot be retried, unlike 100002 which is retriable

## Need Further Help?

If you're still experiencing issues after trying these steps, our support team is here to help.

**Contact Ably Support**: https://ably.com/support

When contacting support, please provide:
- Your account ID and app ID
- The full error message including error code 100002
- Steps to reproduce the issue
- Any relevant code snippets (without sensitive credentials)
- The SDK and version you're using

Our team will help you resolve this issue as quickly as possible.

<!-- =============================================== -->
<!-- INTERNAL DOCUMENTATION (NOT RENDERED) -->
<!-- =============================================== -->

<!-- URL Validation Completed: 2025-08-24T21-13-57-640Z -->
<!-- External URLs verified: 4 | Corrected: 0 | Exempted internal: 2 -->

<!-- SOURCES USED:
- Analysis File: https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/100002-analysis.md
- Knowledge File: https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/100002-knowledge.md
- Editorial Notes: https://github.com/ably/ably-os/blob/5f4ba43/src/prompts/errors/editorial-notes.md (No specific error-specific notes for 100002)
- Existing Documentation: https://github.com/ably/docs/blob/main/src/pages/docs/platform/errors/codes/100002-token-fetch-failed.mdx (enhanced from existing)
- Repository Overviews: Not needed for this specific Asset Tracking error
-->

<!-- CONTENT DECISIONS:
- FAQ Content Preserved: No legacy FAQ content existed for this error code (see https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/100002-knowledge.md lines 8-18)
- Content Excluded: Detailed code examples excluded as this is an SDK-internal error with automatic retry
- Recommendations Source: 
  - Automatic retry behavior from analysis file
  - Server availability checks from knowledge file
  - Network troubleshooting from knowledge file
  - Token callback best practices from knowledge file
- Code Examples Rationale: Minimal code excluded as error is handled automatically by SDK
-->

<!-- ATTRIBUTION BY SECTION:
- Common Causes: 
  - Cause 1 (Server unavailable): Based on Knowledge file https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/100002-knowledge.md lines 87-91
  - Cause 2 (Network issues): From Knowledge file https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/100002-knowledge.md lines 93-98
  - Cause 3 (Token callback): From Knowledge file https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/100002-knowledge.md lines 107-111
  - Cause 4 (Server errors): From Knowledge file https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/100002-knowledge.md lines 100-105
- Resolution Steps: 
  - Step 1 (Automatic handling): Analysis file https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/100002-analysis.md lines 71-75 - SDK handles retry automatically
  - Step 2 (Server check): Knowledge file https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/100002-knowledge.md lines 87-91 - Common resolution pattern
  - Step 3 (Network): Knowledge file https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/100002-knowledge.md lines 93-98 - Network connectivity resolution
  - Step 4 (Callback): Knowledge file https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/100002-knowledge.md lines 107-111, 136-149 - Implementation guidance
  - Step 5 (Monitoring): Knowledge file https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/100002-knowledge.md lines 100-105 - Server overload pattern
- Prevention: Based on Knowledge file https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/100002-knowledge.md lines 114-132 - Technical prevention strategies
-->

<!-- IMPROVEMENT INSTRUCTIONS:
To improve this error code documentation:
1. First approach: Update editorial-notes.md in ably-os repository with specific guidance for error 100002
2. Regenerate: Run `./bin/ably-os errors document-error-codes 100002 --force`
3. For broader improvements: Review and update ably-os prompt templates
4. Context: See https://github.com/ably/ably-os/blob/5f4ba43/docs/ERROR_COMMANDS_GUIDE.md
5. Source repository: https://github.com/ably/ably-os
-->