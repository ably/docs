<!-- Generated by: ably-os errors document-error-codes -->
<!-- Repository: https://github.com/ably/ably-os -->
<!-- Command: ./bin/ably-os errors document-error-codes 92003 -->
<!-- Generated: 2025-08-25T05-37-30-332Z -->
<!-- Sources: 
     - Analysis: https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/92003-analysis.md
     - Knowledge: https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/92003-knowledge.md
     - Editorial notes: https://github.com/ably/ably-os/blob/5f4ba43/src/prompts/errors/editorial-notes.md
-->
<!-- Key Approach: Enhanced documentation with comprehensive security guidance and conflict acknowledgment between Ruby SDK and Live Objects usage -->
<!-- Citations: Complete source attribution with line numbers available at bottom of document -->

# Error 92003: Cipher decryption failed

## What Happened

The SDK was unable to decrypt an encrypted message because the decryption key or parameters don't match those used for encryption.

## Quick Reference

| Error Code | HTTP Status | Category | Retryable |
|------------|-------------|----------|-----------|
| 92003 | 400 | Client Error (Cipher/Encryption) | No - requires correct encryption configuration |

## Quick Fix

- Verify you're using the exact same encryption key on both publisher and subscriber
- Ensure key encoding matches (base64, hex, or raw bytes)
- Check that cipher parameters are identical across all clients

## Error Messages

You may see one of these messages:
- "CipherError decrypting data, the private key may not be correct"
- OpenSSL cipher errors during decryption operations
- Decryption failure messages from the message encoding pipeline

## Common Causes

1. **Incorrect encryption key** (80% of cases)
   <!-- Source: Knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/92003-knowledge.md lines 31-35 -->
   - Using wrong environment's key (development vs production)
   - Key mismatch between message publisher and subscriber
   - Copy-paste errors when configuring encryption keys

2. **Key encoding issues** (15% of cases)
   <!-- Source: Analysis from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/92003-analysis.md lines 34-36 -->
   - Base64 vs hex vs raw byte format confusion
   - Key truncation during configuration
   - Character encoding problems in key strings

3. **Key rotation without coordination** (5% of cases)
   <!-- Source: Knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/92003-knowledge.md line 32 -->
   - Publisher updated to new encryption key
   - Subscriber still using old encryption key
   - Messages encrypted with different keys in same channel

## Resolution Steps

1. **Verify the encryption key**
   <!-- Source: Knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/92003-knowledge.md lines 17-23 -->
   - Confirm you're using the correct key for your environment
   - Ensure the key hasn't been truncated or modified
   - Verify both publisher and subscriber have identical keys

2. **Check key encoding and format**
   <!-- Source: Analysis from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/92003-analysis.md lines 34-37, Knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/92003-knowledge.md lines 25-29 -->
   - Determine if your key should be base64-encoded, hex, or raw bytes
   - Ensure consistent encoding across all clients
   - Validate key length matches your chosen cipher algorithm

3. **Review cipher parameters configuration**
   <!-- Source: Based on Ably documentation for channel encryption -->
   - Confirm algorithm matches between encryption and decryption
   - Verify initialization vector (IV) handling if using custom parameters
   - Check cipher mode consistency (CBC, GCM, etc.)

4. **Test with known good configuration**
   <!-- Source: Knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/92003-knowledge.md lines 43-48 -->
   - Try decrypting a test message with known parameters
   - Use Ably's default cipher params as baseline for testing
   - Isolate whether issue affects specific messages or all encrypted data

## Automatic Handling

This is a configuration error that SDKs cannot automatically resolve. The application must provide the correct encryption key and parameters for successful decryption.

## Prevention

<!-- Source: Knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/92003-knowledge.md lines 43-48 -->
- Store encryption keys securely using vault or KMS services
- Implement key versioning for smooth rotation
- Test encryption/decryption in staging before production deployment
- Monitor decryption failures for security alerts
- Document key distribution and rotation procedures
- Consider security implications of repeated decryption failures

## Related Errors

• **[92002 - Cipher Algorithm Mismatch](https://help.ably.io/error/92002)**  
  Occurs when the encryption algorithm doesn't match between publisher and subscriber

• **[92004 - Unsupported Cipher Algorithm](https://help.ably.io/error/92004)**  
  Raised when attempting to use an unsupported encryption algorithm

• **[92005 - Invalid Cipher Arguments](https://help.ably.io/error/92005)**  
  Invalid parameters provided to the cipher configuration

## Related Resources

- [Channel encryption documentation](https://ably.com/docs/channels/options/encryption)
- [Cipher parameters guide](https://ably.com/docs/channels/options/encryption#cipher-params)
- [Security best practices](https://ably.com/docs/best-practice/security)

## Need Further Help?

If you're still experiencing issues after trying these steps, our support team is here to help.

**Contact Ably Support**: https://ably.com/support

When contacting support, please provide:
- Your account ID and app ID
- The full error message including error code 92003
- Steps to reproduce the issue
- Any relevant code snippets (without sensitive credentials)
- The SDK and version you're using

Our team will help you resolve this issue as quickly as possible.

<!-- =============================================== -->
<!-- INTERNAL DOCUMENTATION (NOT RENDERED) -->
<!-- =============================================== -->

<!-- SOURCES USED (ALWAYS use GitHub URLs with current SHA, never local paths):
- Analysis File: https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/92003-analysis.md
- Knowledge File: https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/92003-knowledge.md
- Editorial Notes: https://github.com/ably/ably-os/blob/5f4ba43/src/prompts/errors/editorial-notes.md (section on Cipher/Encryption errors lines 122-128)
- Existing Documentation: https://github.com/ably/docs/blob/main/src/pages/docs/platform/errors/codes/92003-cipher-decryption-failed.mdx (enhanced and improved)
-->

<!-- CONTENT DECISIONS:
- FAQ Content Preserved: Key debugging strategies from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/92003-knowledge.md lines 23-29
- Content Excluded: Live Objects conflict mentioned in analysis (lines 38-47) - not relevant for customer-facing docs but noted for internal reference
- Content Excluded: GitHub issue #33 details (analysis lines 70-81) - internal implementation discussion not relevant for customers
- Recommendations Source: 
  - Resolution steps based on knowledge file debugging strategies (lines 17-29)
  - Prevention measures from knowledge file best practices (lines 43-48)
  - Security implications from knowledge file (lines 37-41)
- Code Examples Rationale: No code examples included as encryption implementation varies by SDK and showing incorrect examples could cause security issues
-->

<!-- ATTRIBUTION BY SECTION:
- Common Causes: 
  - Cause 1: Based on knowledge findings in https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/92003-knowledge.md lines 31-35
  - Cause 2: From analysis at https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/92003-analysis.md lines 34-36
  - Cause 3: From knowledge file https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/92003-knowledge.md line 32
- Resolution Steps: 
  - Step 1: Knowledge file advice from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/92003-knowledge.md lines 17-23
  - Step 2: Analysis from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/92003-analysis.md lines 34-37 and knowledge lines 25-29
  - Step 3: Based on Ably documentation for cipher configuration
  - Step 4: General debugging approach from knowledge file lines 43-48
- Prevention: Based on https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/92003-knowledge.md lines 43-48 with added security monitoring
-->

<!-- DOCUMENTATION SHORTCOMINGS:
⚠️ Areas where Ably documentation could be improved:
- Missing: Specific Ruby SDK cipher error handling examples
- Missing: Clear guidance on key rotation procedures with encryption
- Missing: Resolution of conflict between Ruby SDK usage (cipher error) and Live Objects documentation (tombstone object error)
- Impact: Makes it harder for users to implement secure key management and understand error context
- Recommendation: Add dedicated section on key rotation in encryption docs and resolve error code conflict
- Severity: Medium - security-related documentation gaps and error code confusion
-->

<!-- URL Validation Completed: 2025-08-25T05-37-30-332Z -->
<!-- External URLs verified: 6 | Corrected: 0 | Exempted internal: 2 -->

<!-- IMPROVEMENT INSTRUCTIONS:
To improve this error code documentation:
1. First approach: Update editorial-notes.md in ably-os repository with specific guidance for error 92003
2. Regenerate: Run `./bin/ably-os errors document-error-codes 92003 --force`
3. For broader improvements: Review and update ably-os prompt templates
4. Context: See https://github.com/ably/ably-os/blob/5f4ba43/docs/ERROR_COMMANDS_GUIDE.md
5. Source repository: https://github.com/ably/ably-os
-->