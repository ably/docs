---
title: "Token authentication"
meta_description: "Token authentication allows clients to authenticate with Ably, without exposing the Ably API key and secret."
---

Token authentication uses a trusted device with an [API key](/docs/auth#api-key) to issue time-limited tokens to untrusted clients. Tokens have a limited set of access rights, known as [capabilities](/docs/auth/capabilities), and can have a specific [identity](/docs/auth/identified-clients) using a `clientId`.

At a high level, token authentication in Ably is based on **Ably Tokens**. You can issue Ably Tokens either in JWT format or in native Ably Token formats.

Token authentication is the recommended authentication method to use client-side for the following reasons:

* Tokens ensure that an Ably API key isn't exposed in client applications.
* Tokens are short-lived so there is only a short period of time during which a compromised token can be used.
* Tokens provide more fine-grained access control, which also limits the area of exposure a compromised token can access.
* Tokens support functionality not available with Basic auth, such as user claims.

<Aside data-type='note'>
Authentication is handled by the Pub/Sub SDK. If you're using [Chat](/docs/chat) or [Spaces](/docs/spaces), you still use the Pub/Sub SDK's authentication mechanisms. The higher-level SDKs don't have their own authentication.

When selecting an Ably SDK for implementing token authentication, you don't need to use the realtime interface on the auth server. The REST interface is more efficient for issuing tokens, as the overhead of maintaining a realtime connection is not required.
</Aside>

## When to use token authentication

| Environment | Authentication Method | Guidance |
|-------------|----------------------|----------|
| **Client-side** (browsers, mobile apps, IoT devices) | Token authentication | Use Ably Tokens so API keys are never exposed to untrusted clients. |
| **Server-side** (trusted environments) | [Basic authentication](/docs/auth/basic) | Use Basic auth only when your server is both secure (API key cannot be compromised) and trusted (allowed to assert identity and capabilities). |

## Choosing a token mechanism <a id="choosing"/>

Ably Tokens are the high-level mechanism for token authentication. In practice, you choose a token format.

### JWT format (recommended)

[JWTs](/docs/auth/jwt) are the recommended approach for most applications:

- No Ably SDK required on your server. Any JWT library works.
- Supports [channel-scoped claims](/docs/auth/jwt#channel-claims) for trusted metadata
- Supports [per-connection rate limits](/docs/auth/jwt#rate-limits)
- Stateless and ideal for serverless environments

Use JWTs unless your capability list is very large (exceeds JWT size limits) or you need to keep capabilities confidential (clients can decode JWTs).

See [JWT authentication](/docs/auth/jwt) for implementation details.

### Native Ably Token formats

Use native [Ably Tokens](/docs/auth/ably-tokens) when JWTs are not suitable:

- **TokenRequest**: Server creates a signed request locally, client exchanges it with Ably
- **Ably Token (direct)**: Server requests token from Ably, passes it to client
- **Wrapped token flow**: If you need a single app token format, you can wrap Ably credentials in an outer JWT used by your existing auth system

See [Ably Tokens](/docs/auth/ably-tokens) for implementation details.

## Token mechanism comparison <a id="comparison"/>

| Feature | JWT (Recommended) | TokenRequest | Ably Token (direct) |
|---------|:-----------------:|:------------:|:-------------------:|
| **Server SDK required** | No | Yes | Yes |
| **Client round-trip to Ably** | No | Yes | No |
| **Channel-scoped claims** | Yes | No | No |
| **Per-connection rate limits** | Yes | No | No |
| Capabilities hidden from client | No | Yes | Yes |
| Automatic SDK token refresh | Yes | Yes | Yes |

<Aside data-type='important'>
**JWT-only features you lose with other token methods:**
- Channel-scoped user claims (`ably.channel.*`) - trusted metadata other clients can read
- Per-connection publish rate limits (`ably.limits.publish.*`) - restrict message rates per connection

If you use TokenRequest or Ably Token, you will **not** have access to these features.
</Aside>

## How token authentication works <a id="workflow"/>

1. Your client calls `authUrl` or `authCallback` to request a token from your server.
2. Your server validates the client and returns a token (JWT, TokenRequest, or Ably Token).
3. The client uses this token to authenticate with Ably.
4. Tokens are short-lived and expire after a set period.
5. The client SDK automatically requests a new token before expiry, ensuring uninterrupted connectivity.

### Token refresh

One of the important benefits of using an Ably SDK is that automatic token refresh is handled for you. When you provide either an `authUrl` or an `authCallback`, the SDK automatically requests a new token before the current token expires.

### Token TTL limits

Ably enforces maximum TTL (time-to-live) limits:

- Access tokens: Maximum TTL of 24 hours.
- Device tokens (for push notifications): Maximum TTL of 5 years.
- Revocable tokens: Maximum TTL of 1 hour (when [token revocation](/docs/auth/revocation) is enabled).

<Aside data-type="important">
Attempting to create a token with a TTL that exceeds these limits will result in an error code [40003](/docs/platform/errors/codes#40003).
</Aside>

## Access restrictions <a id="restrictions"/>

### Token-based client validation

Token authentication enables you to validate client characteristics (such as origin, IP address, cookies, or any other client features) in your authentication server before issuing tokens. This provides flexible access control as you can implement any validation logic in your auth server as part of the token issuance process.

### API key restrictions

For cases where token authentication is impractical, Ably can add origin or IP address restrictions directly to API keys. However, this approach has significant limitations:

- Less flexible than token authentication.
- Manual intervention required to modify restrictions.
- Enterprise support packages only: contact [Ably support](https://ably.com/support) if interested.
- Not a security boundary: origin headers can be easily spoofed, especially outside browser contexts.
- Permissive fallback: requests with no origin header are allowed when origin restrictions are set.

For maximum security and flexibility, token authentication with server-side validation is the recommended approach.

## What triggers token authentication <a id="triggers"/>

Any of the following cause an SDK to use token authentication:

* An [`authUrl`](/docs/api/realtime-sdk/types#client-options) or [`authCallback`](/docs/api/realtime-sdk/types#client-options) is provided that returns an Ably-compatible token or an Ably [`TokenRequest`](/docs/api/realtime-sdk/types#token-request).
* [`useTokenAuth`](/docs/api/realtime-sdk/types#client-options) is true.
* A [`token`](/docs/api/realtime-sdk/types#client-options) or [`tokenDetails`](/docs/api/realtime-sdk/types#client-options) property is provided.

Providing a literal `token` or `tokenDetails` is typically used for testing: since tokens are short-lived, in production you typically want to use an authentication method that allows the client library to renew the token automatically before the current token expires.

## Next steps

- [JWTs](/docs/auth/jwt) - Recommended approach for most applications
- [Ably Tokens](/docs/auth/ably-tokens) - Alternative when JWTs aren't suitable
- [Capabilities](/docs/auth/capabilities) - Control what operations clients can perform
- [Identified clients](/docs/auth/identified-clients) - Assign trusted identities to clients
- [Token revocation](/docs/auth/revocation) - Immediately invalidate tokens
