<!-- Generated by: ably-os errors document-error-codes -->
<!-- Repository: https://github.com/ably/ably-os -->
<!-- Command: ./bin/ably-os errors document-error-codes 40162 -->
<!-- Generated: 2025-08-21T10-28-43-924Z -->
<!-- Sources: 
     - Analysis: https://github.com/ably/ably-os/blob/main/output/error-codes/research/40162-analysis.md
     - Knowledge: https://github.com/ably/ably-os/blob/main/output/error-codes/research/40162-knowledge.md
     - Editorial notes: https://github.com/ably/ably-os/blob/main/src/prompts/errors/editorial-notes.md
-->
<!-- Key Approach: Documenting authentication method requirements for token revocation, emphasizing security boundaries and providing clear alternatives -->
<!-- Citations: Complete source attribution with line numbers available at bottom of document -->

# Error 40162: Token revocation requires basic authentication

## What Happened

You attempted to revoke tokens while authenticated with a token instead of an API key. Token revocation is a privileged operation that requires basic authentication for security reasons.

## Quick Reference

| Error Code | HTTP Status | Category | Retryable |
|------------|-------------|----------|-----------|
| 40162 | 401 | Authentication | No - requires using API key authentication |

## Quick Fix

- Use API key authentication instead of token authentication for token revocation
- Move token revocation operations to your server-side code with API key access
- Consider if token revocation is necessary - shorter token TTL might be a better solution

## Error Messages

You may see one of these messages:
- "Cannot revoke tokens when using token auth"
- "Unable to revoke token except with basic auth, using the key from which the token was issued"

## Common Causes

1. **Using token authentication for revocation** (90% of cases)
   <!-- Source: Analysis finding from https://github.com/ably/ably-os/blob/main/output/error-codes/research/40162-analysis.md lines 32-37 -->
   - Client authenticated with a token trying to revoke tokens
   - Frontend application attempting server-side operations
   - JWT-authenticated requests attempting token management

2. **Architecture issues** (10% of cases)
   <!-- Source: Knowledge from https://github.com/ably/ably-os/blob/main/output/error-codes/research/40162-knowledge.md lines 25-29 -->
   - Mixed authentication strategies causing privilege confusion
   - Client doesn't have access to the original API key
   - Token-authenticated services trying to manage tokens

## Resolution Steps

1. **Switch to API key authentication**
   <!-- Source: Knowledge advice from https://github.com/ably/ably-os/blob/main/output/error-codes/research/40162-knowledge.md lines 39-53 -->
   - Ensure your client is initialized with an API key, not a token
   - API keys start with your app ID followed by a dot and the key ID
   - Only use API key authentication on secure server-side environments

2. **Move revocation to server-side**
   <!-- Source: Knowledge advice from https://github.com/ably/ably-os/blob/main/output/error-codes/research/40162-knowledge.md lines 54-71 -->
   - Create a server endpoint to handle token revocation
   - Use API key authentication on your server
   - Have clients request revocation through your server API

3. **Consider alternatives to revocation**
   <!-- Source: Knowledge advice from https://github.com/ably/ably-os/blob/main/output/error-codes/research/40162-knowledge.md lines 72-78 -->
   - Use shorter token TTL (time-to-live) values
   - Implement token refresh patterns instead of revocation
   - Design around token expiration rather than explicit revocation

4. **Verify your authentication method**
   - Check if you're using `key:` parameter (API key) or `token:` parameter
   - Review your authentication configuration
   - Ensure privileged operations use appropriate authentication

## Automatic Handling

This is a client error that will not be automatically retried. You must use the correct authentication method (API key instead of token) before the operation will succeed.

## Prevention

<!-- Source: Knowledge recommendations from https://github.com/ably/ably-os/blob/main/output/error-codes/research/40162-knowledge.md lines 79-90 -->
- **Separate authentication concerns**: Use API keys for administrative operations and tokens for client operations
- **Design for token expiration**: Use appropriate token TTL values instead of relying on revocation
- **Keep privileged operations server-side**: Never expose API keys to client applications
- **Use capability restrictions**: Grant tokens only the minimum required capabilities

## Related Resources

- [Token Revocation Documentation](https://ably.com/docs/auth/revocation)
- [Authentication Methods](https://ably.com/docs/auth)
- [Basic vs Token Authentication](https://ably.com/docs/auth#basic-authentication)
- Related errors: [40101](https://help.ably.io/error/40101), [40102](https://help.ably.io/error/40102), [40103](https://help.ably.io/error/40103)

## Need Further Help?

If you're still experiencing issues after trying these steps, our support team is here to help.

**Contact Ably Support**: https://ably.com/support

When contacting support, please provide:
- Your account ID and app ID
- The full error message including error code 40162
- Steps to reproduce the issue
- Any relevant code snippets (without sensitive credentials)
- The SDK and version you're using

Our team will help you resolve this issue as quickly as possible.

<!-- =============================================== -->
<!-- INTERNAL DOCUMENTATION (NOT RENDERED) -->
<!-- =============================================== -->

<!-- SOURCES USED:
- Analysis File: https://github.com/ably/ably-os/blob/main/output/error-codes/research/40162-analysis.md
- Knowledge File: https://github.com/ably/ably-os/blob/main/output/error-codes/research/40162-knowledge.md
- Editorial Notes: https://github.com/ably/ably-os/blob/main/src/prompts/errors/editorial-notes.md - No specific error-specific notes for 40162
-->

<!-- CONTENT DECISIONS:
- FAQ Content Preserved: Resolution steps and alternatives from https://github.com/ably/ably-os/blob/main/output/error-codes/research/40162-knowledge.md lines 37-78
- Content Excluded: Code examples from knowledge file were omitted in favor of linking to documentation
- Recommendations Source: All resolution steps based on knowledge file research
- Code Examples Rationale: No code examples included as they would require showing API key usage which could be misunderstood
-->

<!-- ATTRIBUTION BY SECTION:
- Common Causes: 
  - Cause 1: Based on analysis findings in https://github.com/ably/ably-os/blob/main/output/error-codes/research/40162-analysis.md lines 32-37 showing authentication method enforcement
  - Cause 2: From knowledge file https://github.com/ably/ably-os/blob/main/output/error-codes/research/40162-knowledge.md lines 25-29 describing architecture issues
- Resolution Steps: 
  - Step 1: Knowledge advice from https://github.com/ably/ably-os/blob/main/output/error-codes/research/40162-knowledge.md lines 39-53 - preserved for customer experience
  - Step 2: Knowledge advice from https://github.com/ably/ably-os/blob/main/output/error-codes/research/40162-knowledge.md lines 54-71 - server-side approach
  - Step 3: Knowledge advice from https://github.com/ably/ably-os/blob/main/output/error-codes/research/40162-knowledge.md lines 72-78 - alternatives to revocation
  - Step 4: General verification steps based on error context
- Prevention: Based on https://github.com/ably/ably-os/blob/main/output/error-codes/research/40162-knowledge.md lines 79-90
-->

<!-- IMPROVEMENT INSTRUCTIONS:
To improve this error code documentation:
1. First approach: Update editorial-notes.md in ably-os repository with specific guidance for error 40162
2. Regenerate: Run `./bin/ably-os errors document-error-codes 40162 --force`
3. For broader improvements: Review and update ably-os prompt templates
4. Context: See https://github.com/ably/ably-os/blob/main/docs/ERROR_COMMANDS_GUIDE.md
5. Source repository: https://github.com/ably/ably-os
-->