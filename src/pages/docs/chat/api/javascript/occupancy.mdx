---
title: Occupancy
meta_description: "API reference for the Occupancy interface in the Ably Chat JavaScript SDK."
meta_keywords: "Ably Chat SDK, JavaScript, Occupancy API, get, subscribe, connections, presence members, user count"
---

The `Occupancy` interface provides methods for tracking the number of users in a chat room. Access it via `room.occupancy`.

<Code>
```javascript
const occupancy = room.occupancy;
```
</Code>

## Properties

The `Occupancy` interface has the following properties:

<Table id='OccupancyProperties'>

| Property | Description | Type |
| --- | --- | --- |
| current | The latest occupancy data cached from realtime events. Returns `undefined` if no occupancy events have been received yet since room attachment. Requires `enableEvents` to be `true` in the [room's occupancy options](/docs/chat/api/javascript/rooms#get). | <Table id='OccupancyData'/> or Undefined |

</Table>

<Table id='OccupancyData' hidden>

| Property | Description | Type |
| --- | --- | --- |
| connections | The number of active connections to the room. | Number |
| presenceMembers | The number of users in the presence set. | Number |

</Table>

## Get current occupancy <a id="get"/>

<MethodSignature>{`occupancy.get(): Promise<OccupancyData>`}</MethodSignature>

Fetches the current occupancy of the chat room from the server. Retrieves the latest occupancy metrics, including the number of active connections and presence members.

This method uses the Ably Chat REST API and does not require the room to be attached.

<Code>
```javascript
const data = await room.occupancy.get();
console.log('Connections:', data.connections);
console.log('Presence members:', data.presenceMembers);
```
</Code>

### Returns <a id="get-returns"/>

`Promise<OccupancyData>`

Returns a promise. The promise is fulfilled with the current occupancy data, or rejected with an `ErrorInfo` object.

## Subscribe to occupancy events <a id="subscribe"/>

<MethodSignature>{`occupancy.subscribe(listener: OccupancyListener): Subscription`}</MethodSignature>

Subscribes to occupancy updates for the chat room. Receives updates whenever the number of connections or present members in the room changes.

Requires `enableEvents` to be `true` in the [room's occupancy options](/docs/chat/api/javascript/rooms#get). The room should be [attached](/docs/chat/api/javascript/room#attach) to receive occupancy events.

<Code>
```javascript
const { unsubscribe } = room.occupancy.subscribe((event) => {
  console.log('Connections:', event.occupancy.connections);
  console.log('Presence members:', event.occupancy.presenceMembers);
});

// To stop receiving occupancy updates
unsubscribe();
```
</Code>

### Parameters <a id="subscribe-params"/>

The `subscribe()` method takes the following parameters:

<Table id='SubscribeParameters'>

| Parameter | Required | Description | Type |
| --- | --- | --- | --- |
| listener | Required | Callback invoked when room occupancy changes. | <Table id='OccupancyEvent'/> |

</Table>

<Table id='OccupancyEvent' hidden>

| Property | Description | Type |
| --- | --- | --- |
| type | The type of occupancy event. | <Table id='OccupancyEventType'/> |
| occupancy | The current occupancy data. | <Table id='OccupancyData'/> |

</Table>

<Table id='OccupancyEventType' hidden>

| Value | Description |
| --- | --- |
| Updated | The room occupancy has been updated. The value is `occupancy.updated`. |

</Table>

### Returns <a id="subscribe-returns"/>

`Subscription`

Returns an object with the following methods:

#### Unsubscribe from occupancy events <a id="subscribe-unsubscribe"/>

<MethodSignature>unsubscribe(): void</MethodSignature>

Call `unsubscribe()` to stop receiving occupancy events.

## Example

<Code>
```javascript
const room = await chatClient.rooms.get('my-room', {
  occupancy: {
    enableEvents: true // Required for subscribe() and current property
  }
});

await room.attach();

// Subscribe to occupancy changes
const { unsubscribe } = room.occupancy.subscribe((event) => {
  const { connections, presenceMembers } = event.occupancy;
  console.log(`Room has ${connections} connections and ${presenceMembers} presence members`);

  // Update UI with viewer count
  document.getElementById('viewer-count').textContent = connections;
});

// Fetch occupancy on-demand (works even without enableEvents)
const occupancy = await room.occupancy.get();
console.log(`Initial occupancy: ${occupancy.connections} connections`);

// Access cached occupancy (requires enableEvents)
const cached = room.occupancy.current;
if (cached) {
  console.log('Cached occupancy:', cached.connections);
}

// Clean up
unsubscribe();
```
</Code>
