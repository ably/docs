<!-- Generated by: ably-os errors document-error-codes -->
<!-- Repository: https://github.com/ably/ably-os -->
<!-- Command: ./bin/ably-os errors document-error-codes 40103 -->
<!-- Generated: 2025-08-25T19-44-21-128Z -->
<!-- Sources: 
     - Analysis: https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40103-analysis.md
     - Knowledge: https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40103-knowledge.md
     - Editorial notes: https://github.com/ably/ably-os/blob/5f4ba43/src/prompts/errors/editorial-notes.md
-->
<!-- Key Approach: Document security enforcement preventing API keys over unencrypted connections with comprehensive development and production guidance -->
<!-- Citations: Complete source attribution with line numbers available at bottom of document -->

# Error 40103: Basic authentication requires TLS

## What Happened

Your API key cannot be used over an unencrypted connection for security reasons.

## Quick Reference

| Error Code | HTTP Status | Category | Retryable |
|------------|-------------|----------|-----------|
| 40103 | 401 | Client Error (Authentication) | No - requires enabling TLS or switching authentication method |

## Quick Fix

- Enable TLS in your client configuration (`tls: true`)
- Use HTTPS/WSS instead of HTTP/WS endpoints
- Or switch to token authentication if TLS cannot be enabled

## Error Messages

You may see one of these messages:
- "Invalid use of Basic auth over non-TLS transport"
- "Cannot use Basic Auth over non-TLS connections"
- "Trying to use basic key auth over insecure connection"
- "No authentication parameters supplied" (PHP only)

## Common Causes

1. **TLS disabled in configuration** (80% of cases)
   <!-- Source: Analysis finding from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40103-analysis.md lines 83-86 -->
   - Setting `tls: false` in client options
   - Using HTTP instead of HTTPS endpoints
   - Development environments with insecure defaults

2. **Network restrictions** (15% of cases)
   <!-- Source: Knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40103-knowledge.md lines 32-38 -->
   - Corporate firewall blocking HTTPS/WSS ports
   - Proxy configurations forcing HTTP
   - Local development without HTTPS setup

3. **Missing authentication configuration** (5% of cases - PHP only)
   <!-- Source: Analysis finding from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40103-analysis.md lines 32-36 -->
   - No API key, token, authUrl, or authCallback provided
   - Empty or null authentication parameters

## Resolution Steps

1. **Enable TLS in your configuration**
   <!-- Source: Knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40103-knowledge.md lines 50-57 -->
   ```javascript
   // JavaScript
   const client = new Ably.Realtime({
     key: 'your-api-key',
     tls: true  // Enable TLS
   });
   ```
   
   <!-- Source: Analysis from SDK implementations in https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40103-analysis.md lines 15-57 -->
   **Language-specific implementations:**
   - **Python**: Ensure using HTTPS scheme in connection
   - **Ruby**: Enable TLS in client configuration  
   - **Go**: Remove `NoTLS` option or set to false
   - **PHP**: Set `tls` option to true

2. **Verify your endpoints**
   <!-- Source: Editorial notes from https://github.com/ably/ably-os/blob/5f4ba43/src/prompts/errors/editorial-notes.md lines 75-78 -->
   - Use `https://rest.ably.io` not `http://rest.ably.io`
   - Use `wss://realtime.ably.io` not `ws://realtime.ably.io`
   - Default endpoints already use TLS

3. **Alternative: Use token authentication**
   <!-- Source: Knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40103-knowledge.md lines 59-65 and 87-101 -->
   - Token authentication can work over non-TLS connections
   - Generate tokens on your secure server
   - Configure client with `authUrl` or `authCallback`
   - See [Token Authentication documentation](https://ably.com/docs/auth/token)

4. **For local development environments**
   <!-- Source: Knowledge from internal discussions https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40103-knowledge.md lines 197-256 -->
   - Use the sandbox environment which supports TLS
   - Set up local HTTPS with self-signed certificates
   - Switch to token authentication for local testing
   - Note: Server-side `allowBasicAuthWithoutTls` setting may not bypass client-side security checks

## Automatic Handling

This is a security policy error that will not be automatically retried. You must either enable TLS or switch to token authentication before the connection will succeed.

## Code Examples

### Secure Development Setup
<!-- Source: Knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40103-knowledge.md lines 77-85 -->
```javascript
// Good: Development with TLS enabled
const client = new Ably.Realtime({
  key: process.env.ABLY_KEY,
  environment: 'sandbox',  // Uses TLS by default
  tls: true
});
```

### Token Authentication Alternative
<!-- Source: Knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40103-knowledge.md lines 87-101 -->
```javascript
// Alternative: Token auth for environments where TLS isn't available
const client = new Ably.Realtime({
  authCallback: (tokenParams, callback) => {
    // Fetch token from your secure server
    fetch('/auth/token', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(tokenParams)
    })
    .then(response => response.json())
    .then(token => callback(null, token))
    .catch(err => callback(err, null));
  }
});
```

## Prevention

- Always use TLS in production environments
- Default to `tls: true` in all configurations
- Use token authentication for client-side applications
- Never transmit API keys over unencrypted connections
- Configure development environments with HTTPS when possible
- Include security validation in your test suites

## Performance Impact

This error prevents connection establishment entirely. There are no performance implications as the connection fails immediately during the security check phase.

## Related Errors

• **[40101 - Invalid API Key](https://help.ably.io/error/40101)**  
  Authentication failures due to incorrect or malformed API keys

• **[40102 - Token Expired](https://help.ably.io/error/40102)**  
  Token authentication failures that may require switching to a new token

• **[40400 - Not Found](https://help.ably.io/error/40400)**  
  May occur if the app ID or key ID portion of your API key is invalid

## Related Resources

- [Authentication documentation](https://ably.com/docs/auth)
- [Basic authentication guide](https://ably.com/docs/auth/basic)
- [Token authentication guide](https://ably.com/docs/auth/token)
- [TLS/SSL encryption](https://ably.com/docs/security)
- [Selecting authentication schemes](https://ably.com/docs/auth/selecting-auth)

## Need Further Help?

If you're still experiencing issues after trying these steps, our support team is here to help.

**Contact Ably Support**: https://ably.com/support

When contacting support, please provide:
- Your account ID and app ID
- The full error message including error code 40103
- Steps to reproduce the issue
- Any relevant code snippets (without sensitive credentials)
- The SDK and version you're using

Our team will help you resolve this issue as quickly as possible.

<!-- =============================================== -->
<!-- INTERNAL DOCUMENTATION (NOT RENDERED) -->
<!-- =============================================== -->

<!-- SOURCES USED:
- Analysis File: https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40103-analysis.md
- Knowledge File: https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40103-knowledge.md
- Editorial Notes: https://github.com/ably/ably-os/blob/5f4ba43/src/prompts/errors/editorial-notes.md (lines 75-78 specific to 40103)
- Existing Documentation: https://github.com/ably/docs/blob/main/src/pages/docs/platform/errors/codes/40103-basic-auth-requires-tls.mdx (enhanced with new insights)
-->

<!-- CONTENT DECISIONS:
- FAQ Content Preserved: No FAQ content found for 40103
- Content Excluded: Go SDK's InsecureAllowBasicAuthWithoutTLS option (security risk, not recommended for documentation)
- Content Added: Internal discussion insights about local development challenges and server-side configuration limitations
- Recommendations Source: 
  - Enable TLS: Based on analysis findings in all SDKs (lines 15-57)
  - Token authentication alternative: From knowledge file lines 59-65 and 87-101
  - Development guidance: From knowledge file lines 77-85 and internal discussions lines 197-256
- Code Examples Rationale: Included secure development setup and token auth alternative based on knowledge file patterns (lines 77-101), essential for resolution
-->

<!-- ATTRIBUTION BY SECTION:
- Common Causes: 
  - Cause 1 (TLS disabled): Based on analysis findings in https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40103-analysis.md lines 83-86
  - Cause 2 (Network restrictions): From knowledge at https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40103-knowledge.md lines 32-38
  - Cause 3 (Missing auth): From PHP-specific finding in https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40103-analysis.md lines 32-36
- Resolution Steps: 
  - Step 1 (Enable TLS): Source from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40103-knowledge.md lines 50-57
  - Step 2 (Verify endpoints): Editorial guidance from https://github.com/ably/ably-os/blob/5f4ba43/src/prompts/errors/editorial-notes.md lines 75-78
  - Step 3 (Token auth): Knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40103-knowledge.md lines 59-65 and 87-101
  - Step 4 (Development): From https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40103-knowledge.md lines 197-256
- Code Examples:
  - Secure setup: From https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40103-knowledge.md lines 77-85
  - Token auth: From https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40103-knowledge.md lines 87-101
- Prevention: Based on https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40103-knowledge.md lines 127-143
-->

<!-- URL Validation Completed: 2025-08-25T19-44-21-128Z -->
<!-- External URLs verified: 9 | Corrected: 0 | Exempted internal: 2 -->

<!-- DOCUMENTATION SHORTCOMINGS:
⚠️ Areas where Ably documentation could be improved:
- Missing: Clear guidance on HTTPS setup for local development environments
- Missing: Documentation about server-side allowBasicAuthWithoutTls setting and its limitations
- Impact: Developers struggle with TLS requirements in development
- Recommendation: Add a comprehensive local development guide with certificate setup
- Severity: Medium - common development pain point based on internal Slack discussions
-->

<!-- IMPROVEMENT INSTRUCTIONS:
To improve this error code documentation:
1. First approach: Update editorial-notes.md in ably-os repository with specific guidance for error 40103
2. Regenerate: Run `./bin/ably-os errors document-error-codes 40103 --force`
3. For broader improvements: Review and update ably-os prompt templates
4. Context: See https://github.com/ably/ably-os/blob/5f4ba43/docs/ERROR_COMMANDS_GUIDE.md
5. Source repository: https://github.com/ably/ably-os
-->