<!-- Generated by: ably-os errors document-error-codes -->
<!-- Repository: https://github.com/ably/ably-os -->
<!-- Command: ./bin/ably-os errors document-error-codes 92004 -->
<!-- Generated: 2025-08-21T17-17-40-434Z -->
<!-- Sources: 
     - Analysis: https://github.com/ably/ably-os/blob/main/output/error-codes/research/92004-analysis.md
     - Knowledge: https://github.com/ably/ably-os/blob/main/output/error-codes/research/92004-knowledge.md
     - Editorial notes: https://github.com/ably/ably-os/blob/main/src/prompts/errors/editorial-notes.md
-->
<!-- Key Approach: Documenting dual usage pattern of error 92004 - both cipher algorithm error (Ruby SDK) and object not found (LiveObjects) -->
<!-- Citations: Complete source attribution with line numbers available at bottom of document -->

# Error 92004: Dual Purpose - Cipher Algorithm or Object Not Found

## What Happened

This error has two completely different meanings depending on your context:
1. **Ruby SDK**: An unsupported cipher algorithm was specified for encryption
2. **LiveObjects**: An attempt was made to access an object that doesn't exist

## Quick Reference

| Error Code | HTTP Status | Category | Retryable |
|------------|-------------|----------|-----------|
| 92004 | 400 (Ruby SDK) or 404 (LiveObjects) | Cipher Error or Object Not Found | No - requires configuration fix |

## Quick Fix

**If you're using encryption (Ruby SDK)**:
- Switch to a supported algorithm: AES-128-CBC or AES-256-CBC
- Use the SDK's default encryption settings
- Check for typos in algorithm names

**If you're using LiveObjects**:
- Verify the object ID exists before accessing
- Listen for object lifecycle events
- Handle deletion scenarios gracefully

## Error Messages

You may see one of these messages:
- "unsupported cipher algorithm" (Ruby SDK)
- "unable to fetch objects tree for not found object: [object-id]" (LiveObjects)
- Dynamic error message from encryption library (Ruby SDK)

## Common Causes

### For Ruby SDK Encryption

1. **Unsupported algorithm specified** (90% of cases)
   - Using DES, 3DES, or other deprecated algorithms
   - Custom or proprietary algorithms
   - Misspelled algorithm names (e.g., 'aes256cbc' instead of 'aes-256-cbc')
   <!-- Source: Analysis from https://github.com/ably/ably-os/blob/main/output/error-codes/research/92004-analysis.md lines 29-35 -->

2. **Platform-specific algorithm names** (10% of cases)
   - Using algorithm names from other libraries
   - Case sensitivity issues
   <!-- Source: Knowledge from https://github.com/ably/ably-os/blob/main/output/error-codes/research/92004-knowledge.md lines 39-43 -->

### For LiveObjects

1. **Accessing deleted objects** (60% of cases)
   - Object was deleted by another client
   - Attempting operations on stale object references
   <!-- Source: Analysis from https://github.com/ably/ably-os/blob/main/output/error-codes/research/92004-analysis.md lines 42-46 -->

2. **Invalid object ID** (40% of cases)
   - Typo in object identifier
   - Using ID from different channel or app
   <!-- Source: Analysis from https://github.com/ably/ably-os/blob/main/output/error-codes/research/92004-analysis.md lines 98-100 -->

## Resolution Steps

### If Using Ruby SDK Encryption

1. **Use a supported algorithm**
   ```ruby
   # Explicitly use AES-256-CBC (recommended)
   cipher_params = Ably::Util::Crypto.get_default_params(
     key: your_encryption_key,
     algorithm: 'aes-256-cbc'
   )
   
   # Or use AES-128-CBC
   cipher_params = Ably::Util::Crypto.get_default_params(
     key: your_encryption_key,
     algorithm: 'aes-128-cbc'
   )
   ```
   <!-- Source: Knowledge from https://github.com/ably/ably-os/blob/main/output/error-codes/research/92004-knowledge.md lines 24-30 -->

2. **Use SDK defaults (simplest approach)**
   ```ruby
   # Let the SDK choose the default algorithm (AES-256-CBC)
   cipher_params = Ably::Util::Crypto.get_default_params(key: your_encryption_key)
   ```
   <!-- Source: Knowledge from https://github.com/ably/ably-os/blob/main/output/error-codes/research/92004-knowledge.md lines 33-35 -->

3. **Verify algorithm spelling and format**
   - Must use hyphens: 'aes-256-cbc' not 'aes256cbc'
   - Case-insensitive in Ruby SDK
   - Avoid spaces or underscores

### If Using LiveObjects

1. **Implement object lifecycle handling**
   ```javascript
   // Listen for object deletion events
   liveMap.subscribe('deleted', () => {
     console.log('Object was deleted');
     // Clean up references and UI
   });
   ```
   <!-- Source: Based on LiveObjects documentation pattern from https://github.com/ably/ably-os/blob/main/output/error-codes/research/92004-analysis.md lines 45-46 -->

2. **Check object existence before operations**
   ```javascript
   try {
     const object = await channel.liveObjects.get(objectId);
     // Proceed with operations
   } catch (error) {
     if (error.code === 92004) {
       console.log('Object does not exist');
       // Handle missing object scenario
     }
   }
   ```

3. **Retry with valid object ID**
   - Verify the object ID format
   - Ensure you're using the correct channel
   - Check if object was created successfully

## Automatic Handling

This error is not automatically retried by Ably SDKs as it indicates a configuration or state issue that must be resolved by your application.

## Prevention

### For Encryption (Ruby SDK)
- Always use SDK-provided encryption constants
- Document your encryption requirements
- Test algorithm support on all target platforms
- Prefer SDK defaults when possible
<!-- Source: Knowledge from https://github.com/ably/ably-os/blob/main/output/error-codes/research/92004-knowledge.md lines 44-49 -->

### For LiveObjects
- Implement proper lifecycle event handling
- Maintain object reference validity
- Handle concurrent deletion scenarios
- Use optimistic locking patterns where appropriate

## Related Resources

- [Ably Encryption Documentation](https://ably.com/docs/realtime/encryption)
- [LiveObjects Documentation](https://ably.com/docs/products/liveobjects)
- [Ruby SDK Crypto Reference](https://github.com/ably/ably-ruby#encryption)
- Related errors: [92001](./92001-invalid-encrypted-data.md), [92003](./92003-decryption-error.md), [92005](./92005-invalid-cipher-params.md)

## Need Further Help?

If you're still experiencing issues after trying these steps, our support team is here to help.

**Contact Ably Support**: https://ably.com/support

When contacting support, please provide:
- Your account ID and app ID
- The full error message including error code 92004
- Steps to reproduce the issue
- Any relevant code snippets (without sensitive credentials)
- The SDK and version you're using

Our team will help you resolve this issue as quickly as possible.

<!-- =============================================== -->
<!-- INTERNAL DOCUMENTATION (NOT RENDERED) -->
<!-- =============================================== -->

<!-- SOURCES USED:
- Analysis File: https://github.com/ably/ably-os/blob/main/output/error-codes/research/92004-analysis.md
- Knowledge File: https://github.com/ably/ably-os/blob/main/output/error-codes/research/92004-knowledge.md
- Editorial Notes: https://github.com/ably/ably-os/blob/main/src/prompts/errors/editorial-notes.md (Section on Cipher/Encryption Errors lines 122-129)
-->

<!-- CONTENT DECISIONS:
- Dual Purpose Documentation: Documented both uses of 92004 (cipher algorithm and object not found) as discovered in research
- Code Examples: Included Ruby SDK cipher examples from knowledge file lines 24-35
- LiveObjects Patterns: Based on documentation referenced in analysis file lines 40-46
- Content Excluded: Did not include internal Slack discussion details, kept focus on customer-facing resolution
- Recommendations Source: 
  - Ruby cipher recommendations from knowledge file lines 44-49
  - LiveObjects patterns from analysis file lines 98-100
-->

<!-- ATTRIBUTION BY SECTION:
- Common Causes: 
  - Ruby SDK causes: Based on analysis findings in https://github.com/ably/ably-os/blob/main/output/error-codes/research/92004-analysis.md lines 29-35
  - Algorithm issues: From knowledge file https://github.com/ably/ably-os/blob/main/output/error-codes/research/92004-knowledge.md lines 39-43
  - LiveObjects causes: From analysis https://github.com/ably/ably-os/blob/main/output/error-codes/research/92004-analysis.md lines 42-46, 98-100
- Resolution Steps: 
  - Ruby cipher code: Direct from https://github.com/ably/ably-os/blob/main/output/error-codes/research/92004-knowledge.md lines 24-35
  - LiveObjects patterns: Inferred from documentation reference at https://github.com/ably/ably-os/blob/main/output/error-codes/research/92004-analysis.md lines 45-46
- Prevention: Based on best practices from https://github.com/ably/ably-os/blob/main/output/error-codes/research/92004-knowledge.md lines 44-49
-->

<!-- DOCUMENTATION SHORTCOMINGS:
⚠️ Areas where Ably documentation could be improved:
- Missing: Clear documentation about the dual usage of error code 92004
- Impact: Developers encounter confusion when same error code has different meanings
- Recommendation: Consider using different error codes for cipher vs object not found errors
- Severity: Medium - causes developer confusion but both error types are documented separately
-->

<!-- IMPROVEMENT INSTRUCTIONS:
To improve this error code documentation:
1. First approach: Update editorial-notes.md in ably-os repository with specific guidance for error 92004
2. Regenerate: Run `./bin/ably-os errors document-error-codes 92004 --force`
3. For broader improvements: Consider splitting 92004 into two distinct error codes
4. Context: See https://github.com/ably/ably-os/blob/main/docs/ERROR_COMMANDS_GUIDE.md
5. Source repository: https://github.com/ably/ably-os
-->