<!-- Generated by: ably-os errors document-error-codes -->
<!-- Repository: https://github.com/ably/ably-os -->
<!-- Command: ./bin/ably-os errors document-error-codes 91000 -->
<!-- Generated: 2025-08-21T10-28-43-924Z -->
<!-- Sources: 
     - Analysis: https://github.com/ably/ably-os/blob/main/output/error-codes/research/91000-analysis.md
     - Knowledge: https://github.com/ably/ably-os/blob/main/output/error-codes/research/91000-knowledge.md
     - Editorial notes: https://github.com/ably/ably-os/blob/main/src/prompts/errors/editorial-notes.md
-->
<!-- Key Approach: Document comprehensive clientId setup for presence operations, including all authentication methods -->
<!-- Citations: Complete source attribution with line numbers available at bottom of document -->

# Error 91000: Presence requires client ID

## What Happened

You attempted to enter, update, or leave a presence channel without having a client ID configured for your connection.

## Quick Reference

| Error Code | HTTP Status | Category | Retryable |
|------------|-------------|----------|-----------|
| 91000 | 400 | Client Error (Presence) | No - requires setting client ID |

## Quick Fix

- Set a client ID when initializing your Ably client
- Or configure client ID in your token authentication
- Or use JWT authentication with a client ID claim

## Error Messages

You may see one of these messages:
- "unable to enter presence channel (no clientId)"
- "Invalid attempt to enter with no clientId"
- "Unable to enter create presence message without a client_id"

## Common Causes

1. **No client ID configured** (90% of cases)
   - Creating an Ably client without specifying a client ID
   - Using basic authentication without setting client ID
   - Missing client ID in token parameters
   <!-- Source: Analysis finding from https://github.com/ably/ably-os/blob/main/output/error-codes/research/91000-analysis.md lines 88-93 -->

2. **Anonymous connection attempting presence** (8% of cases)
   - Default connections don't have client IDs
   - Quick-start implementations often miss this requirement
   - Demo applications without proper authentication setup
   <!-- Source: Knowledge from https://github.com/ably/ably-os/blob/main/output/error-codes/research/91000-knowledge.md lines 40-44 -->

3. **Client ID lost during authentication renewal** (2% of cases)
   - Token renewal didn't include client ID
   - JWT token missing client ID claim
   <!-- Source: Analysis finding from https://github.com/ably/ably-os/blob/main/output/error-codes/research/91000-analysis.md lines 126-131 -->

## Resolution Steps

1. **Set client ID in client options**
   ```javascript
   const ably = new Ably.Realtime({
     key: 'your-api-key',
     clientId: 'unique-user-id' // Add this line
   });
   ```
   <!-- Source: Knowledge from https://github.com/ably/ably-os/blob/main/output/error-codes/research/91000-knowledge.md lines 23-28 -->

2. **Configure client ID via token authentication**
   ```javascript
   const tokenParams = {
     clientId: 'unique-user-id'
   };
   const token = await ably.auth.requestToken(tokenParams);
   ```
   <!-- Source: Knowledge from https://github.com/ably/ably-os/blob/main/output/error-codes/research/91000-knowledge.md lines 30-35 -->

3. **Use JWT with client ID claim**
   - Ensure your JWT includes a client ID in the token claims
   - The JWT should be generated server-side with the appropriate client ID
   <!-- Source: Analysis finding from https://github.com/ably/ably-os/blob/main/output/error-codes/research/91000-analysis.md lines 130-131 -->

4. **Verify client ID is set**
   ```javascript
   // Check if client ID is configured
   console.log('Client ID:', ably.auth.clientId);
   
   // Only attempt presence if client ID exists
   if (ably.auth.clientId) {
     await channel.presence.enter();
   }
   ```
   <!-- Source: Based on SDK validation patterns from https://github.com/ably/ably-os/blob/main/output/error-codes/research/91000-analysis.md lines 25-57 -->

## Automatic Handling

This is a client error that will not be automatically retried. You must configure a client ID before the presence operation will succeed.

## Prevention

- **Always set client ID for presence-enabled applications**: Configure during initialization or authentication
- **Use meaningful identifiers**: User IDs, usernames, or session IDs work well
- **Maintain consistency**: Use the same client ID across reconnections for the same user
- **Validate before presence operations**: Check that client ID exists before calling presence methods
<!-- Source: Knowledge best practices from https://github.com/ably/ably-os/blob/main/output/error-codes/research/91000-knowledge.md lines 57-63 -->

## Security Considerations

- **Use token authentication for production**: Basic authentication with client ID can be spoofed
- **Server-side validation**: Generate tokens server-side to ensure client ID authenticity
- **Avoid sensitive data**: Don't use personal information as client IDs
- **Unique identifiers**: Ensure each user has a unique client ID to prevent conflicts
<!-- Source: Knowledge security section from https://github.com/ably/ably-os/blob/main/output/error-codes/research/91000-knowledge.md lines 65-70 -->

## Related Resources

- [Ably Presence documentation](https://ably.com/docs/presence)
- [Identified clients guide](https://ably.com/docs/auth/identified-clients)
- [Token authentication](https://ably.com/docs/auth/token)
- Related errors: [91001](./91001-invalid-presence-state.md), [91003](./91003-presence-member-limit.md)

## Need Further Help?

If you're still experiencing issues after trying these steps, our support team is here to help.

**Contact Ably Support**: https://ably.com/support

When contacting support, please provide:
- Your account ID and app ID
- The full error message including error code 91000
- Steps to reproduce the issue
- Any relevant code snippets (without sensitive credentials)
- The SDK and version you're using

Our team will help you resolve this issue as quickly as possible.

<!-- =============================================== -->
<!-- INTERNAL DOCUMENTATION (NOT RENDERED) -->
<!-- =============================================== -->

<!-- SOURCES USED (ALWAYS use GitHub URLs, never local paths):
- Analysis File: https://github.com/ably/ably-os/blob/main/output/error-codes/research/91000-analysis.md
- Knowledge File: https://github.com/ably/ably-os/blob/main/output/error-codes/research/91000-knowledge.md
- Editorial Notes: https://github.com/ably/ably-os/blob/main/src/prompts/errors/editorial-notes.md - Specific note at line 121 about presence requiring client ID
- Existing Documentation: None found
- Repository Overviews: Not needed for this error
-->

<!-- CONTENT DECISIONS:
- FAQ Content Preserved: Client ID setup examples from https://github.com/ably/ably-os/blob/main/output/error-codes/research/91000-knowledge.md lines 23-35
- Content Excluded: None - all relevant information included
- Recommendations Source: 
  - Step 1: Client options from knowledge file lines 23-28
  - Step 2: Token auth from knowledge file lines 30-35
  - Step 3: JWT from analysis file lines 130-131
  - Step 4: Validation pattern from analysis file lines 25-57
- Code Examples Rationale: Essential for showing the three ways to set client ID, verified against Ably documentation
-->

<!-- ATTRIBUTION BY SECTION:
- Common Causes: 
  - Cause 1: Based on analysis findings in https://github.com/ably/ably-os/blob/main/output/error-codes/research/91000-analysis.md lines 88-93
  - Cause 2: From knowledge file https://github.com/ably/ably-os/blob/main/output/error-codes/research/91000-knowledge.md lines 40-44 and Slack discussion line 79-86
  - Cause 3: From analysis file https://github.com/ably/ably-os/blob/main/output/error-codes/research/91000-analysis.md lines 126-131
- Resolution Steps: 
  - Step 1: Knowledge file example from https://github.com/ably/ably-os/blob/main/output/error-codes/research/91000-knowledge.md lines 23-28
  - Step 2: Knowledge file example from https://github.com/ably/ably-os/blob/main/output/error-codes/research/91000-knowledge.md lines 30-35
  - Step 3: JWT approach from analysis file https://github.com/ably/ably-os/blob/main/output/error-codes/research/91000-analysis.md lines 130-131
  - Step 4: Validation approach derived from SDK patterns in analysis file lines 25-57
- Prevention: Based on https://github.com/ably/ably-os/blob/main/output/error-codes/research/91000-knowledge.md lines 57-63
- Security Considerations: From https://github.com/ably/ably-os/blob/main/output/error-codes/research/91000-knowledge.md lines 65-70
-->

<!-- IMPROVEMENT INSTRUCTIONS:
To improve this error code documentation:
1. First approach: Update editorial-notes.md in ably-os repository with specific guidance for error 91000
2. Regenerate: Run `./bin/ably-os errors document-error-codes 91000 --force`
3. For broader improvements: Review and update ably-os prompt templates
4. Context: See https://github.com/ably/ably-os/blob/main/docs/ERROR_COMMANDS_GUIDE.md
5. Source repository: https://github.com/ably/ably-os
-->