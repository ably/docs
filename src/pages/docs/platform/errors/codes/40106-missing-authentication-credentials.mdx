<!-- Generated by: ably-os errors document-error-codes -->
<!-- Repository: https://github.com/ably/ably-os -->
<!-- Command: ./bin/ably-os errors document-error-codes 40106 -->
<!-- Generated: 2025-08-21T17-17-40-434Z -->
<!-- Sources: 
     - Analysis: https://github.com/ably/ably-os/blob/main/output/error-codes/research/40106-analysis.md
     - Knowledge: https://github.com/ably/ably-os/blob/main/output/error-codes/research/40106-knowledge.md
     - Editorial notes: https://github.com/ably/ably-os/blob/main/src/prompts/errors/editorial-notes.md
-->
<!-- Key Approach: Comprehensive documentation for authentication credential errors, focusing on missing or invalid authentication parameters -->
<!-- Citations: Complete source attribution with line numbers available at bottom of document -->

# Error 40106: Missing authentication credentials

## What Happened

The Ably SDK cannot find the authentication credentials needed to connect to Ably or perform the requested operation.

## Quick Reference

| Error Code | HTTP Status | Category | Retryable |
|------------|-------------|----------|-----------|
| 40106 | 400/401/404 | Client Error (Authentication) | No - requires fixing credentials |

## Quick Fix

- Provide an API key when initializing the Ably client
- Or configure token authentication with authUrl or authCallback
- Check environment variables are properly set in production

## Error Messages

You'll see one of these messages:
- "Auth.requestToken(): options must include valid authentication parameters"
- "Auth Key cannot be empty"
- "No authentication options provided; need one of: key, authUrl, or authCallback (or for testing only, token or tokenDetails)"
- "API key is required to create signed token requests"
- "Unable to obtain credentials from given parameters"

## Common Causes

1. **Missing API key** (60% of cases)
   <!-- Source: Knowledge file from https://github.com/ably/ably-os/blob/main/output/error-codes/research/40106-knowledge.md lines 11-29 -->
   - No key provided during client initialization
   - Empty string passed as API key
   - Environment variable not set

2. **Incomplete token authentication setup** (25% of cases)
   <!-- Source: Knowledge file from https://github.com/ably/ably-os/blob/main/output/error-codes/research/40106-knowledge.md lines 31-42 -->
   - Missing authUrl or authCallback for token auth
   - Trying to request a token without proper credentials
   - Attempting to use a token to request another token

3. **Environment configuration issues** (10% of cases)
   <!-- Source: Knowledge file from https://github.com/ably/ably-os/blob/main/output/error-codes/research/40106-knowledge.md lines 44-49 -->
   - API key not set in production environment
   - Docker containers missing environment variables
   - Configuration files not loaded correctly

4. **Wrong authentication method** (5% of cases)
   <!-- Source: Knowledge file from https://github.com/ably/ably-os/blob/main/output/error-codes/research/40106-knowledge.md lines 51-56 -->
   - Trying to create signed token requests without an API key
   - Mixing authentication methods incorrectly

## Resolution Steps

1. **For basic authentication: Add your API key**
   <!-- Source: Knowledge file from https://github.com/ably/ably-os/blob/main/output/error-codes/research/40106-knowledge.md lines 61-67 -->
   ```javascript
   // ❌ Wrong: Missing key
   const ably = new Ably.Realtime({});
   
   // ✅ Correct: With API key
   const ably = new Ably.Realtime({
     key: 'your-app-id.your-key-id:your-key-secret'
   });
   ```

2. **For token authentication: Configure token source**
   <!-- Source: Knowledge file from https://github.com/ably/ably-os/blob/main/output/error-codes/research/40106-knowledge.md lines 69-84 -->
   ```javascript
   // Option 1: Auth URL
   const ably = new Ably.Realtime({
     authUrl: '/auth'
   });
   
   // Option 2: Auth callback
   const ably = new Ably.Realtime({
     authCallback: async (tokenParams, callback) => {
       const token = await fetchTokenFromYourServer(tokenParams);
       callback(null, token);
     }
   });
   ```

3. **For environment variables: Set and verify**
   <!-- Source: Knowledge file from https://github.com/ably/ably-os/blob/main/output/error-codes/research/40106-knowledge.md lines 86-98 -->
   ```bash
   # Set environment variable
   export ABLY_API_KEY="your-app-id.your-key-id:your-key-secret"
   ```
   
   ```javascript
   // Use in application
   const ably = new Ably.Realtime({
     key: process.env.ABLY_API_KEY
   });
   ```

4. **Verify your API key format**
   <!-- Source: Analysis file from https://github.com/ably/ably-os/blob/main/output/error-codes/research/40106-analysis.md lines 14-19, Knowledge file verification steps -->
   - Check the key follows the format: `app-id.key-id:key-secret`
   - Ensure no extra spaces or line breaks
   - Verify the key hasn't expired or been revoked in your dashboard

5. **For server-side token generation**
   <!-- Source: Knowledge file from https://github.com/ably/ably-os/blob/main/output/error-codes/research/40106-knowledge.md lines 115-132 -->
   ```javascript
   // Server endpoint to generate tokens
   app.post('/auth', async (req, res) => {
     const ably = new Ably.Rest({ key: process.env.ABLY_API_KEY });
     const tokenRequest = await ably.auth.createTokenRequest();
     res.json(tokenRequest);
   });
   ```

## Automatic Handling

This is a configuration error that will not be automatically retried. You must provide valid authentication credentials before the operation will succeed.
<!-- Source: Analysis file from https://github.com/ably/ably-os/blob/main/output/error-codes/research/40106-analysis.md lines 87-88 -->

## Prevention

- Store API keys in environment variables, not in code
  <!-- Source: Knowledge file from https://github.com/ably/ably-os/blob/main/output/error-codes/research/40106-knowledge.md lines 178-186 -->
- Validate authentication configuration at application startup
  <!-- Source: Knowledge file from https://github.com/ably/ably-os/blob/main/output/error-codes/research/40106-knowledge.md lines 188-195 -->
- Use configuration templates for different environments
  <!-- Source: Knowledge file from https://github.com/ably/ably-os/blob/main/output/error-codes/research/40106-knowledge.md lines 215-223 -->
- Test authentication setup in all deployment environments
  <!-- Source: Knowledge file from https://github.com/ably/ably-os/blob/main/output/error-codes/research/40106-knowledge.md lines 237-249 -->

## Platform-Specific Notes

### JavaScript/Node.js
The error typically occurs during client initialization. Ensure your API key or authentication method is configured before creating the client.

### Java
<!-- Source: Analysis file from https://github.com/ably/ably-os/blob/main/output/error-codes/research/40106-analysis.md lines 14-19 -->
Validates during `requestToken()` calls. Requires authCallback, authUrl, or key.

### .NET
<!-- Source: Analysis file from https://github.com/ably/ably-os/blob/main/output/error-codes/research/40106-analysis.md lines 24-34 -->
Checks authentication during both AuthOptions construction and auth method creation. May return different HTTP status codes (401 or 404) depending on context.

### Rust
<!-- Source: Analysis file from https://github.com/ably/ably-os/blob/main/output/error-codes/research/40106-analysis.md lines 39-43 -->
Validates API key specifically when creating signed token requests.

## Related Resources

- [Authentication documentation](https://ably.com/docs/auth)
- [Basic authentication guide](https://ably.com/docs/auth/basic)
- [Token authentication guide](https://ably.com/docs/auth/token)
- [Client options reference](https://ably.com/docs/api/realtime-sdk/client-options)

## Need Further Help?

If you're still experiencing issues after trying these steps, our support team is here to help.

**Contact Ably Support**: https://ably.com/support

When contacting support, please provide:
- Your account ID and app ID
- The full error message including error code 40106
- Steps to reproduce the issue
- Any relevant code snippets (without sensitive credentials)
- The SDK and version you're using

Our team will help you resolve this issue as quickly as possible.

<!-- =============================================== -->
<!-- INTERNAL DOCUMENTATION (NOT RENDERED) -->
<!-- =============================================== -->

<!-- SOURCES USED (ALWAYS use GitHub URLs, never local paths):
- Analysis File: https://github.com/ably/ably-os/blob/main/output/error-codes/research/40106-analysis.md
- Knowledge File: https://github.com/ably/ably-os/blob/main/output/error-codes/research/40106-knowledge.md
- Editorial Notes: https://github.com/ably/ably-os/blob/main/src/prompts/errors/editorial-notes.md (No specific error-specific notes for 40106)
-->

<!-- CONTENT DECISIONS:
- FAQ Content Preserved: Resolution examples from https://github.com/ably/ably-os/blob/main/output/error-codes/research/40106-knowledge.md lines 60-132
- Content Excluded: Detailed testing strategies (lines 237-249) kept brief in Prevention section
- Recommendations Source: All resolution steps based on knowledge file documented patterns
- Code Examples Rationale: Included minimal examples from knowledge file as they are essential for showing correct vs incorrect authentication setup
-->

<!-- ATTRIBUTION BY SECTION:
- Common Causes: 
  - Cause 1: Based on knowledge file https://github.com/ably/ably-os/blob/main/output/error-codes/research/40106-knowledge.md lines 11-29
  - Cause 2: From knowledge file https://github.com/ably/ably-os/blob/main/output/error-codes/research/40106-knowledge.md lines 31-42
  - Cause 3: From knowledge file https://github.com/ably/ably-os/blob/main/output/error-codes/research/40106-knowledge.md lines 44-49
  - Cause 4: From knowledge file https://github.com/ably/ably-os/blob/main/output/error-codes/research/40106-knowledge.md lines 51-56
- Resolution Steps: 
  - Step 1: From knowledge file https://github.com/ably/ably-os/blob/main/output/error-codes/research/40106-knowledge.md lines 61-67
  - Step 2: From knowledge file https://github.com/ably/ably-os/blob/main/output/error-codes/research/40106-knowledge.md lines 69-84
  - Step 3: From knowledge file https://github.com/ably/ably-os/blob/main/output/error-codes/research/40106-knowledge.md lines 86-98
  - Step 4: Combined analysis file insight with knowledge file verification approach
  - Step 5: From knowledge file https://github.com/ably/ably-os/blob/main/output/error-codes/research/40106-knowledge.md lines 115-132
- Prevention: Based on best practices from knowledge file https://github.com/ably/ably-os/blob/main/output/error-codes/research/40106-knowledge.md lines 177-249
- Platform Notes: From analysis file https://github.com/ably/ably-os/blob/main/output/error-codes/research/40106-analysis.md repository-specific sections
-->

<!-- IMPROVEMENT INSTRUCTIONS:
To improve this error code documentation:
1. First approach: Update editorial-notes.md in ably-os repository with specific guidance for error 40106
2. Regenerate: Run `./bin/ably-os errors document-error-codes 40106 --force`
3. For broader improvements: Review and update ably-os prompt templates
4. Context: See https://github.com/ably/ably-os/blob/main/docs/ERROR_COMMANDS_GUIDE.md
5. Source repository: https://github.com/ably/ably-os
-->