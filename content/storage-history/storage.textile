---
title:  Message Storage
meta_description: "Explore the different ways Ably can handle Message Storage"
---

By default Ably will store messages for just two minutes so that they can be recovered automatically as part of "connection state recovery":/connect/states. in the event of a lost connection. However, there are a number of options available to increase this storage time. You can persist all of your messages (typically for 24 hours), persist the last message then access it using the "channel Rewind":/channels/options/rewind option, or use "Integrations":/integrations to persist messages externally for long-term storage. 

h2(#default-persistence). Default message storage - two minutes

The default message storage of two minutes allows Ably to automatically resend messages lost from a brief disconnection. History can also be used to recover these messages in the original order they were sent, and applies to both "regular channel messages":/channels/messages and "presence messages":/presence-occupancy/presence.  

The following diagram illustrates the default persistence of messages:

<a href="/images/diagrams/history-default.png" target="_blank">
  <img src="/images/diagrams/history-default.png" style="width: 100%" alt="Default Persistence">
</a>

Read more about the "History":/storage-history/history or the "Realtime connection state recovery":/connect/states.


h2(#all-message-persistence). Persist all messages - 24 or 72 hours

If you need to retain messages for longer than the default two minutes you can enable "persisted history" when setting a "channel rule":/channels. When "persisted history is enabled":#persisted-history for a channel any messages will be stored on disk for 24 or 72 depending on your account package.

In this scenario, History can be used to retrieve the persisted messages. This is illustrated in the following diagram:

<a href="/images/diagrams/history-persist-all-messages.png" target="_blank">
  <img src="/images/diagrams/history-persist-all-messages.png" style="width: 100%" alt="Persist All Messages">
</a>

Every message that is persisted to, or retrieved from, disk counts as an extra message towards your monthly quota. For example, with persistence enabled a published message counts as two messages for your monthly quota. If the message is then retrieved another message will be deducted from your monthly quota.

To enable History on a channel add a @persist all messages@ "channel rule":/channels in the settings of your Ably "dashboard":https://ably.com/dashboard.

DASHBOARD-INSTRUCTION

    Select the settings tab from your Ably "dashboard":https://ably.com/dashboard :

    <a href="/images/screenshots/storage/dashboard-settings.png" target="_blank">
      <img src="/images/screenshots/storage/dashboard-settings.png" style="width: 100%" alt="Settings button">
    </a>

    Scroll down and click "Add new rule":

    <a href="/images/screenshots/storage/dashboard-channel-rule.png" target="_blank">
        <img src="/images/screenshots/storage/dashboard-channel-rule.png" style="width: 100%" alt="Add new rule button">
    </a>

    Tick "Persist all messages":

    <a href="/images/screenshots/storage/dashboard-persist-all.png" target="_blank">
        <img src="/images/screenshots/storage/dashboard-persist-all.png" style="width: 100%" alt="Persist all messages checkbox">
    </a>

    Click "Create channel rule":

    <a href="/images/screenshots/storage/dashboard-save.png" target="_blank">
        <img src="/images/screenshots/storage/dashboard-save.png" style="width: 100%" alt="Create channel rule button">
    </a>


h2(#persist-last-message). Persist last message - 365 days

You can also choose to persist just "the last message":/channels on a channel, which persists the last published message for one year. 

This message cannot be retrieved with History, you must use the "channel Rewind":/channels/options/rewind option. Note that only regular channel messages can be stored, not presence messages. 

This option for persistence is illustrated in the following diagram:

<a href="/images/diagrams/history-persist-last-message.png" target="_blank">
  <img src="/images/diagrams/history-persist-last-message.png" style="width: 100%" alt="Persist Last Message">
</a>

DASHBOARD-INSTRUCTION

    Select the settings tab from your Ably "dashboard":https://ably.com/dashboard :

    <a href="/images/screenshots/storage/dashboard-settings.png" target="_blank">
        <img src="/images/screenshots/storage/dashboard-settings.png" style="width: 100%" alt="Settings button">
    </a>

    Scroll down and click "Add new rule":

    <a href="/images/screenshots/storage/dashboard-channel-rule.png" target="_blank">
        <img src="/images/screenshots/storage/dashboard-channel-rule.png" style="width: 100%" alt="Add new rule button">
    </a>

    Tick "Persist last message":

    <a href="/images/screenshots/storage/dashboard-persist-last.png" target="_blank">
        <img src="/images/screenshots/storage/dashboard-persist-last.png" style="width: 100%" alt="Persist last message checkbox">
    </a>

    Click "Create channel rule":
    
    <a href="/images/screenshots/storage/dashboard-save.png" target="_blank">
        <img src="/images/screenshots/storage/dashboard-save.png" style="width: 100%" alt="Create channel rule button">
    </a>


h2(#outside-persistence). Store messages outside of Ably

Another option for persisting messages is to use "integration rules":/integrations to store your messages outside of Ably. Using integrations you can set up external webhooks so when a messages are sent to a channel, a notification is sent to the specified endpoint, allowing pipelines to be created for long term message storage. 

For example if you wanted to store long term messages for a chat app you can set up an integration rule triggering an action that notifies and copies data to a third party storage system for persistence whenever a message is sent.

Visit the "Integrations section":/integrations to see the available options for outgoing integrations.