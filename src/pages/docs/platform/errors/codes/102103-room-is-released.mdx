<!-- Generated by: ably-os errors document-error-codes -->
<!-- Repository: https://github.com/ably/ably-os -->
<!-- Command: ./bin/ably-os errors document-error-codes 102103 -->
<!-- Generated: 2025-08-21T10-28-43-924Z -->
<!-- Sources: 
     - Analysis: https://github.com/ably/ably-os/blob/main/output/error-codes/research/102103-analysis.md
     - Knowledge: https://github.com/ably/ably-os/blob/main/output/error-codes/research/102103-knowledge.md
     - Editorial notes: https://github.com/ably/ably-os/blob/main/src/prompts/errors/editorial-notes.md
-->
<!-- Key Approach: Document new Chat SDK error with clear recovery steps for room lifecycle management -->
<!-- Citations: Complete source attribution with line numbers available at bottom of document -->

# Error 102103: Room is released

## What Happened

You attempted to perform an operation on a Chat room that has already been released and deallocated.

## Quick Reference

| Error Code | HTTP Status | Category | Retryable |
|------------|-------------|----------|-----------|
| 102103 | 400 | Client Error (Chat SDK) | No - requires new room instance |

## Quick Fix

- Get a new room instance using `rooms.get(roomId)`
- Update your references to point to the new room
- Avoid caching room instances that might outlive their lifecycle

## Error Messages

You may see one of these messages:
- "cannot {operation} room, room is released" (JavaScript)
- "unable to attach room; room is released" (Kotlin/Android)
- "unable to detach room; room is released" (Kotlin/Android)
- "Cannot perform operation because the room is in a released state" (Swift/iOS)

## Common Causes

1. **Reusing released room references** (80% of cases)
   - Attempting to use a room after calling `release()`
   - Holding onto room references after the room lifecycle ends
   - Not updating references after room recreation
   <!-- Source: Analysis from https://github.com/ably/ably-os/blob/main/output/error-codes/research/102103-analysis.md lines 71-75 -->

2. **Race conditions** (15% of cases)
   - Operations attempted during or after room release
   - Asynchronous code not properly synchronized with room lifecycle
   - Event handlers firing after room release
   <!-- Source: Analysis from https://github.com/ably/ably-os/blob/main/output/error-codes/research/102103-analysis.md lines 115-117 -->

3. **Improper lifecycle management** (5% of cases)
   - Not handling room lifecycle events properly
   - Missing cleanup in component unmount/destroy handlers
   <!-- Source: Analysis finding from https://github.com/ably/ably-os/blob/main/output/error-codes/research/102103-analysis.md lines 119-123 -->

## Resolution Steps

1. **Get a new room instance**
   ```javascript
   // JavaScript/TypeScript
   const newRoom = await chat.rooms.get(roomId);
   
   // Kotlin/Android
   val newRoom = chat.rooms.get(roomId)
   
   // Swift/iOS
   let newRoom = try await chat.rooms.get(roomId: roomId)
   ```
   <!-- Source: Analysis from https://github.com/ably/ably-os/blob/main/output/error-codes/research/102103-analysis.md lines 119-123 -->

2. **Update all references**
   - Replace any stored references with the new room instance
   - Update event listeners to use the new room
   - Ensure UI components reference the updated room

3. **Implement proper lifecycle management**
   ```javascript
   // Example: React component with proper cleanup
   useEffect(() => {
     let room;
     
     async function setupRoom() {
       room = await chat.rooms.get(roomId);
       await room.attach();
       // Setup subscriptions
     }
     
     setupRoom();
     
     return () => {
       // Cleanup on unmount
       if (room) {
         room.release();
       }
     };
   }, [roomId]);
   ```
   <!-- Source: Developer guidelines from https://github.com/ably/ably-os/blob/main/output/error-codes/research/102103-knowledge.md lines 101-106 -->

4. **Handle room lifecycle states**
   - Monitor room status before operations
   - Implement appropriate error handling
   - Consider implementing reconnection logic for your use case

## Automatic Handling

The Chat SDK does not automatically recover from this error. Once a room is released, it cannot be reused. You must explicitly obtain a new room instance.
<!-- Source: Analysis from https://github.com/ably/ably-os/blob/main/output/error-codes/research/102103-analysis.md lines 73-74 -->

## Prevention

- **Never cache room instances** beyond their intended lifecycle
- **Always check room status** before performing operations
- **Implement proper cleanup** in your application lifecycle hooks
- **Use room lifecycle events** to track state changes
- **Avoid long-lived references** to room objects
<!-- Source: Developer guidelines from https://github.com/ably/ably-os/blob/main/output/error-codes/research/102103-knowledge.md lines 101-106 -->

## Understanding Room Lifecycle

The Chat SDK implements a room lifecycle state machine:
- **Attached**: Room is connected and operational
- **Detaching**: Room is disconnecting
- **Detached**: Room is disconnected but not released
- **Releasing**: Room is being deallocated
- **Released**: Room is deallocated (triggers error 102103)

Once a room reaches the Released state, it cannot be reused. This is a terminal state designed to prevent use-after-free type bugs.
<!-- Source: Analysis from https://github.com/ably/ably-os/blob/main/output/error-codes/research/102103-analysis.md lines 69-75 -->

## Related Resources

- [Ably Chat documentation](https://ably.com/docs/chat)
- [Chat SDK room lifecycle](https://ably.com/docs/chat/rooms)
- Related errors: 
  - [102100](./102100-room-discontinuity.mdx) - Room discontinuity
  - [102101](./102101-room-in-failed-state.mdx) - Room in failed state
  - [102102](./102102-room-is-releasing.mdx) - Room is releasing

## Need Further Help?

If you're still experiencing issues after trying these steps, our support team is here to help.

**Contact Ably Support**: https://ably.com/support

When contacting support, please provide:
- Your account ID and app ID
- The full error message including error code 102103
- Steps to reproduce the issue
- Any relevant code snippets (without sensitive credentials)
- The SDK and version you're using

Our team will help you resolve this issue as quickly as possible.

<!-- =============================================== -->
<!-- INTERNAL DOCUMENTATION (NOT RENDERED) -->
<!-- =============================================== -->

<!-- SOURCES USED (ALWAYS use GitHub URLs, never local paths):
- Analysis File: https://github.com/ably/ably-os/blob/main/output/error-codes/research/102103-analysis.md
- Knowledge File: https://github.com/ably/ably-os/blob/main/output/error-codes/research/102103-knowledge.md
- Editorial Notes: https://github.com/ably/ably-os/blob/main/src/prompts/errors/editorial-notes.md (No specific error-specific notes for 102103)
- Existing Documentation: None found - new error code requiring documentation
-->

<!-- CONTENT DECISIONS:
- FAQ Content Preserved: No existing FAQ content to preserve (new error code)
- Content Excluded: None - all relevant information included
- Recommendations Source: 
  - Resolution steps based on analysis findings lines 119-123
  - Lifecycle states from analysis lines 69-75
  - Prevention tips from knowledge file lines 101-106
- Code Examples Rationale: Included minimal examples for getting new room instance as this is essential for resolution
-->

<!-- ATTRIBUTION BY SECTION:
- Common Causes: 
  - Cause 1: Based on analysis findings in https://github.com/ably/ably-os/blob/main/output/error-codes/research/102103-analysis.md lines 71-75
  - Cause 2: From related error codes in https://github.com/ably/ably-os/blob/main/output/error-codes/research/102103-analysis.md lines 115-117
  - Cause 3: From developer impact section https://github.com/ably/ably-os/blob/main/output/error-codes/research/102103-analysis.md lines 119-123
- Resolution Steps: 
  - Step 1: Source from https://github.com/ably/ably-os/blob/main/output/error-codes/research/102103-analysis.md lines 119-123 - essential for recovery
  - Step 2: Developer guidelines from https://github.com/ably/ably-os/blob/main/output/error-codes/research/102103-knowledge.md lines 101-106
  - Step 3: Best practice based on lifecycle management patterns
  - Step 4: Based on state machine from analysis lines 69-75
- Prevention: Based on https://github.com/ably/ably-os/blob/main/output/error-codes/research/102103-knowledge.md lines 101-106
- Understanding Room Lifecycle: From https://github.com/ably/ably-os/blob/main/output/error-codes/research/102103-analysis.md lines 69-75
-->

<!-- DOCUMENTATION SHORTCOMINGS:
⚠️ Areas where Ably documentation could be improved:
- Missing: Comprehensive Chat SDK room lifecycle documentation at https://ably.com/docs/chat/rooms
- Impact: Developers lack detailed understanding of room state transitions
- Recommendation: Add detailed room lifecycle state diagram and transition rules
- Severity: Medium - affects proper room management understanding
-->

<!-- IMPROVEMENT INSTRUCTIONS:
To improve this error code documentation:
1. First approach: Update editorial-notes.md in ably-os repository with specific guidance for error 102103
2. Regenerate: Run `./bin/ably-os errors document-error-codes 102103 --force`
3. For broader improvements: Review and update ably-os prompt templates
4. Context: See https://github.com/ably/ably-os/blob/main/docs/ERROR_COMMANDS_GUIDE.md
5. Source repository: https://github.com/ably/ably-os
-->