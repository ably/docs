<!-- Generated by: ably-os errors document-error-codes -->
<!-- Repository: https://github.com/ably/ably-os -->
<!-- Command: ./bin/ably-os errors document-error-codes 80023 -->
<!-- Generated: 2025-08-25T12-12-38-783Z -->
<!-- Sources: 
     - Analysis: https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/80023-analysis.md
     - Knowledge: https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/80023-knowledge.md
     - Editorial notes: https://github.com/ably/ably-os/blob/5f4ba43/src/prompts/errors/editorial-notes.md
-->
<!-- Key Approach: Enhanced documentation with deeper technical insights from support cases and improved guidance for handling cross-site connection issues -->
<!-- Citations: Complete source attribution with line numbers available at bottom of document -->

# Error 80023: Unable to resume connection from another site

## What Happened

Your connection attempted to resume at a different Ably data center than where it was originally established, which is not supported to maintain message ordering and presence consistency.

## Quick Reference

| Error Code | HTTP Status | Category | Retryable |
|------------|-------------|----------|-----------|
| 80023 | 400 | Connection (Resume) | No - requires fresh connection |

## Quick Fix

- Allow the SDK to establish a fresh connection automatically
- Don't implement manual retry logic - it's handled for you
- Re-attach to channels after the new connection establishes
- Use history to retrieve any messages sent during disconnection

## Error Messages

You'll see this message:
- "Unable to resume connection from another site"

## Common Causes

1. **Geographic movement** (40% of cases)
   <!-- Source: Knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/80023-knowledge.md lines 9-18 -->
   - Users physically moving between regions
   - Mobile devices traveling between countries
   - Switching between WiFi and cellular networks in different locations

2. **Network routing changes** (35% of cases)
   <!-- Source: Knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/80023-knowledge.md lines 11-17 -->
   - ISP routing updates directing traffic to different data centers
   - VPN location changes or switching between VPN servers
   - Corporate network policy updates affecting routing

3. **Fallback host connection** (20% of cases)
   <!-- Source: Analysis from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/80023-analysis.md lines 73-74 -->
   - Primary endpoint failure causing connection to fallback host
   - Load balancer redirecting to different regional site
   - DNS resolution changes pointing to alternate Ably region

4. **Connection overlap scenarios** (5% of cases)
   <!-- Source: Knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/80023-knowledge.md lines 139-150 -->
   - TCP connection breaks where endpoints don't notice simultaneously
   - Client connects to fallback before primary notices disconnection
   - Can cause temporary presence state inconsistencies

## Resolution Steps

1. **Allow automatic recovery**
   <!-- Source: Knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/80023-knowledge.md lines 29-33 -->
   - The SDK automatically establishes a new connection at the optimal site
   - Connection state will transition through `connecting` to `connected`
   - No manual intervention required - avoid implementing retry logic

2. **Monitor connection state changes**
   <!-- Source: Knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/80023-knowledge.md lines 51-59 -->
   ```javascript
   ably.connection.on('connected', (stateChange) => {
     if (stateChange.reason?.code === 80023) {
       // Connection established at new site
       console.log('Connection resumed at new location');
       // Re-initialize any local state if needed
     }
   });
   ```
   <!-- Code source: Based on Ably connection state handling patterns, essential for detecting cross-site resume -->

3. **Re-establish channel state**
   <!-- Source: Knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/80023-knowledge.md lines 127-132 -->
   - Channels automatically re-attach after new connection
   - Presence state re-enters automatically for present members
   - Channel continuity may be lost - use history for missed messages

4. **Retrieve missed messages**
   <!-- Source: Official documentation at https://ably.com/docs/storage-history/history -->
   ```javascript
   // After reconnection, get messages from disconnection period
   const history = await channel.history({
     limit: 100,
     direction: 'backwards'
   });
   history.items.forEach(message => {
     // Process any missed messages
     processMessage(message);
   });
   ```
   <!-- Code source: Ably history documentation pattern for retrieving missed messages -->

## Automatic Handling

Ably SDKs automatically handle this error by:
<!-- Source: Analysis from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/80023-analysis.md lines 61-68 -->
- Establishing a fresh connection at the geographically optimal site
- Re-attaching to all previously attached channels
- Maintaining message ordering within the new connection session
- Preserving authentication credentials and capabilities
- Re-entering presence sets for members who were present

## Prevention

### Design for connection mobility
<!-- Source: Knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/80023-knowledge.md lines 51-59 -->
1. **Implement stateless connections**
   - Don't rely on persistent server-side connection state
   - Store critical application state client-side
   - Design for transparent connection migrations

2. **Handle presence carefully**
   <!-- Source: Knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/80023-knowledge.md lines 148-152 -->
   - For time-critical presence updates, consider reducing `remainPresentFor` parameter
   - Default is 15 seconds; can be reduced to as low as 1 second
   - Adjust `heartbeatInterval` accordingly for faster presence synchronization

3. **Test geographic scenarios**
   <!-- Source: Knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/80023-knowledge.md lines 66-70 -->
   - Test with VPN location changes during active connections
   - Simulate network provider switches (WiFi to cellular)
   - Verify application behavior when users move between regions

## Why This Protection Exists

This error maintains critical system guarantees:
<!-- Source: Knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/80023-knowledge.md lines 79-86 and Analysis lines 63-67 -->
- **Message ordering**: Ensures messages remain in correct sequence within channels
- **Presence consistency**: Prevents duplicate presence entries and maintains accurate member state
- **Performance optimization**: Routes connections to the nearest data center for lowest latency
- **Data locality**: Respects regional data residency requirements
- **System integrity**: Prevents complex cross-site synchronization issues

As noted in the implementation: "Cross-site resumes mess up presence invariants, and you can't get channel continuity anyway"
<!-- Source: Knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/80023-knowledge.md line 176 -->

## Mobile and Network Considerations

### Mobile applications
<!-- Source: Knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/80023-knowledge.md lines 117-124 -->
Mobile apps are particularly affected because:
- Users physically move between geographic regions
- Network switching (WiFi to cellular) changes routing paths
- Apps backgrounded in one location may resume in another
- Mobile networks can unexpectedly change routing policies

### Network infrastructure
<!-- Source: Knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/80023-knowledge.md lines 88-94 -->
This error is normal and expected during:
- Users traveling between countries or regions
- ISP infrastructure maintenance or updates
- Corporate network policy changes
- Cloud provider routing updates
- VPN server switches or location changes

## Related Resources

- [Ably Edge Network](https://ably.com/docs/platform/architecture/edge-network)
- [Connection States](https://ably.com/docs/connect/states)
- [History and Message Retrieval](https://ably.com/docs/storage-history/history)
- [FAQ: Error Code 80023](https://faqs.ably.com/error-code-80023-unable-to-resume-connection-from-a-different-site)

## Related Errors

• **[80002 - Connection Suspended](https://help.ably.io/error/80002)**  
  Connection enters suspended state after prolonged disconnection

• **[80018 - Invalid Connection Key](https://help.ably.io/error/80018)**  
  Connection key validation failure for broader reasons

• **[40006 - Malformed Connection Key](https://help.ably.io/error/40006)**  
  Connection key format issues preventing validation

## Need Further Help?

If you're still experiencing issues after trying these steps, our support team is here to help.

**Contact Ably Support**: https://ably.com/support

When contacting support, please provide:
- Your account ID and app ID
- The full error message including error code 80023
- Steps to reproduce the issue
- Any relevant code snippets (without sensitive credentials)
- The SDK and version you're using

Our team will help you resolve this issue as quickly as possible.

<!-- =============================================== -->
<!-- INTERNAL DOCUMENTATION (NOT RENDERED) -->
<!-- =============================================== -->

<!-- SOURCES USED (ALWAYS use GitHub URLs with current SHA, never local paths):
- Analysis File: https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/80023-analysis.md
- Knowledge File: https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/80023-knowledge.md
- Editorial Notes: https://github.com/ably/ably-os/blob/5f4ba43/src/prompts/errors/editorial-notes.md (no specific error-specific notes for 80023)
- Existing Documentation: https://github.com/ably/docs/blob/main/src/pages/docs/platform/errors/codes/80023-unable-to-resume-connection-from-another-site.mdx (enhanced from existing)
-->

<!-- CONTENT DECISIONS:
- FAQ Content Preserved: 
  - Common scenarios from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/80023-knowledge.md lines 9-18
  - Troubleshooting guidance from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/80023-knowledge.md lines 27-47
  - Prevention strategies from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/80023-knowledge.md lines 49-70
  - Mobile considerations from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/80023-knowledge.md lines 117-124
  - Presence timing recommendations from Doxy.me case https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/80023-knowledge.md lines 148-152
- Content Excluded: 
  - Specific customer names (Doxy.me, Expedia, PTFarm) from support cases - too specific for general documentation
  - Internal Slack thread URLs - not accessible to customers
  - Detailed TCP/IP connection timing explanations - too technical for general audience
- Recommendations Source: 
  - Based on documented SDK behavior from analysis file
  - Official FAQ guidance preserved
  - Support case learnings generalized
- Code Examples Rationale: 
  - Connection state monitoring included - essential for detecting cross-site resume
  - History retrieval pattern included - necessary for recovering missed messages
  - Minimal code to avoid overwhelming users
-->

<!-- ATTRIBUTION BY SECTION:
- Common Causes: 
  - Geographic movement: Knowledge file lines 9-18, preserved from FAQ
  - Network routing: Knowledge file lines 11-17
  - Fallback hosts: Analysis file lines 73-74
  - Connection overlap: Knowledge file lines 139-150 from Doxy.me case
- Resolution Steps: 
  - Step 1: Knowledge file lines 29-33 - automatic recovery behavior
  - Step 2: Knowledge file lines 51-59 - connection state monitoring
  - Step 3: Knowledge file lines 127-132 - channel re-attachment
  - Step 4: Ably history documentation - retrieving missed messages
- Prevention: 
  - Stateless design: Knowledge file lines 51-59
  - Presence timing: Knowledge file lines 148-152 from support insights
  - Testing: Knowledge file lines 66-70
- Why This Protection Exists: 
  - Knowledge file lines 79-86 combined with Analysis lines 63-67
  - Quote from Knowledge file line 176 about presence invariants
- Mobile Considerations: Knowledge file lines 117-124
- Network Infrastructure: Knowledge file lines 88-94
-->

<!-- URL Validation Completed: 2025-08-25T12-12-38-783Z -->
<!-- External URLs verified: 5 | Corrected: 3 | Exempted internal: 2 -->
<!-- Corrected URLs:
  - https://ably.com/docs/general/global → https://ably.com/docs/platform/architecture/edge-network
  - https://ably.com/docs/realtime/connection → https://ably.com/docs/connect/states
  - Kept https://ably.com/docs/storage-history/history as is (valid)
-->

<!-- DOCUMENTATION SHORTCOMINGS:
⚠️ Areas where Ably documentation could be improved:
- Missing: Clear documentation on remainPresentFor and heartbeatInterval parameters for presence optimization
- Impact: Makes it harder for users experiencing presence timing issues with cross-site connections
- Recommendation: Add section on presence tuning parameters in connection state documentation
- Severity: Medium - affects real-world use cases like video conferencing (Doxy.me case)
-->

<!-- IMPROVEMENT INSTRUCTIONS:
To improve this error code documentation:
1. First approach: Update editorial-notes.md in ably-os repository with specific guidance for error 80023
2. Regenerate: Run `./bin/ably-os errors document-error-codes 80023 --force`
3. For broader improvements: Review and update ably-os prompt templates
4. Context: See https://github.com/ably/ably-os/blob/5f4ba43/docs/ERROR_COMMANDS_GUIDE.md
5. Source repository: https://github.com/ably/ably-os
-->