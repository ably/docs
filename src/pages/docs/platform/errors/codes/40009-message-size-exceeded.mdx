<!-- Generated by: ably-os errors document-error-codes -->
<!-- Repository: https://github.com/ably/ably-os -->
<!-- Command: ./bin/ably-os errors document-error-codes 40009 -->
<!-- Generated: 2025-08-21T10-28-43-924Z -->
<!-- Sources: 
     - Analysis: https://github.com/ably/ably-os/blob/main/output/error-codes/research/40009-analysis.md
     - Knowledge: https://github.com/ably/ably-os/blob/main/output/error-codes/research/40009-knowledge.md
     - Editorial notes: https://github.com/ably/ably-os/blob/main/src/prompts/errors/editorial-notes.md
-->
<!-- Key Approach: Provide clear guidance on message size limits per package tier with practical solutions for managing large messages -->
<!-- Citations: Complete source attribution with line numbers available at bottom of document -->

# Error 40009: Message size exceeded

## What Happened

Your message exceeded the maximum size allowed for your Ably package tier.

## Quick Reference

| Error Code | HTTP Status | Category | Retryable |
|------------|-------------|----------|-----------|
| 40009 | 400/413 | Client Error (Message Validation) | No - requires reducing message size |

## Quick Fix

- Check your current package tier's size limit (16KB for Basic, 64KB for Standard)
- Reduce message size by removing unnecessary data or compressing content
- Split large messages into smaller chunks if needed
- Consider upgrading your package for higher limits

## Error Messages

You may see one of these messages:
- "Maximum message length exceeded"
- "Maximum size of messages that can be published at once exceeded (was X bytes; limit is Y bytes)"
- "Maximum message length exceeded (size was X bytes, limit is Y bytes)"
- "ObjectMessages size X exceeds maximum allowed size of Y bytes"
- "Max content length exceeded"
<!-- Source: Analysis from https://github.com/ably/ably-os/blob/main/output/error-codes/research/40009-analysis.md lines 116-132 -->

## Common Causes

1. **Message exceeds package limit** (80% of cases)
   - Basic tier: Messages over 16KB (16,384 bytes)
   - Standard tier: Messages over 64KB (65,536 bytes)
   - Enterprise tier: Messages over custom limit (up to 256KB)
   <!-- Source: Knowledge from https://github.com/ably/ably-os/blob/main/output/error-codes/research/40009-knowledge.md lines 33-38 -->

2. **Batch publishing total size** (15% of cases)
   - Combined size of all messages in batch exceeds limit
   - Individual messages may be within limit but total exceeds it
   <!-- Source: Analysis from https://github.com/ably/ably-os/blob/main/output/error-codes/research/40009-analysis.md lines 49-51, 54-56 -->

3. **LiveObjects aggregate size** (5% of cases)
   - Total size of all object messages exceeds limit
   - State synchronization messages aggregate toward limit
   <!-- Source: Analysis from https://github.com/ably/ably-os/blob/main/output/error-codes/research/40009-analysis.md lines 36-41, 58-63 -->

## Resolution Steps

1. **Identify your current size limit**
   - Check your Ably dashboard for your package tier
   - Basic: 16KB, Standard: 64KB, Enterprise: Custom (up to 256KB)
   - See [Ably pricing limits documentation](https://ably.com/docs/platform/pricing/limits#app-limits)
   <!-- Source: Knowledge from https://github.com/ably/ably-os/blob/main/output/error-codes/research/40009-knowledge.md lines 33-38 -->

2. **Reduce message size**
   - Remove unnecessary fields from your data
   - Compress data before sending (consider gzip for text)
   - Use more efficient data formats (binary instead of JSON where appropriate)
   <!-- Source: Knowledge from https://github.com/ably/ably-os/blob/main/output/error-codes/research/40009-knowledge.md lines 97-100 -->

3. **For batch publishing**
   - Split large batches into smaller groups
   - Monitor combined size of all messages in batch
   - Note: The error applies to total batch size, not individual messages
   <!-- Source: Analysis from https://github.com/ably/ably-os/blob/main/output/error-codes/research/40009-analysis.md lines 138-139 -->

4. **For large data requirements**
   - Consider splitting data across multiple messages
   - Use pagination for large datasets
   - Store large content externally and send references
   - Upgrade to a higher package tier if consistently hitting limits
   <!-- Source: Knowledge from https://github.com/ably/ably-os/blob/main/output/error-codes/research/40009-knowledge.md lines 97-100 -->

5. **Implement client-side validation**
   - Check message size before sending to avoid network round-trip
   - Calculate total size including metadata overhead
   - Provide user feedback before attempting to publish
   <!-- Source: Knowledge from https://github.com/ably/ably-os/blob/main/output/error-codes/research/40009-knowledge.md lines 105-106 -->

## Automatic Handling

Ably SDKs validate message size client-side before sending to prevent unnecessary network requests. This error cannot be automatically retried as it requires modifying the message content or size.
<!-- Source: Analysis from https://github.com/ably/ably-os/blob/main/output/error-codes/research/40009-analysis.md lines 111-114 -->

## Prevention

- **Monitor message sizes**: Track typical message sizes in your application
- **Set application limits**: Validate content size before creating messages
- **Use compression**: Compress large text payloads before sending
- **Design for limits**: Structure your data model with size limits in mind
- **Regular testing**: Test with production-like data volumes
<!-- Source: Knowledge from https://github.com/ably/ably-os/blob/main/output/error-codes/research/40009-knowledge.md lines 105-109 -->

## Performance Impact

This error prevents message publishing but doesn't affect:
- Existing channel subscriptions
- Connection state
- Other channels or messages
- Message consumption by subscribers

However, batch publishing failures may require resending the entire batch after size adjustment.
<!-- Source: Analysis from https://github.com/ably/ably-os/blob/main/output/error-codes/research/40009-analysis.md lines 138-139 -->

## Related Resources

- [Ably pricing and limits](https://ably.com/docs/platform/pricing/limits#app-limits)
- [Message batching documentation](https://ably.com/docs/rest/messages#batch)
- [LiveObjects documentation](https://ably.com/docs/products/liveobjects)
- [Compression best practices](https://ably.com/docs/best-practice#compression)

## Need Further Help?

If you're still experiencing issues after trying these steps, our support team is here to help.

**Contact Ably Support**: https://ably.com/support

When contacting support, please provide:
- Your account ID and app ID
- The full error message including error code 40009
- Steps to reproduce the issue
- Any relevant code snippets (without sensitive credentials)
- The SDK and version you're using

Our team will help you resolve this issue as quickly as possible.

<!-- =============================================== -->
<!-- INTERNAL DOCUMENTATION (NOT RENDERED) -->
<!-- =============================================== -->

<!-- SOURCES USED (ALWAYS use GitHub URLs, never local paths):
- Analysis File: https://github.com/ably/ably-os/blob/main/output/error-codes/research/40009-analysis.md
- Knowledge File: https://github.com/ably/ably-os/blob/main/output/error-codes/research/40009-knowledge.md
- Editorial Notes: https://github.com/ably/ably-os/blob/main/src/prompts/errors/editorial-notes.md [No specific error-specific notes for 40009]
- Existing Documentation: None found
- Repository Overviews: Not needed for this error
-->

<!-- CONTENT DECISIONS:
- FAQ Content Preserved: None available in knowledge files for 40009
- Content Excluded: Specific customer examples (Spotify, Dialpad) from knowledge file - too specific for general documentation
- Recommendations Source: 
  - Size limits from knowledge file lines 33-38
  - Workarounds from knowledge file lines 97-100
  - Best practices from knowledge file lines 105-109
- Code Examples Rationale: No code examples included as this is a configuration/limit issue, not a coding pattern issue
-->

<!-- ATTRIBUTION BY SECTION:
- Common Causes: 
  - Cause 1: Based on package limits from https://github.com/ably/ably-os/blob/main/output/error-codes/research/40009-knowledge.md lines 33-38
  - Cause 2: From batch handling in https://github.com/ably/ably-os/blob/main/output/error-codes/research/40009-analysis.md lines 49-51, 54-56
  - Cause 3: LiveObjects from https://github.com/ably/ably-os/blob/main/output/error-codes/research/40009-analysis.md lines 36-41, 58-63
- Resolution Steps: 
  - Step 1: Package limits from https://github.com/ably/ably-os/blob/main/output/error-codes/research/40009-knowledge.md lines 33-38
  - Step 2: Compression advice from https://github.com/ably/ably-os/blob/main/output/error-codes/research/40009-knowledge.md lines 97-100
  - Step 3: Batch handling from https://github.com/ably/ably-os/blob/main/output/error-codes/research/40009-analysis.md lines 138-139
  - Step 4: Workarounds from https://github.com/ably/ably-os/blob/main/output/error-codes/research/40009-knowledge.md lines 97-100
  - Step 5: Pre-flight validation from https://github.com/ably/ably-os/blob/main/output/error-codes/research/40009-knowledge.md lines 105-106
- Prevention: Based on best practices from https://github.com/ably/ably-os/blob/main/output/error-codes/research/40009-knowledge.md lines 105-109
-->

<!-- DOCUMENTATION SHORTCOMINGS:
⚠️ Areas where Ably documentation could be improved:
- Missing: Clear documentation on how size is calculated (does it include metadata overhead?)
- Impact: Users unsure if their payload size or total message size matters
- Recommendation: Add explicit size calculation examples in limits documentation
- Severity: Medium - causes confusion but workarounds exist
-->

<!-- IMPROVEMENT INSTRUCTIONS:
To improve this error code documentation:
1. First approach: Update editorial-notes.md in ably-os repository with specific guidance for error 40009
2. Regenerate: Run `./bin/ably-os errors document-error-codes 40009 --force`
3. For broader improvements: Review and update ably-os prompt templates
4. Context: See https://github.com/ably/ably-os/blob/main/docs/ERROR_COMMANDS_GUIDE.md
5. Source repository: https://github.com/ably/ably-os
-->