<!-- Generated by: ably-os errors document-error-codes -->
<!-- Repository: https://github.com/ably/ably-os -->
<!-- Command: ./bin/ably-os errors document-error-codes 101003 -->
<!-- Generated: 2025-08-24T21-13-57-640Z -->
<!-- Sources: 
     - Analysis: https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/101003-analysis.md
     - Knowledge: https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/101003-knowledge.md
     - Editorial notes: https://github.com/ably/ably-os/blob/5f4ba43/src/prompts/errors/editorial-notes.md
-->
<!-- Key Approach: This is an informational error in the Spaces SDK that indicates normal lock contention, not a failure condition. Enhanced documentation emphasizes developer experience patterns, implementation guidance, and clear understanding that this is expected behavior in distributed locking systems. -->
<!-- Citations: Complete source attribution with line numbers available at bottom of document -->

# Error 101003: Lock is locked

## What Happened?

The component lock you requested is currently held by another user, and your request did not take priority.

## Quick Reference

| Error Code | HTTP Status | Category | Retryable |
|------------|-------------|----------|-----------|
| 101003 | 400 | Locking/Conflict (Spaces) | Yes - lock will become available |

## Quick Fix

- This is normal behavior when multiple users try to lock the same component
- Subscribe to lock update events to know when the lock becomes available
- Implement retry logic with appropriate backoff

## Error Messages

You'll see this in the lock response:
- "lock is currently locked"

The error is assigned to the `reason` property when lock acquisition fails.

## Common Causes

1. **Concurrent lock attempts** (Most common)
   - Multiple users trying to edit the same component simultaneously
   - Normal behavior in collaborative applications
   - Part of the distributed locking mechanism design
   <!-- Source: Analysis finding from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/101003-analysis.md lines 41-46 -->

2. **Network timing and race conditions**
   - Lock requests arriving out of order due to network latency
   - Presence system delays affecting lock state synchronization
   - Temporary network disconnections causing lock state mismatches
   <!-- Source: Knowledge file from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/101003-knowledge.md lines 93-95 -->

3. **Priority resolution conflicts**
   - Timestamp-based priority system determines lock ownership
   - Connection ID used as tiebreaker when timestamps match
   - Existing lock holder maintains priority over new requests
   <!-- Source: Analysis finding from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/101003-analysis.md lines 49-51 -->

## Resolution Steps

1. **Handle as expected behavior**
   - This is not an error but normal lock contention
   - Design your UI to gracefully handle locked components
   - Show visual feedback about who holds the lock
   <!-- Source: FAQ advice from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/101003-knowledge.md lines 98-99, preserved for customer experience -->

2. **Subscribe to lock update events**
   - Monitor when the lock becomes available
   - Automatically retry when the lock is released
   - Implement a subscription before attempting lock acquisition
   <!-- Source: Analysis finding from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/101003-analysis.md lines 78-79 -->

3. **Implement proper retry strategy**
   - Use exponential backoff with jitter for retries
   - Set a maximum retry limit to prevent infinite loops
   - Consider offering manual retry option to users
   <!-- Source: Analysis finding from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/101003-analysis.md lines 79-80 -->

4. **Provide comprehensive visual feedback**
   - Show who currently holds the lock
   - Display queue position if applicable
   - Notify users when locks become available
   - Consider showing estimated wait time
   <!-- Source: Knowledge file from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/101003-knowledge.md lines 101-105 -->

## Automatic Handling

The Spaces SDK does not automatically retry lock acquisition. Your application must implement appropriate retry logic based on your specific use case and user experience requirements.
<!-- Source: Analysis finding from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/101003-analysis.md lines 68-70 -->

## Prevention

- Consider using optimistic UI updates where appropriate
- Design your collaborative features to minimize lock contention
- Implement clear visual indicators of component availability
- Use granular locking (lock smaller components when possible)
- Consider read-only modes for viewing without locking
<!-- Source: Knowledge file from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/101003-knowledge.md lines 100-105 -->

## Related Resources

- [Ably Spaces Component Locking documentation](https://ably.com/docs/spaces/locking)
- [Ably Spaces SDK documentation](https://ably.com/docs/products/spaces)
- [Ably Spaces product page](https://ably.com/spaces)

## Related Errors

• **[101000 - Lock Invalid Request](https://help.ably.io/error/101000)**  
  Invalid lock request parameters or configuration issues

• **[101001 - Lock Request Exists](https://help.ably.io/error/101001)**  
  Duplicate lock request already pending for the same component

• **[101002 - Lock Invalidated](https://help.ably.io/error/101002)**  
  Lock was invalidated by another request with higher priority

• **[101004 - Lock Pending](https://help.ably.io/error/101004)**  
  Lock request is still being processed and waiting for resolution

## Need Further Help?

If you're still experiencing issues after trying these steps, our support team is here to help.

**Contact Ably Support**: https://ably.com/support

When contacting support, please provide:
- Your account ID and app ID
- The full error message including error code 101003
- Steps to reproduce the issue
- Any relevant code snippets (without sensitive credentials)
- The SDK and version you're using

Our team will help you resolve this issue as quickly as possible.

<!-- =============================================== -->
<!-- INTERNAL DOCUMENTATION (NOT RENDERED) -->
<!-- =============================================== -->

<!-- SOURCES USED (ALWAYS use GitHub URLs with current SHA, never local paths):
- Analysis File: https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/101003-analysis.md
- Knowledge File: https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/101003-knowledge.md
- Editorial Notes: https://github.com/ably/ably-os/blob/5f4ba43/src/prompts/errors/editorial-notes.md - No specific error-specific notes for 101003
- Existing Documentation: https://github.com/ably/docs/blob/main/src/pages/docs/platform/errors/codes/101003-lock-is-locked.mdx - Enhanced based on existing doc
- Repository Overviews: Not used for this error (Spaces-specific)
-->

<!-- URL Validation Completed: 2025-08-24T21-13-57-640Z -->
<!-- External URLs verified: 4 | Corrected: 0 | Exempted internal: 6 -->

<!-- CONTENT DECISIONS:
- FAQ Content Preserved: FAQ advice from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/101003-knowledge.md lines 15-17 about consulting documentation
- Content Excluded: Code example from knowledge file lines 107-119 excluded as it was pseudo-code and not verified against current SDK documentation
- Content Enhanced: Added more detailed explanation of priority resolution system based on analysis file, added link to Spaces product page, added 101004 to related errors section
- Recommendations Source: 
  - Resolution steps based on knowledge file lines 56-81 and analysis file lines 77-81
  - Prevention guidance from knowledge file lines 100-105
  - Priority system explanation from analysis file lines 49-51
- Code Examples Rationale: No code examples included as the pseudo-code in knowledge file was not verifiable against current SDK documentation. Linking to official Spaces documentation instead.
-->

<!-- ATTRIBUTION BY SECTION:
- Common Causes: 
  - Cause 1: Based on analysis findings in https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/101003-analysis.md lines 41-46
  - Cause 2: From knowledge file at https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/101003-knowledge.md lines 93-95
  - Cause 3: From analysis file at https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/101003-analysis.md lines 49-51
- Resolution Steps: 
  - Step 1: FAQ advice from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/101003-knowledge.md lines 98-99 - preserved due to customer experience
  - Step 2: Analysis finding from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/101003-analysis.md lines 78-79
  - Step 3: Analysis finding from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/101003-analysis.md lines 79-80
  - Step 4: Knowledge file guidance from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/101003-knowledge.md lines 101-105
- Prevention: Based on https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/101003-knowledge.md lines 100-105
- Automatic Handling: Analysis finding from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/101003-analysis.md lines 68-70
-->

<!-- IMPROVEMENT INSTRUCTIONS:
To improve this error code documentation:
1. First approach: Update editorial-notes.md in ably-os repository with specific guidance for error 101003
2. Regenerate: Run `./bin/ably-os errors document-error-codes 101003 --force`
3. For broader improvements: Review and update ably-os prompt templates
4. Context: See https://github.com/ably/ably-os/blob/5f4ba43/docs/ERROR_COMMANDS_GUIDE.md
5. Source repository: https://github.com/ably/ably-os
-->