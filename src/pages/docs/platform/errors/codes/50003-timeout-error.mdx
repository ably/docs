<!-- Generated by: ably-os errors document-error-codes -->
<!-- Repository: https://github.com/ably/ably-os -->
<!-- Command: ./bin/ably-os errors document-error-codes 50003 -->
<!-- Generated: 2025-08-25T12-12-38-783Z -->
<!-- Sources: 
     - Analysis: https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/50003-analysis.md
     - Knowledge: https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/50003-knowledge.md
     - Editorial notes: https://github.com/ably/ably-os/blob/5f4ba43/src/prompts/errors/editorial-notes.md
-->
<!-- Key Approach: Enhanced documentation with comprehensive timeout scenarios, critical SDK behavior differences, and real-world incident patterns from support history -->
<!-- Citations: Complete source attribution with line numbers available at bottom of document -->

# Error 50003: Timeout error

## What Happened

An operation timed out before completing, typically due to network issues, temporary service unavailability, or operations exceeding configured time limits.

## Quick Reference

| Error Code | HTTP Status | Category | Retryable |
|------------|-------------|----------|-----------|
| 50003 | 500/503/504/408 | Server Error (Timeout) | Yes - temporary timeout condition |

## Quick Fix

- **REST SDK users**: No action needed - automatic retry is handled
- **Realtime SDK users**: Implement application-level retry logic (SDK does NOT auto-retry by design)
- Check [Ably status page](https://status.ably.com) if timeouts persist beyond 2 minutes
- Consider increasing timeout values in SDK configuration for high-latency networks

## Error Messages

You may see one of these messages:
- "Message send timeout expired" - Message not acknowledged within 30 seconds
- "Timeout for trying fallback hosts retries. Total elapsed time exceeded the [timeout]ms limit"
- "timed out before attaching channel" - Channel attach operation timeout
- "timed out before detaching channel" - Channel detach operation timeout
- "Ping request cancelled due to request timeout" - Keep-alive ping timeout
- "Timeout waiting for ping response" - No ping response received
- "Connection cancelled due to request timeout" - Connection establishment timeout
- "Ping failed as connection has changed state to {state}" - Connection state changed during ping
- "cURL error: [specific error message]" - Network-level timeout (PHP SDK)
- "network timeout" - Generic network operation timeout
- "write: connection timed out" - Connection write operation timeout
- "network is unreachable" - Network connectivity issue

The `{state}` shows the current connection state, and `[timeout]` shows the configured timeout duration in milliseconds.

## Common Causes

1. **Network connectivity issues** (40% of cases)
   <!-- Source: Analysis from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/50003-knowledge.md lines 54-58 -->
   - High network latency exceeding timeout thresholds
   - Packet loss causing retransmission delays
   - Intermittent connectivity or network flapping
   - Network unreachability or routing issues
   - Firewall or proxy interference with WebSocket connections

2. **Message acknowledgment timeout** (30% of cases)
   <!-- Source: Analysis from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/50003-analysis.md lines 21-27 and knowledge lines 99-102 -->
   - Messages not acknowledged by server within 30 seconds
   - RPC communication failures between Ably services
   - Server processing delays during high load
   - Presence ENTER messages failing to receive ACK

3. **Channel operation timeout** (15% of cases)
   <!-- Source: Analysis from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/50003-analysis.md lines 110-120 and knowledge lines 77-80 -->
   - Channel attach taking longer than `realtimeRequestTimeout`
   - Channel detach not completing within timeout period
   - State transition delays in channel lifecycle
   - Channel release failures (as seen with PSIServices incident)

4. **Configuration issues** (10% of cases)
   <!-- Source: Knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/50003-knowledge.md lines 64-66 -->
   - Timeout values set too low for network conditions
   - Insufficient `realtimeRequestTimeout` setting (default 10 seconds)
   - Low `httpMaxRetryDuration` for fallback host attempts
   - Misconfigured load balancers or proxies

5. **Temporary service issues** (5% of cases)
   <!-- Source: Knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/50003-knowledge.md lines 59-62 -->
   - Service temporarily unavailable (HTTP 503)
   - High server load during peak periods
   - Infrastructure problems or regional issues
   - Database connection timeouts (Cassandra)

## Resolution Steps

1. **Understand critical SDK behavior difference**
   <!-- Source: Critical finding from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/50003-knowledge.md lines 106-110 -->
   - **REST SDK**: Automatically retries with exponential backoff - no action needed
   - **Realtime SDK**: Does NOT auto-retry (by design to prevent duplicate messages)
   - This is a fundamental architectural decision - not a bug

2. **For Realtime SDK users - implement retry logic**
   ```javascript
   // Handle timeout errors with application-level retry
   let retryCount = 0;
   const maxRetries = 3;
   
   async function publishWithRetry(channel, name, data) {
     try {
       await channel.publish(name, data);
     } catch (err) {
       if (err.code === 50003 && retryCount < maxRetries) {
         retryCount++;
         const delay = Math.min(1000 * Math.pow(2, retryCount), 10000);
         await new Promise(resolve => setTimeout(resolve, delay));
         return publishWithRetry(channel, name, data);
       }
       throw err;
     }
   }
   ```
   <!-- Code source: Essential pattern based on SDK behavior documented in https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/50003-knowledge.md lines 106-110 -->

3. **Increase timeout configuration for your network conditions**
   ```javascript
   const ably = new Ably.Realtime({
     key: 'your-api-key',
     realtimeRequestTimeout: 45000,  // Increase from default 10s to 45s
     httpMaxRetryDuration: 30000,    // Increase HTTP retry duration
     disconnectedRetryTimeout: 15000 // Adjust disconnected retry timeout
   });
   ```
   <!-- Code source: Configuration options from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/50003-analysis.md lines 137-139 -->

4. **Monitor for patterns to identify root cause**
   - Check if timeouts occur at specific times (load patterns)
   - Identify if specific operations consistently timeout
   - Review network path between client and Ably
   - Look for correlation with other error codes (40000, 50000)
   - Check if issue is regional or global

5. **For persistent issues (>2 minutes)**
   - Check https://status.ably.com for service status
   - Review recent infrastructure or code changes
   - Consider regional connectivity issues
   - Note request IDs from error messages for support

6. **For load testing scenarios**
   <!-- Source: Based on incidents from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/50003-knowledge.md lines 88-97 -->
   - Increase timeout limits significantly for load tests
   - Consider using REST SDK for high-volume publishing
   - Implement batching to reduce individual requests
   - Monitor RPC communication metrics if available

## Automatic Handling

<!-- Source: SDK behavior from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/50003-knowledge.md lines 106-110 and analysis patterns -->
- **REST SDK**: Automatically retries with exponential backoff up to `httpMaxRetryDuration`
- **Realtime SDK**: Does NOT automatically retry publish operations (prevents duplicates)
- **Connection recovery**: SDK attempts automatic reconnection for connection timeouts
- **Fallback hosts**: Automatically tried when primary host times out (ably-js and other SDKs)
- **Channel state**: Transitions to SUSPENDED after persistent timeouts

## Prevention

- Set appropriate timeout values based on your network conditions and use case
- Monitor timeout patterns to identify infrastructure issues early
- Use REST SDK for critical message publishing that requires automatic retry
- Implement robust application-level retry logic when using Realtime SDK
- Consider network optimization and regional deployment strategies
- For load testing, pre-configure higher timeout values
- Implement circuit breakers for persistent timeout scenarios

## Performance Impact

This error indicates temporary delays but doesn't immediately affect:
- Other channel operations on different channels
- Existing subscriptions (unless connection timeout)
- Messages already queued for delivery
- Other connections or sessions

Connection timeouts may cause:
- Brief message delivery delays during reconnection
- Presence member list updates
- Need to re-establish subscriptions if connection enters failed state
- Potential message loss if not using persistent history

## Related Errors

• **[80014 - Connection Timeout](https://help.ably.io/error/80014)**  
  Connection-specific timeout during establishment or keep-alive operations

• **[80000 - Connection Failed](https://help.ably.io/error/80000)**  
  May follow persistent 50003 timeouts when connection cannot be recovered

• **[50000 - Internal Server Error](https://help.ably.io/error/50000)**  
  General server error that may accompany timeout issues during incidents

• **[40000 - Bad Request](https://help.ably.io/error/40000)**  
  Often seen alongside 50003 during network issues (as per 17Live incident)

## Related Resources

- [Connection state management](https://ably.com/docs/connect)
- [Connection recovery and continuity](https://ably.com/docs/connect)
- [Client options and timeout configuration](https://ably.com/docs/api/realtime-sdk)
- [REST vs Realtime SDK comparison](https://ably.com/docs/sdks)
- [Ably status page](https://status.ably.com)

## Need Further Help?

If you're still experiencing issues after trying these steps, our support team is here to help.

**Contact Ably Support**: https://ably.com/support

When contacting support, please provide:
- Your account ID and app ID
- The full error message including error code 50003
- Steps to reproduce the issue
- Any relevant code snippets (without sensitive credentials)
- The SDK and version you're using
- Request IDs from error messages if available
- Whether you're using REST or Realtime SDK

Our team will help you resolve this issue as quickly as possible.

<!-- =============================================== -->
<!-- INTERNAL DOCUMENTATION (NOT RENDERED) -->
<!-- =============================================== -->

<!-- SOURCES USED:
- Analysis File: https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/50003-analysis.md
- Knowledge File: https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/50003-knowledge.md
- Editorial Notes: https://github.com/ably/ably-os/blob/5f4ba43/src/prompts/errors/editorial-notes.md (lines 92-93 for 50003 timeout guidance)
- Existing Documentation: https://github.com/ably/docs/blob/main/src/pages/docs/platform/errors/codes/50003-timeout-error.mdx (enhanced and expanded)
-->

<!-- CONTENT DECISIONS:
- FAQ Content Preserved: No legacy FAQ content found for 50003 in knowledge files
- Content Excluded: Detailed RPC communication internals (too implementation-specific)
- Recommendations Source: 
  - Critical SDK retry behavior from knowledge file lines 106-110
  - Timeout configuration from analysis file lines 137-139
  - Resolution patterns from knowledge file lines 125-141
  - Real incident patterns from knowledge file lines 74-102
- Code Examples Rationale: 
  - Retry logic example essential due to critical Realtime SDK behavior (knowledge lines 106-110)
  - Configuration example based on actual SDK options (analysis lines 137-139)
  - Both examples directly address the most common resolution needs
-->

<!-- ATTRIBUTION BY SECTION:
- Common Causes: 
  - Cause 1: Network issues from knowledge file lines 54-58, enhanced with incident data
  - Cause 2: Message timeout from analysis file lines 21-27 and knowledge lines 99-102
  - Cause 3: Channel operations from analysis file lines 110-120 and PSIServices incident (knowledge lines 77-80)
  - Cause 4: Configuration from knowledge file lines 64-66
  - Cause 5: Service issues from knowledge file lines 59-62
- Resolution Steps: 
  - Step 1: Critical SDK difference from knowledge file lines 106-110
  - Step 2: Retry logic necessity from knowledge file lines 106-110 with practical implementation
  - Step 3: Configuration options from analysis file lines 137-139
  - Step 4: Monitoring guidance based on 17Live incident patterns (knowledge lines 82-86)
  - Step 5: Status page reference and support guidance
  - Step 6: Load testing guidance from knowledge file lines 88-97
- Prevention: Based on resolution patterns from knowledge file lines 125-141 and incident history
- Automatic Handling: SDK behaviors from knowledge file lines 106-110 and analysis file patterns
- Performance Impact: Derived from timeout behavior patterns and incident impacts
-->

<!-- URL Validation Completed: 2025-08-25T12-12-38-783Z -->
<!-- External URLs verified: 5 | Corrected: 0 | Exempted internal: 5 -->
<!-- Status page and support URLs confirmed operational -->
<!-- Documentation URLs use standard Ably docs structure -->

<!-- DOCUMENTATION SHORTCOMINGS:
⚠️ Areas where Ably documentation could be improved:
- Missing: Clear documentation on why Realtime SDK doesn't retry 50003 errors
- Impact: Users assume all SDKs retry timeouts, leading to confusion
- Recommendation: Add prominent note in SDK comparison docs about retry behavior differences
- Severity: Medium - causes customer confusion as seen in support incidents
-->

<!-- IMPROVEMENT INSTRUCTIONS:
To improve this error code documentation:
1. First approach: Update editorial-notes.md in ably-os repository with specific guidance for error 50003
2. Regenerate: Run `./bin/ably-os errors document-error-codes 50003 --force`
3. For broader improvements: Review and update ably-os prompt templates
4. Context: See https://github.com/ably/ably-os/blob/5f4ba43/docs/ERROR_COMMANDS_GUIDE.md
5. Source repository: https://github.com/ably/ably-os
-->