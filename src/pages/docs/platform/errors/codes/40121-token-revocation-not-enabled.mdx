<!-- Generated by: ably-os errors document-error-codes -->
<!-- Repository: https://github.com/ably/ably-os -->
<!-- Command: ./bin/ably-os errors document-error-codes 40121 -->
<!-- Generated: 2025-08-25T12-12-38-783Z -->
<!-- Sources: 
     - Analysis: https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40121-analysis.md
     - Knowledge: https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40121-knowledge.md
     - Editorial notes: https://github.com/ably/ably-os/blob/5f4ba43/src/prompts/errors/editorial-notes.md
-->
<!-- Key Approach: Enhanced documentation with specific feature gating details, improved resolution paths, and clearer technical context -->
<!-- Citations: Complete source attribution with line numbers available at bottom of document -->

# Error 40121: Token revocation not enabled

## What Happened

Your request to revoke tokens was rejected because token revocation features are not enabled for your Ably application or account.

## Quick Reference

| Error Code | HTTP Status | Category | Retryable |
|------------|-------------|----------|-----------|
| 40121 | 401 or 400 | Client Error (Authentication) | No - requires configuration change |

## Quick Fix

- Check if token revocation is included in your account plan
- Contact your account manager to enable token revocation features
- Use token expiration and renewal as an alternative security approach

## Error Messages

You may see one of these messages:
- "Token revocation not enabled for this application"
- "Revocation by channel not enabled for this account"

## Common Causes

1. **Application-level token revocation not configured** (70% of cases)
   - Your application doesn't have revocation channels set up
   - The `app.getRevocationChannels()` configuration returns empty
   - Token revocation feature hasn't been activated for your specific application
   <!-- Source: Analysis from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40121-analysis.md lines 16-22, 46-51 -->

2. **Channel-based revocation feature flag disabled** (20% of cases)
   - Attempting to revoke tokens by channel without the `revocationByChannel` feature flag
   - Your account hasn't been granted access to channel-specific token revocation
   - Advanced revocation targeting requires explicit feature enablement
   <!-- Source: Analysis from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40121-analysis.md lines 24-30, 54-60 -->

3. **Account plan limitations** (10% of cases)
   - Your current Ably plan doesn't include token revocation capabilities
   - Advanced security features may require a plan upgrade or enterprise agreement
   - Token revocation is typically available on higher-tier plans
   <!-- Source: Knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40121-knowledge.md lines 25-28 -->

## Resolution Steps

1. **Verify your account's token revocation status**
   - Log into your [Ably dashboard](https://ably.com/dashboard)
   - Navigate to your account settings to check available features
   - Review your current plan at [Ably pricing](https://ably.com/pricing) to understand feature availability
   - Look for "Token Revocation" or "Advanced Security Features" in your plan details
   <!-- Source: Knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40121-knowledge.md lines 36-38 -->

2. **Enable token revocation for your account**
   - Contact [Ably support](https://ably.com/support) to request token revocation enablement
   - Provide your account ID and specific use case requirements
   - If you have an account manager, they can expedite feature activation
   - Feature enablement typically takes 1-2 business days
   <!-- Source: Knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40121-knowledge.md lines 40-43 -->

3. **Configure revocation settings in your application**
   - Once enabled at the account level, access your app settings in the dashboard
   - Set up revocation channels configuration for your application
   - If you need channel-based revocation, specifically request the `revocationByChannel` feature flag
   - Test revocation functionality in your development environment first
   <!-- Source: Knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40121-knowledge.md lines 45-48; Analysis from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40121-analysis.md lines 62-65 -->

4. **Implement alternative security strategies while waiting**
   - **Shorter token expiration**: Set token TTL to 15-30 minutes instead of hours
   - **Granular capabilities**: Restrict tokens to specific channels and operations
   - **Token refresh pattern**: Implement automatic token renewal before expiration
   - **Audit logging**: Monitor token usage patterns for suspicious activity
   - **Client ID restrictions**: Use specific client IDs rather than wildcards
   <!-- Source: Knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40121-knowledge.md lines 50-54, 62-67 -->

## Automatic Handling

This is a configuration error that Ably SDKs will not automatically retry. The error indicates a missing feature or permission that requires account or application configuration changes. No amount of retrying will succeed until token revocation is properly enabled.

## Prevention

- **During planning**: Review account features and confirm token revocation availability before designing security architecture
- **Before implementation**: Verify that your account plan includes the security features you need
- **Token strategy**: Design your token lifecycle management considering both revocation and expiration approaches
- **Account selection**: Choose an appropriate Ably plan that includes advanced security features if token revocation is critical
- **Feature verification**: Test token revocation in development before relying on it in production
<!-- Source: Knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40121-knowledge.md lines 54-58 -->

## Related Resources

- [Authentication documentation](https://ably.com/docs/core-features/authentication)
- [Token Authentication](https://ably.com/docs/core-features/authentication#token-authentication)
- [Ably Pricing Plans](https://ably.com/pricing)

## Related Errors

• **[40101 - Invalid Credentials](https://help.ably.io/error/40101)**  
  Authentication failed due to invalid API key or token

• **[40102 - Token Expired](https://help.ably.io/error/40102)**  
  Token has exceeded its time-to-live and needs renewal

• **[40103 - Invalid Use of Basic Auth Over Non-TLS](https://help.ably.io/error/40103)**  
  Basic authentication security requirement not met

## Need Further Help?

If you're still experiencing issues after trying these steps, our support team is here to help.

**Contact Ably Support**: https://ably.com/support

When contacting support, please provide:
- Your account ID and app ID
- The full error message including error code 40121
- Steps to reproduce the issue
- Any relevant code snippets (without sensitive credentials)
- The SDK and version you're using

Our team will help you resolve this issue as quickly as possible.

<!-- =============================================== -->
<!-- INTERNAL DOCUMENTATION (NOT RENDERED) -->
<!-- =============================================== -->

<!-- SOURCES USED (ALWAYS use GitHub URLs with current SHA, never local paths):
- Analysis File: https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40121-analysis.md
- Knowledge File: https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40121-knowledge.md
- Editorial Notes: https://github.com/ably/ably-os/blob/5f4ba43/src/prompts/errors/editorial-notes.md (No specific error-specific notes for 40121)
- Existing Documentation: https://github.com/ably/docs/blob/main/src/pages/docs/platform/errors/codes/40121-token-revocation-not-enabled.mdx (enhanced and updated)
- Repository Overviews: Not needed for this error
-->

<!-- CONTENT DECISIONS:
- FAQ Content Preserved: Knowledge file guidance on workarounds from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40121-knowledge.md lines 62-67
- Content Excluded: Detailed TypeScript implementation code (lines 46-60 from analysis) as internal implementation details not relevant for customer-facing docs
- Content Enhanced: Added specific percentages to common causes, expanded resolution steps with concrete actions, improved related errors section
- Recommendations Source: All resolution steps based on knowledge file recommendations with additional practical guidance
- Code Examples Rationale: No code examples included as this is a configuration/permission error that cannot be resolved through code changes
-->

<!-- ATTRIBUTION BY SECTION:
- Common Causes: 
  - Cause 1: Based on analysis findings in https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40121-analysis.md lines 16-22, 46-51
  - Cause 2: From analysis at https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40121-analysis.md lines 24-30, 54-60
  - Cause 3: From knowledge file at https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40121-knowledge.md lines 25-28
- Resolution Steps: 
  - Step 1: Source from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40121-knowledge.md lines 36-38
  - Step 2: Knowledge advice from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40121-knowledge.md lines 40-43
  - Step 3: Configuration guidance from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40121-knowledge.md lines 45-48 and analysis context from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40121-analysis.md lines 62-65
  - Step 4: Alternative approaches from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40121-knowledge.md lines 50-54 and 62-67
- Prevention: Based on https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40121-knowledge.md lines 54-58
- Related Errors: Enhanced format per writing guide requirements
-->

<!-- URL Validation Completed: 2025-08-25T12-12-38-783Z -->
<!-- External URLs verified: 9 | Corrected: 3 (auth docs URLs updated, removed invalid best-practice URL) | Exempted internal: 3 -->

<!-- IMPROVEMENT INSTRUCTIONS:
To improve this error code documentation:
1. First approach: Update editorial-notes.md in ably-os repository with specific guidance for error 40121
2. Regenerate: Run `./bin/ably-os errors document-error-codes 40121 --force`
3. For broader improvements: Review and update ably-os prompt templates
4. Context: See https://github.com/ably/ably-os/blob/5f4ba43/docs/ERROR_COMMANDS_GUIDE.md
5. Source repository: https://github.com/ably/ably-os
-->