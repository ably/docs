---
title: "AMQP backpressure error"
meta_description: "Error 70006 occurs when the AMQP broker cannot accept new messages due to backpressure conditions"
meta_keywords: "AMQP, backpressure, queue integration, error 70006, message broker, RabbitMQ"
---

{/* Generated by: ably-os errors document-error-codes */}
{/* Repository: https://github.com/ably/ably-os */}
{/* Command: ./bin/ably-os errors document-error-codes 70006 */}
{/* Generated: 2025-11-07T08-36-41-586Z */}
{/* Sources:
     - Analysis: https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/70006-analysis.md
     - Knowledge: https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/70006-knowledge.md
     - Editorial notes: https://github.com/ably/ably-os/blob/b819713/src/prompts/errors/editorial-notes.md
*/}
{/* Key Approach: Document AMQP backpressure error focusing on broker capacity issues and immediate actions */}
{/* Citations: Complete source attribution with line numbers available at bottom of document */}

This error occurs when Ably cannot deliver messages to your AMQP queue integration because the destination message broker is experiencing backpressure conditions.

| Error code | HTTP status code | Category | Retryable |
| ---------- | ----------- | -------- | --------- |
| 70006 | 400, 500 | AMQP/Queue Integration | Yes |

## Error messages

| Message | Context |
| ------- | ------- |
| `AMQP channel buffer highwatermark exceeded` | Broker rejecting messages due to capacity limits |
| `Timeout sending message to queue. ampq connection is backpressured` | Request timeout while broker is overloaded |

## Impact

This error affects message delivery to your external AMQP broker:
- Messages cannot be forwarded to your queue integration temporarily
- Your AMQP broker is at capacity and cannot accept new messages
- Messages will be retried automatically based on your integration configuration

The Ably platform will retry delivery according to your queue integration settings. However, continued backpressure may result in message loss if retry limits are exceeded.

## Troubleshooting

### Broker resource constraints
{/* Source: Knowledge from https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/70006-knowledge.md lines 11-17 */}

This occurs when:
- Your AMQP broker (RabbitMQ, Amazon MQ, etc.) is receiving more messages than it can process
- Broker resources (CPU, memory, disk) are exhausted
- Connection limits or channel limits have been reached

To resolve this:
1. **Check broker metrics immediately**:
   - Monitor CPU and memory usage on all broker nodes
   - Review connection count against configured limits
   - Check disk space availability

2. **Scale broker resources**:
   - Add CPU or memory to existing nodes
   - Add additional nodes to your cluster
   - Increase connection or channel limits

3. **Review broker logs** for specific resource warnings or errors

{/* Source: Knowledge from https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/70006-knowledge.md lines 69-78 */}

### Queue backlog accumulation

This occurs when:
- Target queues have accumulated too many unprocessed messages
- Message consumers are not keeping up with production rate
- Queue memory or message count limits are reached

To resolve this:
1. **Monitor queue depth** across all queues in your broker
2. **Scale consumer capacity** by adding more consumer instances
3. **Process or purge** backed-up queues if appropriate for your use case
4. **Implement message TTL** to prevent indefinite queue buildup

### Configuration-based rejection
{/* Source: Analysis from https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/70006-analysis.md lines 63-65 */}

This occurs when:
- Your Ably integration is configured with `rejectOnBackpressured` enabled
- The system is set to fail-fast rather than queue during backpressure

To resolve this:
- Review your integration configuration settings
- Consider whether fail-fast or queuing behavior is appropriate for your use case
- Contact Ably support if you need to adjust this configuration

## Prevention

{/* Source: Knowledge from https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/70006-knowledge.md lines 49-68 */}

To prevent this error:

1. **Capacity planning**:
   - Scale broker resources based on expected message volume
   - Implement horizontal scaling for AMQP clusters
   - Set alerts at 80% resource utilization

2. **Queue management**:
   - Configure appropriate queue length limits
   - Implement dead letter queues for overflow
   - Monitor consumer lag metrics continuously

3. **Load testing**:
   - Regularly test your AMQP infrastructure under peak load
   - Validate that your broker can handle expected message rates
   - Test failover scenarios for clustered setups

## Related errors

The following errors are related to error code 70006:

| Error code | Description |
| ---------- | ----------- |
| [70005](/docs/platform/errors/codes/70005) | General timeout sending message to queue without backpressure conditions |

## Need further help?

Contact [Ably support](https://ably.com/support) if you're still experiencing issues after trying the steps listed above.

You'll need to provide:

- Your account ID and app ID.
- The full error message including the error code.
- Steps to reproduce the issue.
- Any relevant code snippets (without any sensitive credentials).
- The SDK and version you're using.

### Resources

- [Ably queue integrations documentation](https://ably.com/docs/platform/integrations/queues)
- [AMQP integration setup guide](https://ably.com/docs/platform/integrations/streaming/amqp)
- [Queue integration troubleshooting](https://support.ably.com/support/solutions/articles/3000068311-common-errors-when-setting-up-queues)

{/* =============================================== */}
{/* INTERNAL DOCUMENTATION (NOT RENDERED) */}
{/* =============================================== */}

{/* SOURCES USED (ALWAYS use GitHub URLs with current SHA, never local paths):
- Analysis File: https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/70006-analysis.md
- Knowledge File: https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/70006-knowledge.md
- Editorial Notes: https://github.com/ably/ably-os/blob/b819713/src/prompts/errors/editorial-notes.md (no specific error-specific notes for 70006)
- Existing Documentation: None found
- Repository Overviews: Not needed for this error as it's server-side only
*/}

{/* CONTENT DECISIONS:
- FAQ Content Preserved: Knowledge base troubleshooting steps from https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/70006-knowledge.md lines 25-78
- Content Excluded: Detailed technical implementation from analysis file as it's internal server code
- Recommendations Source: All resolution steps based on knowledge file practical guidance
- Code Examples Rationale: No code examples included as this is a server-side integration error not resolved through SDK code
*/}

{/* ATTRIBUTION BY SECTION:
- Error messages:
  - Message 1: Based on analysis file https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/70006-analysis.md line 17
  - Message 2: Based on analysis file https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/70006-analysis.md line 39 (includes typo as found in source)
- Troubleshooting:
  - Broker constraints: From knowledge file https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/70006-knowledge.md lines 11-17, 25-45
  - Queue backlog: From knowledge file https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/70006-knowledge.md lines 69-78
  - Configuration rejection: From analysis file https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/70006-analysis.md lines 63-65, 108-111
- Prevention: Based on knowledge file https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/70006-knowledge.md lines 49-68
*/}

{/* URL Validation Completed: 2025-11-07T08-36-41-586Z */}
{/* External URLs verified: 3 | Corrected: 0 | Exempted internal: 5 */}

{/* IMPROVEMENT INSTRUCTIONS:
To improve this error code documentation:
1. First approach: Update editorial-notes.md in ably-os repository with specific guidance for error 70006
2. Regenerate: Run `./bin/ably-os errors document-error-codes 70006 --force`
3. For broader improvements: Review and update ably-os prompt templates
4. Context: See https://github.com/ably/ably-os/blob/b819713/docs/ERROR_COMMANDS_GUIDE.md
5. Source repository: https://github.com/ably/ably-os
*/}