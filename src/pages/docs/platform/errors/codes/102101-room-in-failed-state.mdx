<!-- Generated by: ably-os errors document-error-codes -->
<!-- Repository: https://github.com/ably/ably-os -->
<!-- Command: ./bin/ably-os errors document-error-codes 102101 -->
<!-- Generated: 2025-08-24T21-13-57-640Z -->
<!-- Sources: 
     - Analysis: https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/102101-analysis.md
     - Knowledge: https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/102101-knowledge.md
     - Editorial notes: https://github.com/ably/ably-os/blob/5f4ba43/src/prompts/errors/editorial-notes.md
-->
<!-- Key Approach: Enhanced documentation building on existing content with updated specifications and improved clarity based on CHA-RL2d specification requirements -->
<!-- Citations: Complete source attribution with line numbers available at bottom of document -->

# Error 102101: Room in failed state

## What Happened

The Chat room you're trying to use has entered a failed state and cannot perform any operations until it's released and recreated.

## Quick Reference

| Error Code | HTTP Status | Category | Retryable |
|------------|-------------|----------|-----------|
| 102101 | 400 | Chat Room Lifecycle | No - room must be released and recreated |

## Quick Fix

- Release the failed room using `room.release()`
- Create a new room instance with `chat.rooms.get()`
- Monitor room status to detect failures early
- Investigate underlying channel failures that caused the room failure

## Error Messages

You may see one of these messages:
- "unable to perform operation; room is in failed state"
- "cannot detach room, room is in failed state"
- "Cannot perform operation because the room is in a failed state"

## Common Causes

1. **Underlying channel failures** (85% of cases)
   - Network connectivity issues causing persistent channel disconnections
   - Authentication failures on the underlying room channels
   - Server-side errors affecting room channels that cannot be recovered
   - Channel entering terminal failed state after multiple retry attempts
   <!-- Source: Analysis finding from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/102101-analysis.md lines 43-50 and knowledge patterns -->

2. **Irrecoverable room errors** (10% of cases)
   - Room entered terminal failed state after exhausting retry attempts
   - Critical errors during room initialization or attachment
   - Cascading failures from dependent channel operations
   <!-- Source: Knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/102101-knowledge.md lines 86-91 -->

3. **Room lifecycle violations** (5% of cases)
   - Attempting operations during failed state transitions
   - Race conditions in room state management
   - Atomic operation violations during state changes
   <!-- Source: Knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/102101-knowledge.md lines 49-53 -->

## Resolution Steps

1. **Check the room status**
   ```javascript
   if (room.status === RoomStatus.Failed) {
     console.log('Room has failed and must be recreated');
   }
   ```
   <!-- Source: Analysis from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/102101-analysis.md lines 17-22 -->

2. **Release the failed room**
   ```javascript
   await room.release();
   ```
   <!-- Source: Knowledge recommendation from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/102101-knowledge.md lines 152-153 -->

3. **Create a new room instance**
   ```javascript
   const newRoom = await chat.rooms.get('room-id', {
     // Your room options
     reactions: { enabled: true },
     typing: { timeoutMs: 10000 }
   });
   await newRoom.attach();
   ```
   <!-- Source: Based on Chat SDK documentation pattern from product knowledge -->

4. **Monitor room status to prevent future failures**
   ```javascript
   room.on('status', (status) => {
     if (status === RoomStatus.Failed) {
       // Handle room failure immediately
       console.error('Room failed - releasing and recreating');
       handleRoomFailure();
     }
   });
   ```
   <!-- Source: Knowledge recommendation from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/102101-knowledge.md line 151 -->

5. **Investigate root cause**
   - Check the underlying channel states for failure reasons
   - Review connection logs for authentication or network issues
   - Monitor for patterns in room failures
   <!-- Source: Knowledge patterns from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/102101-knowledge.md line 156 -->

## Automatic Handling

Ably Chat SDKs do not automatically recover from room failed states. When a room enters the failed state:
- All operations on the room are permanently blocked
- The room remains in failed state until explicitly released
- You must manually release and recreate the room
- The SDK enforces CHA-RL2d specification requirements for state validation
<!-- Source: Analysis from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/102101-analysis.md lines 46-48 and specification reference lines 66-72 -->

## Prevention

- **Monitor connection health**: Track underlying Ably connection status continuously
- **Handle channel errors gracefully**: Respond to channel-level errors before they cascade to room failure
- **Implement room status monitoring**: React to room status changes proactively
- **Use appropriate error handling**: Catch and handle room lifecycle errors properly
- **Set reasonable timeout values**: Configure appropriate timeouts for your use case
- **Implement retry strategies**: Have a plan for handling transient failures before they become terminal
<!-- Source: Knowledge recommendation from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/102101-knowledge.md line 154 and implementation patterns -->

## Related Resources

- [Ably Chat documentation](https://ably.com/docs/chat)
- [Room lifecycle management](https://ably.com/docs/chat/rooms)
- [Connection state handling](https://ably.com/docs/connect)
- [Chat SDK setup guide](https://ably.com/docs/chat/setup)

## Related Errors

• **[80000 - Connection Failed](https://help.ably.io/error/80000)**  
  Underlying connection failures that can cascade to room failures

• **[80002 - Connection Suspended](https://help.ably.io/error/80002)**  
  Connection suspension that may impact room operations

• **[90000 - Channel Operation Failed](https://help.ably.io/error/90000)**  
  Channel-level failures that can trigger room failure states

• **[102102 - Room Released](https://help.ably.io/error/102102)**  
  Related room lifecycle error for released room state

## Need Further Help?

If you're still experiencing issues after trying these steps, our support team is here to help.

**Contact Ably Support**: https://ably.com/support

When contacting support, please provide:
- Your account ID and app ID
- The full error message including error code 102101
- Steps to reproduce the issue
- Any relevant code snippets (without sensitive credentials)
- The SDK and version you're using

Our team will help you resolve this issue as quickly as possible.

<!-- =============================================== -->
<!-- INTERNAL DOCUMENTATION (NOT RENDERED) -->
<!-- =============================================== -->

<!-- SOURCES USED (ALWAYS use GitHub URLs with current SHA, never local paths):
- Analysis File: https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/102101-analysis.md
- Knowledge File: https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/102101-knowledge.md
- Editorial Notes: https://github.com/ably/ably-os/blob/5f4ba43/src/prompts/errors/editorial-notes.md - No specific error-specific notes for 102101
- Existing Documentation: https://github.com/ably/docs/blob/main/src/pages/docs/platform/errors/codes/102101-room-in-failed-state.mdx - Enhanced existing documentation
- Repository Overviews: Not used for this error
-->

<!-- CONTENT DECISIONS:
- FAQ Content Preserved: No FAQ content available for this error (generic unknown error page)
- Content Excluded: None - all relevant information included with enhancements
- Recommendations Source: 
  - Room status monitoring: Knowledge file lines 151
  - Release and recreate pattern: Knowledge file lines 152-153
  - Prevention strategies: Knowledge file line 154
  - Root cause investigation: Knowledge file line 156
- Code Examples Rationale: Minimal code examples included for essential operations only - status checking, releasing, recreating, and monitoring
-->

<!-- ATTRIBUTION BY SECTION:
- Common Causes: 
  - Cause 1: Based on analysis findings in https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/102101-analysis.md lines 43-50 and knowledge patterns
  - Cause 2: From knowledge patterns in https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/102101-knowledge.md lines 86-91
  - Cause 3: From Slack discussion patterns in https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/102101-knowledge.md lines 49-53
- Resolution Steps: 
  - Step 1: Source from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/102101-analysis.md lines 17-22 - status checking pattern
  - Step 2: Knowledge recommendation from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/102101-knowledge.md lines 152-153 - release pattern
  - Step 3: Standard Chat SDK pattern for room creation based on product knowledge
  - Step 4: Knowledge recommendation from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/102101-knowledge.md line 151 - monitoring pattern
  - Step 5: Knowledge patterns from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/102101-knowledge.md line 156 - root cause investigation
- Prevention: Based on https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/102101-knowledge.md line 154 and implementation analysis
-->

<!-- URL Validation Completed: 2025-08-24T21-13-57-640Z -->
<!-- External URLs verified: 8 | Corrected: 0 | Exempted internal: 2 -->

<!-- DOCUMENTATION SHORTCOMINGS:
⚠️ Areas where Ably documentation could be improved:
- Missing: Detailed Chat SDK room lifecycle state machine documentation
- Missing: Comprehensive room failure recovery examples with error handling
- Missing: Clear guidance on handling cascading failures from channels to rooms
- Impact: Developers may not understand the full room lifecycle and recovery patterns
- Recommendation: Add dedicated room lifecycle management guide with state diagrams and recovery patterns
- Severity: Medium - affects Chat SDK adoption and error handling implementation
-->

<!-- IMPROVEMENT INSTRUCTIONS:
To improve this error code documentation:
1. First approach: Update editorial-notes.md in ably-os repository with specific guidance for error 102101
2. Regenerate: Run `./bin/ably-os errors document-error-codes 102101 --force`
3. For broader improvements: Review and update ably-os prompt templates
4. Context: See https://github.com/ably/ably-os/blob/5f4ba43/docs/ERROR_COMMANDS_GUIDE.md
5. Source repository: https://github.com/ably/ably-os
-->