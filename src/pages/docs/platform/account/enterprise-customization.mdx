---
title: Enterprise customization
meta_description: "How Enterprise customers can create a custom endpoint and benefit from Active Traffic Management and other advanced Ably features."
meta_keywords: "Ably, clusters, isolation, custom, CNAME, active traffic management"
redirect_from:
  - /docs/platform-customization
  - /docs/root/platform-customization
---

If you're an [Ably Enterprise](https://ably.com/pricing) customer, then you can optionally create a **custom endpoint** to tailor the Ably platform to your specific requirements. A custom endpoint enables you to benefit from the following:

| Feature | Description |
|---------|-------------|
| Active traffic management | Let Ably actively monitor not only the global cluster health but also your own domains and proactively take steps to isolate or move traffic to ensure business continuity |
| Dedicated, isolated clusters | Rely upon guaranteed capacity and isolation from noisy neighbors |
| Regional routing of traffic | Require that all traffic is routed and serviced within specific regions |
| Regional message storage | Require that all messages are stored within a specific region |

A custom endpoint provides you with an option to service Ably platform requests. These can be either subdomains of `ably.net`, or point at your own custom CNAME domain. If you choose the latter option, Ably can also customize our client library SDKs to use your chosen domain and make them available via our CDN as `cdn.ably.com/lib/yourcompany.min.js`.

If you are not currently an enterprise customer but are interested in finding out more, then please [get in touch](https://ably.com/contact).

If you're ready to enable a custom endpoint to take advantage of these features, then please [see our guide](#setting-up-a-custom-environment). Otherwise, read on to find out more.

## Active traffic management <a id="active-traffic-management"/>

Active traffic management (ATM) is a feature available exclusively to our Enterprise customers that enables the Ably engineering team to manage the endpoints that customers connect to.

This ensures that under adverse conditions, such as a denial of service attack or a major outage, Ably can proactively route Enterprise customer traffic to specific data centers or regions that are unaffected, or even to new temporary clusters. This enables customers to maintain service while the issue is investigated and resolved.

This service is ideal for customers who want reassurance that Ably actively monitors not only the global cluster health but also the endpoints used by that customer, and can act to isolate or move traffic, ensuring business continuity.

## Dedicated, isolated clusters <a id="dedicated-and-isolated-clusters"/>

As part of our Enterprise package offering, Ably are able to offer customers dedicated clusters that are either partially or completely isolated from our global cluster.  Customers who require isolation from our global cluster for security, governance or guaranteed capacity reasons are able to run the Ably platform on their own EC2 dedicated environments.

This involves the provision of dedicated realtime and routing servers, with shared database cluster and common services (such as stats, logging, registries, and configuration).

We provide you with a custom endpoint for your cluster, for example: `yourcompany.realtime.ably.net`.  Additionally, we can support CNAMEs using your own custom root domain.

Please note the following:

* Ably only supports Amazon EC2 environments (within Virtual Private Networks)
* Ably is responsible for pro-actively managing and updating dedicated clusters
* Dedicated clusters can run in one or more regions of your choice

If you would like to find out more about our dedicated cluster offering, please [get in touch](https://ably.com/contact).

## Regional routing and storage <a id="regional-routing-and-storage"/>

If you need your data to remain within either Europe or the US, we can customize your account so that all of your data (both stored data and transient realtime data transmission activity) is kept in servers within the EU or US.

Note that this does not prevent customers outside of your chosen region from connecting to Ably - it just means that, regardless of their location, they will connect to a datacenter in that region.

If you are interested in applying processing or storage constraints to regions other than Europe or the US, then please speak to your customer success manager.

To implement regional restrictions at the application level, you must specify the required endpoint after configuring your account for regional routing and storage. Specify the required region in your endpoint. Once configured by Ably, you specify this endpoint in the Ably client options ( Rest SDK and Realtime SDK) when you are initiating the connection, from both the publisher's and subscriber's side. Your endpoint would be similar to what's shown in the examples below:

* for `eu`, `example-eu` would have the url `example-eu.realtime.ably.net or `example-eu.rest.ably.net` and will be configured to keep the data within the EU.
* for `us`, `example-us` would have the url `example-us.realtime.ably.net` or `example-us.rest.ably.net` and will be configured to keep the data within the US.

<Aside data-type='note'>
This approach does not apply regional restrictions when you are using a persistent history feature. For implementing geolocation restrictions on history, you would need to set a placement constraint to ensure data stays in the EU or any designated region.
</Aside>

## Setting up a custom endpoint <a id="setting-up-a-custom-environment"/>

To use a custom endpoint, perform the following steps:

### Decide whether to use an Ably subdomain, or your own domain

Ably client libraries connect to the `main.realtime.ably.net` domain by default. This domain is used by both WebSocket and other realtime connections from the Ably client libraries, as well as all REST-based requests. It is optimized for all standard HTTP-based request types, including all [REST requests](/docs/api/rest-api), [authentication requests](/docs/auth), and Comet and JSONP fallback when WebSockets cannot be used.

When you request a custom endpoint, you have the following options:

### Option 1: The custom domain is an Ably subdomain <a id="option-1"/>

For [example](#modify), `example.realtime.ably.net`.

These use Ably's existing wildcard certificate, which supports `*.realtime.ably.net` and different fallbacks to the following range of subdomains `*.[a-e].fallback.ably-realtime.com`.

### Option 2: The custom domain belongs to the customer <a id="option-2"/>

For [example](#modify), `rest.ably.example.com` and `realtime.ably.example.com`.

Ably issue the certificate, based on you configuring a CNAME DNS record or adding another record on `*.ably.example.com` that authorizes issuing a certificate for that subdomain. That means that the setup only needs to be done once, and doesn't require any additional manual intervention each time the certificate needs renewal.

This approach is also much less risky than handing out the wildcard `*.example.com` certificate.

As an example, here is how this would work:

* `realtime.ably.example.com` is used for the primary endpoint
* `[a-e]-fallback.ably.example.com` is used for the fallback domains
* Ably issue a certificate for `ably.example.com` and `*.ably.example.com`, which is a CNAME DNS record set up by the customer for that subdomain.

<Aside data-type='note'>
By default, Ably serves fallback traffic under the `*.ably-realtime.com` domain which is managed separately to the main `*.ably.io` domain. This means even problems at the DNS or registrar level on the primary `ably.io` domain can be routed around using the fallback mechanism.
</Aside>

In addition, Ably handle all certificate renewals, rolling out to our global endpoints, load balancers, and so on, without ever having to coordinate with you manually to get new certificates issued. This makes life easier for both you and Ably.

When using your own custom domain, Ably provide these DNS records for you to CNAME to. Although it is recommended that you implement a similar architecture by using CNAMEs under two different domains (for example, `ably.example.com` for your primary traffic and `ably.fallback-example.com` for your fallback traffic, with the latter hosted with a different registrar and using different name servers to the first), this is not mandatory. Therefore, the decision as to whether you need that extra level of redundancy within your own DNS system is yours.

### Request a custom endpoint

To enable a custom endpoint for your enterprise, speak to your customer success manager. They will create the custom endpoint for you and provide you with a `ClientOptions` object, containing the following options for the `endpoint` property:

* a routing policy:
  * `endpoint=main` routes to `main.realtime.ably.net`
  * `endpoint=example-eu` routes to `example-eu.realtime.ably.net`

### Test the custom endpoint

Test your custom endpoint by visiting it. The URL for your endpoint will depend on whether you have opted to use an Ably subdomain or a custom CNAME domain.

For example, if you have elected to use an Ably subdomain, you should test your endpoint by replacing `[ENDPOINT]` with the value of the `endpoint` property in the `ClientOptions` object:

* **Primary domain**: `https://[ENDPOINT].realtime.ably.net/time`, for example: `https://endpoint-example.realtime.ably.net/time`.

* **Fallback domains**: `https://[ENDPOINT].[a-e].fallback.ably-realtime.com/time`, for example: `https://endpoint-example.a.fallback.ably-realtime.com/time`.

Repeat this step for all fallback hosts in the `fallbackHosts` array, if provided.

### Modify your code to use your custom endpoint <a id="modify"/>

Now that you have tested your custom endpoints, you must modify your code to instantiate the Ably client with the provided `ClientOptions`.

The following example demonstrates how to set up the Ably Realtime client using an [Ably subdomain:](#option-1)

<Code>
```javascript
const ably = new Ably.Realtime({
  authUrl: '/auth', // Your authentication URL
  endpoint: 'example-eu', // Replace with your custom endpoint name
});
```
</Code>

The following example demonstrates how to set up the Ably Realtime client using [your own subdomain:](#option-2)

<Code>
```javascript
const ably = new Ably.Realtime({
  authUrl: '/auth', // Your authentication URL
  endpoint: 'realtime.example.com', // Your custom WebSocket endpoint
  fallbackHosts: [
    'a.fallback.ably.example.com',
    'b.fallback.ably.example.com'
  ]
});
```
</Code>

You should then test that all client SDKs can connect, publish, and receive messages (where applicable) before rolling out these changes to production code.

Where possible, you should also inspect your network traffic to verify that the client SDKs are calling the endpoints for your custom endpoint. Instead of connections to `realtime.ably.net` you should see connections to `[ENDPOINT].realtime.ably.net`, or your own custom CNAME domain.

### Roll out your changes

Once all your client library SDKs are using the new endpoint and traffic is arriving at the correct endpoints, the team at Ably will be able to actively reroute your traffic based on your endpoint settings.

If you have regional constraints on your account, then please contact your customer success manager who will ensure that the regional constraints are applied and tested too.

<Aside data-type='note'>
Services are assigned to a custom endpoint on a per-account basis. This means that all apps within an account **must be migrated at the same time**.
</Aside>
