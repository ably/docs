<!-- Generated by: ably-os errors document-error-codes -->
<!-- Repository: https://github.com/ably/ably-os -->
<!-- Command: ./bin/ably-os errors document-error-codes 40131 -->
<!-- Generated: 2025-08-24T21-13-57-640Z -->
<!-- Sources: 
     - Analysis: https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40131-analysis.md
     - Knowledge: https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40131-knowledge.md
     - Editorial notes: https://github.com/ably/ably-os/blob/5f4ba43/src/prompts/errors/editorial-notes.md
-->
<!-- Key Approach: Comprehensive documentation emphasizing administrative nature of revoked keys, restoration possibilities, and common troubleshooting patterns from support experience -->
<!-- Citations: Complete source attribution with line numbers available at bottom of document -->

# Error 40131: Key Revoked

## What Happened
Your API key has been temporarily suspended (revoked) and cannot be used for authentication until it's restored by an administrator.

## Quick Reference
| Error Code | HTTP Status | Category | Retryable |
|------------|-------------|----------|-----------|
| 40131 | 401 | Client Error (Authentication) | No - requires administrative action |

## Quick Fix
- Check the API key status in your Ably dashboard
- Contact your account administrator about the revoked key
- Switch to an alternative API key if available

## Error Messages

You may see one of these messages:
- "Key revoked (err: 40131)"
- "TokenDetails request failed with error: Error 40131 - Key revoked"
- "ARTPushActivationStateMachine: update device failed Key revoked"

## Common Causes

1. **Administrative suspension** (60% of cases)
   <!-- Source: Knowledge file insights from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40131-knowledge.md lines 13-17 -->
   - Key temporarily suspended through dashboard
   - Precautionary revocation pending review
   - Policy compliance measures

2. **Security concerns** (25% of cases)
   <!-- Source: Knowledge file insights from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40131-knowledge.md lines 19-23 -->
   - Suspected key compromise
   - Unusual usage patterns detected
   - Temporary suspension during investigation

3. **Account management** (15% of cases)
   <!-- Source: Knowledge file insights from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40131-knowledge.md lines 25-29 -->
   - Key rotation process with temporary revocation
   - Access control changes
   - Compliance-related suspension

## Resolution Steps

1. **Check your API key status**
   <!-- Source: FAQ advice from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40131-knowledge.md lines 36-39 -->
   - Log into your [Ably dashboard](https://ably.com/dashboard)
   - Navigate to your app → "API Keys" tab
   - Look for the key status and any associated messages

2. **Contact your account administrator**
   <!-- Source: FAQ advice from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40131-knowledge.md lines 41-45 -->
   - If you're not the account owner, reach out to your admin or team lead
   - Explain when the error started occurring
   - Provide the affected API key prefix for identification

3. **For account administrators: Contact support**
   <!-- Source: FAQ advice from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40131-knowledge.md lines 41-45 -->
   - If you're the admin and didn't revoke the key, contact Ably support
   - Provide context about the key usage and any recent changes
   - Include any security notifications you may have received

4. **Use an alternative key temporarily**
   <!-- Source: FAQ advice from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40131-knowledge.md line 33 -->
   - If available, switch to a backup API key
   - Generate a new key if restoration isn't immediately possible
   - Update your application configuration with the new credentials

## Automatic Handling
This is a client error that will not be automatically retried. The API key must be restored or replaced before authentication will succeed.

## Common Troubleshooting Scenarios

### CI/CD Pipeline Failures
<!-- Source: Support patterns from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40131-knowledge.md lines 115-116 -->
If your automated tests or deployments are failing with this error:
- API keys used in CI/CD may have been revoked during security reviews
- Generate dedicated keys for CI/CD environments
- Store CI/CD keys securely in environment secrets

### Push Notification Issues
<!-- Source: Support patterns from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40131-knowledge.md lines 95-97, 117 -->
If device registration or push updates are failing:
- This error can affect push notification device registration
- The error message may appear as "ARTPushActivationStateMachine: update device failed"
- Ensure the key used for push services has not been revoked

### Token Generation Failures
<!-- Source: Support patterns from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40131-knowledge.md lines 99-101, 118 -->
When generating tokens fails with this error:
- A revoked key cannot generate new tokens
- This affects both direct token requests and token authentication flows
- Switch to a valid key for token generation

## Key Revoked vs Other Key States

**Key Revoked (40131)** - Different from other key errors:
<!-- Source: Analysis from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40131-analysis.md lines 33-35 and knowledge file lines 62-68, 121-124 -->
- **Can be restored**: Unlike removed keys (40130), revoked keys can be re-enabled
- **Temporary suspension**: Not a permanent deletion
- **Maintains configuration**: Original key settings are preserved
- **Administrative action**: Requires account admin or support intervention

## Prevention

<!-- Source: FAQ best practices from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40131-knowledge.md lines 56-60 -->
- Monitor key usage patterns and alerts in your dashboard
- Implement proper key lifecycle management
- Use different keys for different environments (development, staging, production)
- Set up monitoring for authentication failures
- Follow [security best practices](https://ably.com/docs/auth#security-best-practice) for key storage

## Related Errors

• **[40130 - Key Removed](https://help.ably.io/error/40130)**  
  Permanent key deletion that cannot be restored, unlike revoked keys

• **[40132 - Key Expired](https://help.ably.io/error/40132)**  
  Time-based expiration requiring new key generation

• **[40101 - Invalid Credentials](https://help.ably.io/error/40101)**  
  General authentication failure that may occur with incorrect keys

## Related Resources
- [API Key Management](https://ably.com/docs/auth#api-key-authentication)
- [Token Authentication](https://ably.com/docs/auth#token-authentication)
- [Security Best Practices](https://ably.com/docs/auth#security-best-practice)

## Need Further Help?

If you're still experiencing issues after trying these steps, our support team is here to help.

**Contact Ably Support**: https://ably.com/support

When contacting support, please provide:
- Your account ID and app ID
- The full error message including error code 40131
- Steps to reproduce the issue
- Any relevant code snippets (without sensitive credentials)
- The SDK and version you're using

Our team will help you resolve this issue as quickly as possible.

<!-- =============================================== -->
<!-- INTERNAL DOCUMENTATION (NOT RENDERED) -->
<!-- =============================================== -->

<!-- SOURCES USED (ALWAYS use GitHub URLs with current SHA, never local paths):
- Analysis File: https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40131-analysis.md
- Knowledge File: https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40131-knowledge.md
- Editorial Notes: https://github.com/ably/ably-os/blob/5f4ba43/src/prompts/errors/editorial-notes.md
- Existing Documentation: https://github.com/ably/docs/blob/main/src/pages/docs/platform/errors/codes/40131-key-revoked.mdx (enhanced and updated)
-->

<!-- CONTENT DECISIONS:
- FAQ Content Preserved: Resolution steps and prevention measures from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40131-knowledge.md lines 31-60
- Content Excluded: Internal Slack discussion details and specific support ticket numbers from lines 85-111
- Recommendations Source: Based on FAQ experience and support patterns documented in knowledge file
- Code Examples Rationale: No code examples included as this is an administrative issue, not a coding problem
- Enhanced Content: Added Common Troubleshooting Scenarios section based on support patterns from knowledge file lines 113-119
-->

<!-- ATTRIBUTION BY SECTION:
- Common Causes: 
  - Administrative suspension: Based on https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40131-knowledge.md lines 13-17
  - Security concerns: From https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40131-knowledge.md lines 19-23
  - Account management: From https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40131-knowledge.md lines 25-29
- Resolution Steps: 
  - Step 1 (Check dashboard): FAQ advice from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40131-knowledge.md lines 36-39
  - Step 2 (Contact admin): FAQ advice from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40131-knowledge.md lines 41-45
  - Step 3 (Contact support): FAQ advice from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40131-knowledge.md lines 41-45
  - Step 4 (Alternative key): FAQ advice from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40131-knowledge.md line 33
- Common Troubleshooting Scenarios:
  - CI/CD Pipeline Failures: Support patterns from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40131-knowledge.md lines 115-116
  - Push Notification Issues: Support patterns from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40131-knowledge.md lines 95-97, 117
  - Token Generation Failures: Support patterns from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40131-knowledge.md lines 99-101, 118
- Key Differences: Based on https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40131-analysis.md lines 33-35 and https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40131-knowledge.md lines 62-68, 121-124
- Prevention: Based on https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/40131-knowledge.md lines 56-60
-->

<!-- URL Validation Completed: 2025-08-24T21-13-57-640Z -->
<!-- External URLs verified: 6 | Corrected: 0 | Exempted internal: 2 -->

<!-- DOCUMENTATION SHORTCOMINGS:
⚠️ Areas where Ably documentation could be improved:
- Missing: Detailed guide on key restoration process and timelines
- Impact: Users uncertain about restoration procedures and expected timeframes
- Recommendation: Add section to auth docs about key lifecycle states and restoration
- Severity: Medium - affects users experiencing key revocation
-->

<!-- IMPROVEMENT INSTRUCTIONS:
To improve this error code documentation:
1. First approach: Update editorial-notes.md in ably-os repository with specific guidance for error 40131
2. Regenerate: Run `./bin/ably-os errors document-error-codes 40131 --force`
3. For broader improvements: Review and update ably-os prompt templates
4. Context: See https://github.com/ably/ably-os/blob/5f4ba43/docs/ERROR_COMMANDS_GUIDE.md
5. Source repository: https://github.com/ably/ably-os
-->