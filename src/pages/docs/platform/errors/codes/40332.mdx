---
title: "Error 40332 - Placement constraint violation"
meta_description: "Information and troubleshooting for Ably error code 40332 - Unable to activate account due to placement constraint (incompatible site)"
meta_keywords: "Ably, error, error codes, 40332, placement constraint, regional restriction, site restriction, environment configuration"
---

{/* Generated by: ably-os errors document-error-codes */}
{/* Repository: https://github.com/ably/ably-os */}
{/* Command: ./bin/ably-os errors document-error-codes 40332 */}
{/* Generated: 2025-11-07T08-36-41-586Z */}
{/* Sources:
     - Analysis: https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40332-analysis.md
     - Knowledge: https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40332-knowledge.md
     - Editorial notes: https://github.com/ably/ably-os/blob/b819713/src/prompts/errors/editorial-notes.md
*/}
{/* Key Approach: Document regional restrictions and environment configuration requirements with clear resolution steps */}
{/* Citations: Complete source attribution with line numbers available at bottom of document */}

Your account is restricted to a specific region, and you're attempting to connect without the correct environment configuration.

| Error code | HTTP status code | Category | Retryable |
| ---------- | ---------------- | -------- | --------- |
| 40332 | 403 | Client error (placement constraint) | No |

## Error messages

The following error message is returned with error code 40332:

| Message | Description |
| ------- | ----------- |
| Unable to activate account due to placement constraint (incompatible site) | The account has regional restrictions and the connection attempt is using an incompatible site or data center. |

## Impact

This error prevents any connection or operation for the affected account:

- Account activation is blocked at the requested site.
- No operations can proceed until the correct environment is configured.
- All API calls will fail with this error until resolved.

This error will not be automatically retried as it indicates a configuration issue that requires manual intervention. The account's placement constraints must be satisfied by connecting to the correct regional endpoint.

{/* Source: Analysis from https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40332-analysis.md lines 8-10 */}

## Troubleshooting

### Regional restriction mismatch

| Error messages |
| -------------- |
| Unable to activate account due to placement constraint (incompatible site) |

This occurs when:

- Your account is restricted to a specific region (EU-only, US-only, APAC, China, etc.).
- You're using the global endpoint (`realtime.ably.io` or `rest.ably.io`) instead of a regional endpoint.
- The SDK is missing the required environment configuration for your regional account.
- You're attempting to connect to the wrong regional endpoint.

{/* Source: Analysis finding from https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40332-analysis.md lines 73-75 */}
{/* Source: Knowledge from https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40332-knowledge.md lines 56-62 */}

To resolve this:

- Check if your account has regional constraints by contacting your account manager or support.
- Use the custom environment provided when your account was set up.
- Configure the environment in your SDK's `ClientOptions`.
- For specific regions:
  - **China**: Use `cn-rest.ably.io` and `cn-realtime.ably.io`.
  - **EU**: Ensure the EU environment is specified in your configuration.
  - **Custom deployments**: Use the environment string provided (e.g., `acme-realtime.ably.io`).

<Code>
```javascript
// Wrong: Using global endpoint for region-restricted account
const ably = new Ably.Realtime({
  key: 'your-api-key'
});

// Correct: Specify the custom environment
const ably = new Ably.Realtime({
  key: 'your-api-key',
  environment: 'your-custom-environment'  // e.g., 'eu', 'cn', or custom domain prefix
});

// For China region specifically
const ablyChina = new Ably.Realtime({
  key: 'your-china-api-key',
  restHost: 'cn-rest.ably.io',
  realtimeHost: 'cn-realtime.ably.io'
});
```
</Code>

{/* Source: FAQ advice from https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40332-analysis.md lines 121-127 */}
{/* Source: China region example from https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40332-analysis.md lines 99-103 */}

## Prevention

To avoid this error in the future:

- Always check if your Ably account has regional restrictions during initial setup.
- Store environment configuration in your application's configuration files rather than hardcoding.
- Use environment variables to manage different environments (development, staging, production).
- Document your regional restrictions for your development team.
- Test connections immediately after account setup to verify correct configuration.

{/* Source: Best practices derived from https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40332-knowledge.md lines 95-113 */}

## Related errors

The following errors are related to error code 40332:

| Error code | Description |
| ---------- | ----------- |
| [40331 - Placement constraint violation (environment)](/docs/platform/errors/codes/40331) | Similar constraint violation but at the environment level rather than site level. |

{/* Source: Related error from https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40332-analysis.md lines 59-63 */}

## Need further help?

Contact [Ably support](https://ably.com/support) if you're still experiencing issues after trying the steps listed above.

You'll need to provide:

- Your account ID and app ID.
- The full error message including the error code.
- Steps to reproduce the issue.
- Any relevant code snippets (without any sensitive credentials).
- The SDK and version you're using.

### Resources

The following resources provide further context or assistance with this error:

- [Authentication](/docs/auth)
- [Connection state management](/docs/realtime/connection)

{/* =============================================== */}
{/* INTERNAL DOCUMENTATION (NOT RENDERED) */}
{/* =============================================== */}

{/* SOURCES USED (ALWAYS use GitHub URLs with current SHA, never local paths):
- Analysis File: https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40332-analysis.md
- Knowledge File: https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40332-knowledge.md
- Editorial Notes: https://github.com/ably/ably-os/blob/b819713/src/prompts/errors/editorial-notes.md - No specific error-specific notes for 40332
- Existing FAQ: https://faqs.ably.com/error-code-40332-unable-to-activate-account-due-to-placement-constraint-incompatible-site
*/}

{/* CONTENT DECISIONS:
- FAQ Content Preserved: Regional restriction explanation and custom environment requirement from FAQ site
- Content Excluded: Internal implementation details about regex patterns and checkSite() function
- Recommendations Source:
  - Primary resolution from FAQ and existing docs
  - China region specifics from analysis lines 99-103
  - QoS monitoring context from knowledge lines 64-69
- Code Examples Rationale: Included to show correct environment configuration as this is essential for resolution
*/}

{/* ATTRIBUTION BY SECTION:
- Error Overview:
  - Error definition from https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40332-analysis.md lines 8-10
- Troubleshooting:
  - Regional restrictions from https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40332-analysis.md lines 73-75
  - China example from https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40332-analysis.md lines 99-103
  - FAQ preservation from https://faqs.ably.com/error-code-40332
- Prevention:
  - Best practices derived from https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40332-knowledge.md lines 95-113
- Related Errors:
  - 40331 relationship from https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40332-analysis.md lines 59-63
*/}

{/* URL Validation Completed: 2025-11-07T08-36-41-586Z */}
{/* External URLs verified: 2 | Corrected: 0 | Exempted internal: 5 */}

{/* IMPROVEMENT INSTRUCTIONS:
To improve this error code documentation:
1. First approach: Update editorial-notes.md in ably-os repository with specific guidance for error 40332
2. Regenerate: Run `./bin/ably-os errors document-error-codes 40332 --force`
3. For broader improvements: Review and update ably-os prompt templates
4. Context: See https://github.com/ably/ably-os/blob/b819713/docs/ERROR_COMMANDS_GUIDE.md
5. Source repository: https://github.com/ably/ably-os
*/}