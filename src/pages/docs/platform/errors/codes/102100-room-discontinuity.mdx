<!-- Generated by: ably-os errors document-error-codes -->
<!-- Repository: https://github.com/ably/ably-os -->
<!-- Command: ./bin/ably-os errors document-error-codes 102100 -->
<!-- Generated: 2025-08-24T21-13-57-640Z -->
<!-- Sources: 
     - Analysis: https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/102100-analysis.md
     - Knowledge: https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/102100-knowledge.md
     - Editorial notes: https://github.com/ably/ably-os/blob/5f4ba43/src/prompts/errors/editorial-notes.md
-->
<!-- Key Approach: Enhanced documentation for room discontinuity error with comprehensive recovery patterns and platform-specific guidance -->
<!-- Citations: Complete source attribution with line numbers available at bottom of document -->

# Error 102100: Room discontinuity

## What Happened

Your chat room has experienced a discontinuity where the connection was re-established but previous state could not be preserved, requiring your application to re-synchronize with the server.

## Quick Reference

| Error Code | HTTP Status | Category | Retryable |
|------------|-------------|----------|-----------|
| 102100 | 400/500 | Room Lifecycle (Chat SDK) | Yes - requires room re-attachment |

## Quick Fix

- Listen for discontinuity events in your application
- Re-attach the affected room when this error occurs
- Retrieve missed messages using the history API
- Update your UI to reflect the synchronized state

## Error Messages

You may encounter one of these messages:
- "discontinuity detected"
- "Discontinuity detected, [original error message]"
- "The room has experienced a discontinuity"

The specific message varies by SDK but all indicate the same underlying discontinuity condition.

## Common Causes

1. **Extended network disconnection** (most common)
   - Connection lost for more than 2 minutes
   - Exceeds automatic recovery window
   - Channel state cannot be preserved across reconnection
   <!-- Source: Analysis finding from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/102100-analysis.md lines 81-87 -->

2. **Server-side connection termination**
   - Load balancing operations
   - Server maintenance or rolling updates
   - Connection shedding for resource management
   - Regional failover events
   <!-- Source: Based on knowledge from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/102100-knowledge.md lines 113-115 -->

3. **Channel state loss**
   - Channel re-attaches without the `resumed` flag
   - Previous message continuity cannot be guaranteed
   - Presence set may be outdated
   - Requires full state resynchronization
   <!-- Source: Analysis finding from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/102100-analysis.md lines 81-87 -->

## Resolution Steps

1. **Subscribe to discontinuity events**
   ```javascript
   // JavaScript/TypeScript
   room.on('discontinuity', (error) => {
     if (error.code === 102100) {
       handleDiscontinuity();
     }
   });
   ```
   
   ```kotlin
   // Kotlin/Android
   room.onDiscontinuity { error ->
     if (error.code == 102100) {
       handleDiscontinuity()
     }
   }
   ```
   
   ```swift
   // Swift/iOS
   room.onDiscontinuity { event in
     if event.error.code == 102100 {
       handleDiscontinuity()
     }
   }
   ```
   <!-- Source: Code patterns from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/102100-knowledge.md lines 132-157 -->

2. **Re-attach the affected room**
   - Call the room's `attach()` method
   - Wait for successful attachment confirmation
   - This restores connectivity to all room features (messages, presence, typing indicators, reactions)
   <!-- Source: Recovery pattern from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/102100-knowledge.md lines 86-96 -->

3. **Synchronize room state**
   - Retrieve missed messages using `getPreviousMessages()` or the history API
   - Update your local message list with the fetched history
   - Re-synchronize presence information if your app uses it
   - Reset any typing indicators or ephemeral state
   <!-- Source: Based on recovery requirements from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/102100-knowledge.md lines 91-96 -->

4. **Update your UI appropriately**
   - Display a reconnection indicator during recovery
   - Queue outgoing messages while recovering (or inform users they're temporarily offline)
   - Clear the reconnection indicator once synchronization completes
   - Consider showing a subtle notification that the room was reconnected
   <!-- Source: Best practices from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/102100-knowledge.md lines 169-175 -->

## Automatic Handling

The Ably Chat SDK automatically:
- Detects discontinuities when channels re-attach without preserving state
- Emits discontinuity events to your application for handling
- Manages transient disconnections (under 2 minutes) transparently without emitting this error
- Preserves message history on the server that can be retrieved after recovery
- Tracks the `hasAttachedOnce` flag to differentiate initial connection failures from discontinuities
<!-- Source: SDK behavior from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/102100-analysis.md lines 83-87 and https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/102100-knowledge.md lines 82-84 -->

## Code Examples

### Complete Recovery Implementation (JavaScript/TypeScript)
```javascript
// Set up discontinuity handler
room.on('discontinuity', async (error) => {
  if (error.code === 102100) {
    console.log('Room discontinuity detected, recovering...');
    
    // Show reconnecting UI
    showReconnectingIndicator();
    
    try {
      // Re-attach the room
      await room.attach();
      
      // Fetch missed messages
      const history = await room.messages.getPreviousMessages({ 
        limit: 100 
      });
      
      // Update message list (reverse to get chronological order)
      const missedMessages = history.items.reverse();
      updateMessageList(missedMessages);
      
      // Re-sync presence if used
      const members = await room.presence.get();
      updatePresenceList(members);
      
      // Clear reconnecting indicator
      hideReconnectingIndicator();
      showToast('Room reconnected successfully');
      
    } catch (recoveryError) {
      console.error('Failed to recover from discontinuity:', recoveryError);
      showErrorMessage('Unable to reconnect. Please refresh the page.');
    }
  }
});
```
<!-- Source: Code pattern adapted from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/102100-knowledge.md lines 132-138, enhanced with comprehensive recovery steps -->

### Robust Recovery with Message Queuing (Kotlin/Android)
```kotlin
class ChatRoomManager {
    private val messageQueue = mutableListOf<PendingMessage>()
    private var isRecovering = false
    
    fun setupDiscontinuityHandler(room: Room) {
        room.onDiscontinuity { error ->
            if (error.code == 102100) {
                handleDiscontinuity(room)
            }
        }
    }
    
    private suspend fun handleDiscontinuity(room: Room) {
        isRecovering = true
        showReconnectingUI()
        
        try {
            // Re-attach room
            room.attach()
            
            // Sync messages
            val history = room.messages.getPreviousMessages(100)
            updateMessageList(history)
            
            // Process queued messages
            messageQueue.forEach { pending ->
                room.messages.send(pending.text)
            }
            messageQueue.clear()
            
            isRecovering = false
            hideReconnectingUI()
            
        } catch (e: Exception) {
            showError("Failed to reconnect: ${e.message}")
        }
    }
    
    fun sendMessage(text: String) {
        if (isRecovering) {
            messageQueue.add(PendingMessage(text))
            showToast("Message queued")
        } else {
            room.messages.send(text)
        }
    }
}
```
<!-- Source: Code pattern adapted from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/102100-knowledge.md lines 141-147, enhanced with message queuing -->

### Graceful Recovery with State Management (Swift/iOS)
```swift
class ChatRoomViewModel: ObservableObject {
    @Published var connectionState = ConnectionState.connected
    private var room: Room
    
    func setupDiscontinuityHandler() {
        room.onDiscontinuity { [weak self] event in
            guard event.error.code == 102100 else { return }
            
            Task {
                await self?.recoverFromDiscontinuity()
            }
        }
    }
    
    @MainActor
    private func recoverFromDiscontinuity() async {
        connectionState = .recovering
        
        do {
            // Re-attach room
            try await room.attach()
            
            // Sync latest messages
            let history = try await room.messages.getPreviousMessages(
                options: .init(limit: 100)
            )
            
            // Update UI with synced messages
            await MainActor.run {
                self.messages = history.items.reversed()
                self.connectionState = .connected
            }
            
            // Show success notification
            showNotification("Chat reconnected")
            
        } catch {
            connectionState = .disconnected
            showError("Unable to reconnect: \(error.localizedDescription)")
        }
    }
}
```
<!-- Source: Code pattern adapted from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/102100-knowledge.md lines 151-157, enhanced with SwiftUI state management -->

## Prevention

While network discontinuities cannot be completely prevented, you can minimize their impact:

- **Implement robust event handlers**: Set up discontinuity listeners immediately after creating rooms
- **Design for resilience**: Build your UI to gracefully handle temporary disconnections
- **Cache recent messages**: Store recent messages locally for immediate display during recovery
- **Use visual indicators**: Keep users informed with connection status badges or banners
- **Consider message queuing**: Queue outgoing messages during recovery rather than failing immediately
- **Test recovery flows**: Regularly test discontinuity scenarios in development
<!-- Source: Best practices derived from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/102100-knowledge.md lines 169-175 -->

## Performance Impact

When this error occurs:
- **Message delivery**: Temporarily interrupted until re-attachment
- **Presence accuracy**: May show outdated member list until synchronized
- **Typing indicators**: Will be reset and need to be re-established
- **Reactions**: Ephemeral reactions may be lost during the discontinuity period
- **History retrieval**: Available immediately after re-attachment

## Related Resources

- [Ably Chat documentation](https://ably.com/docs/chat)
- [Connection state management](https://ably.com/docs/connect)
- [Message history](https://ably.com/docs/storage-history)
- [Chat SDK on GitHub](https://github.com/ably/ably-chat-js)

## Related Errors

• **[102101 - Room Failed](https://help.ably.io/error/102101)**  
  Room entered a failed state requiring manual recovery or recreation

• **[102106 - Room Released](https://help.ably.io/error/102106)**  
  Operation attempted on a room that has been released from memory

• **[102103 - Room Is Released](https://help.ably.io/error/102103)**  
  Room has been fully released and cannot be used

• **[102102 - Room Is Releasing](https://help.ably.io/error/102102)**  
  Operation attempted while room is in the process of being released

## Need Further Help?

If you're still experiencing issues after trying these steps, our support team is here to help.

**Contact Ably Support**: https://ably.com/support

When contacting support, please provide:
- Your account ID and app ID
- The full error message including error code 102100
- Steps to reproduce the issue
- Any relevant code snippets (without sensitive credentials)
- The SDK and version you're using

Our team will help you resolve this issue as quickly as possible.

<!-- =============================================== -->
<!-- INTERNAL DOCUMENTATION (NOT RENDERED) -->
<!-- =============================================== -->

<!-- SOURCES USED (ALWAYS use GitHub URLs with current SHA, never local paths):
- Analysis File: https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/102100-analysis.md
- Knowledge File: https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/102100-knowledge.md
- Editorial Notes: https://github.com/ably/ably-os/blob/5f4ba43/src/prompts/errors/editorial-notes.md (No specific error-specific notes for 102100)
- Existing Documentation: https://github.com/ably/docs/blob/main/src/pages/docs/platform/errors/codes/102100-room-discontinuity.mdx (enhanced and improved)
- Repository Overviews: Not needed for this Chat SDK-specific error
-->

<!-- CONTENT DECISIONS:
- FAQ Content Preserved: No FAQ content existed for this error code
- Content Excluded: Internal implementation details about CHA-RL12a/b specifications (too technical for users)
- Recommendations Source: Based on SDK implementation patterns from analysis and Slack discussions about discontinuity handling
- Code Examples Rationale: Included comprehensive platform-specific examples as they are essential for proper recovery implementation
-->

<!-- ATTRIBUTION BY SECTION:
- Common Causes: 
  - Cause 1: Based on analysis findings in https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/102100-analysis.md lines 81-87
  - Cause 2: From knowledge base https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/102100-knowledge.md lines 113-115
  - Cause 3: From analysis https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/102100-analysis.md lines 81-87
- Resolution Steps: 
  - Step 1: Code patterns from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/102100-knowledge.md lines 132-157
  - Step 2: Recovery pattern from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/102100-knowledge.md lines 86-96
  - Step 3: Based on https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/102100-knowledge.md lines 91-96
  - Step 4: Best practices from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/102100-knowledge.md lines 169-175
- Prevention: Based on https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/102100-knowledge.md lines 169-175
- Automatic Handling: Combined from https://github.com/ably/ably-os/blob/5f4ba43/output/error-codes/research/102100-analysis.md lines 83-87 and knowledge file
-->

<!-- URL Validation Completed: 2025-08-24T21-13-57-640Z -->
<!-- External URLs verified: 5 | Corrected: 0 | Exempted internal: 4 -->

<!-- IMPROVEMENT INSTRUCTIONS:
To improve this error code documentation:
1. First approach: Update editorial-notes.md in ably-os repository with specific guidance for error 102100
2. Regenerate: Run `./bin/ably-os errors document-error-codes 102100 --force`
3. For broader improvements: Review and update ably-os prompt templates
4. Context: See https://github.com/ably/ably-os/blob/5f4ba43/docs/ERROR_COMMANDS_GUIDE.md
5. Source repository: https://github.com/ably/ably-os
-->