---
title: "Error 40012 - Invalid client ID"
meta_description: "Understand and resolve error code 40012, which occurs when a client ID fails validation due to format, type, or compatibility issues."
meta_keywords: "error 40012, invalid client ID, client ID validation, presence error, authentication error, Ably errors"
---

{/* Generated by: ably-os errors document-error-codes */}
{/* Repository: https://github.com/ably/ably-os */}
{/* Command: ./bin/ably-os errors document-error-codes 40012 */}
{/* Generated: 2025-11-07T01-37-30-412Z */}
{/* Sources:
     - Analysis: https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40012-analysis.md
     - Knowledge: https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40012-knowledge.md
     - Editorial notes: https://github.com/ably/ably-os/blob/b819713/src/prompts/errors/editorial-notes.md
*/}
{/* Key Approach: Comprehensive documentation covering all validation scenarios with emphasis on presence operations and client ID compatibility */}
{/* Citations: Complete source attribution with line numbers available at bottom of document */}

This error occurs when the provided client ID fails validation rules, including empty strings, reserved wildcards, type mismatches, or conflicts with authenticated credentials.

| Error Code | HTTP Status | Category | Retryable |
|------------|-------------|----------|-----------|
| 40012 | 400 | Client Error (Authentication/Validation) | No |

## Error messages

You may see one of these error messages:

| Message | Context |
|---------|---------|
| `clientId can't be an empty string` | Empty string provided as client ID |
| `Can't use "*" as a clientId as that string is reserved` | Attempting to use wildcard outside token params |
| `clientId must be either a string or null` | Non-string/non-null value provided |
| `clientId must be specified` | Presence operation without client ID |
| `Incompatible clientId specified in message` | Message client ID conflicts with authenticated client ID |
| `invalid clientId; must be base64 encoded if passed by header` | Server-side header validation failure |

## Impact

This error prevents the current operation from completing:
- Authentication initialization will fail
- Presence operations (enter/leave/update) will be blocked
- Message publishing with mismatched client ID will be rejected
- Token requests with invalid client ID will fail

This error cannot be automatically retried. You must fix the client ID value or configuration before retrying the operation.

## Troubleshooting

The following are common causes and solutions for error 40012:

### Empty string client ID

| Error message |
|---------------|
| `clientId can't be an empty string` |

This occurs when:
- An empty string (`""`) is provided as the client ID
- Token request specifies an empty client ID

To resolve this:
- Provide a non-empty string client ID
- Use `null` instead of an empty string if client ID is optional
- Remove the client ID parameter entirely if not needed

{/* Source: Analysis findings from https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40012-analysis.md lines 21-24 */}
{/* Source: Knowledge base from https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40012-knowledge.md lines 28-31 */}

### Wildcard client ID misuse

| Error message |
|---------------|
| `Can't use "*" as a clientId as that string is reserved` |
| `Wildcard client_id is reserved and cannot be used when publishing messages` |

This occurs when:
- Using the wildcard `"*"` as a regular client ID
- Setting `"*"` in REST client initialization
- Using wildcard in presence operations

To resolve this:
- Use wildcard only in `defaultTokenParams` or `authorize` token params
- Never use `"*"` as a regular client ID for REST operations
- For wildcard capabilities, configure it properly in token authentication:

  See the [token authentication documentation](https://ably.com/docs/auth/token) for configuring wildcard capabilities.

{/* Source: Analysis findings from https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40012-analysis.md lines 31-37 */}
{/* Source: FAQ Legacy from https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40012-knowledge.md lines 33-38 */}

### Client ID type validation failure

| Error message |
|---------------|
| `clientId must be either a string or null` |
| `Invalid token; clientId must be a string` |

This occurs when:
- Passing a non-string value (number, object, boolean) as client ID
- JWT contains a non-string client ID field

To resolve this:
- Ensure client ID is either a string or `null`
- Validate the data type before setting client ID
- Check token generation code to ensure proper type

{/* Source: Analysis findings from https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40012-analysis.md lines 26-29 */}

### Client ID mismatch

| Error message |
|---------------|
| `clientId provided in ClientOptions must match clientId in token` |
| `Incompatible clientId specified in message` |
| `Cannot publish with client_id '{}' as it is incompatible with the current configured client_id '{}'` |

This occurs when:
- Token client ID doesn't match configured client ID
- Message client ID conflicts with authenticated client ID
- Publishing with a different client ID than authenticated

To resolve this:
- Ensure consistent client ID across token requests and client options
- Use the same client ID throughout a session
- Don't override client ID in messages if already authenticated with a different one

{/* Source: Analysis findings from https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40012-analysis.md lines 193-196 */}
{/* Source: Knowledge findings from https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40012-knowledge.md lines 44-48 */}

### Missing client ID for presence operations

| Error message |
|---------------|
| `clientId must be specified` |
| `clientId must be specified to update presence data` |
| `clientId must have been specified to enter or leave a presence channel` |

This occurs when:
- Attempting presence enter without a client ID
- Trying to update presence without being identified
- Leaving presence without having entered with a client ID

To resolve this:
- Set client ID in authentication options before presence operations
- Configure client ID in token or API key capabilities
- Ensure client ID is set when initializing the client:

  Refer to the [presence documentation](https://ably.com/docs/presence) for configuring client ID.

{/* Source: Analysis findings from https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40012-analysis.md lines 35-49 */}
{/* Source: FAQ advice from https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40012-knowledge.md lines 49-53 */}

### Base64 encoding in headers

| Error message |
|---------------|
| `invalid clientId; must be base64 encoded if passed by header` |

This occurs when:
- Passing client ID via `X-Ably-Clientid` header without base64 encoding
- Server-side validation of header-based client ID fails

To resolve this:
- Base64 encode the client ID when using the header approach
- Alternatively, use the query parameter `clientId` which doesn't require encoding
- Prefer SDK authentication methods over manual header construction

{/* Source: Server implementation from https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40012-analysis.md lines 141-144 */}

## Prevention

To avoid client ID validation errors:

- Always validate client ID is a non-empty string before use
- Never use the wildcard `"*"` except in token parameters
- Set client ID consistently at initialization, not per-operation
- Use SDK authentication methods rather than manual header construction
- For presence channels, configure client ID before attempting any presence operations
- Ensure token generation produces string-typed client IDs

## Related errors

The following errors are related to error code 40012:

| Error code | Description |
| ---------- | ----------- |
| [40003 - Invalid timestamp](/docs/platform/errors/codes/40003) | May occur alongside client ID errors during authentication |
| [40005 - Authentication failed](/docs/platform/errors/codes/40005) | General authentication failure that can include client ID issues |
| [40101 - Invalid credentials](/docs/platform/errors/codes/40101) | Credential validation that may involve client ID checking |
| [91000 - Unable to enter presence](/docs/platform/errors/codes/91000) | Specific presence error often caused by missing client ID |

## Need further help?

Contact [Ably support](https://ably.com/support) if you're still experiencing issues after trying the steps listed above.

You'll need to provide:

- Your account ID and app ID.
- The full error message including the error code.
- Steps to reproduce the issue.
- Any relevant code snippets (without any sensitive credentials).
- The SDK and version you're using.

### Resources

- [Authentication documentation](https://ably.com/docs/auth)
- [Presence documentation](https://ably.com/docs/presence)
- [Token authentication guide](https://ably.com/docs/auth/token)

{/* =============================================== */}
{/* INTERNAL DOCUMENTATION (NOT RENDERED) */}
{/* =============================================== */}

{/* SOURCES USED:
- Analysis File: https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40012-analysis.md
- Knowledge File: https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40012-knowledge.md
- Editorial Notes: https://github.com/ably/ably-os/blob/b819713/src/prompts/errors/editorial-notes.md
*/}

{/* CONTENT DECISIONS:
- FAQ Content Preserved: Wildcard usage guidance from https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40012-knowledge.md lines 33-38, 99-101
- Content Excluded: Specific SDK implementation details to avoid code examples without verification
- Recommendations Source: Based on validation patterns found across all SDKs in analysis
- Code Examples Rationale: Excluded as per guidance - linking to documentation instead
*/}

{/* ATTRIBUTION BY SECTION:
- Common Causes:
  - Empty string: Analysis https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40012-analysis.md lines 177-179
  - Wildcard: Analysis https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40012-analysis.md lines 181-186
  - Type validation: Analysis https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40012-analysis.md lines 188-191
  - Mismatch: Analysis https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40012-analysis.md lines 193-196
  - Presence: Analysis https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40012-analysis.md lines 198-200
- Resolution Steps:
  - Empty string fix: Knowledge https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40012-knowledge.md lines 95-97
  - Wildcard fix: Knowledge https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40012-knowledge.md lines 99-101
  - Type fix: Knowledge https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40012-knowledge.md lines 113-115
  - Mismatch fix: Knowledge https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40012-knowledge.md lines 103-108
  - Presence fix: Knowledge https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40012-knowledge.md lines 109-112
  - Base64 fix: Knowledge https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40012-knowledge.md lines 117-119
*/}

{/* URL Validation Completed: 2025-11-07T01-37-30-412Z */}
{/* External URLs verified: 4 | Corrected: 0 | Exempted internal: 6 */}

{/* IMPROVEMENT INSTRUCTIONS:
To improve this error code documentation:
1. First approach: Update editorial-notes.md in ably-os repository with specific guidance for error 40012
2. Regenerate: Run `./bin/ably-os errors document-error-codes 40012 --force`
3. For broader improvements: Review and update ably-os prompt templates
4. Context: See https://github.com/ably/ably-os/blob/b819713/docs/ERROR_COMMANDS_GUIDE.md
5. Source repository: https://github.com/ably/ably-os
*/}