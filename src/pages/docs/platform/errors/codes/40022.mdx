---
title: "Error 40022 - API Streamer deprecated / Invalid resource"
meta_description: "Information and troubleshooting for Ably error code 40022 - API Streamer deprecated or Invalid resource"
meta_keywords: "Ably, error, error codes, 40022, API Streamer, exchange channels, validation error, Control API"
---

{/* Generated by: ably-os errors document-error-codes */}
{/* Repository: https://github.com/ably/ably-os */}
{/* Command: ./bin/ably-os errors document-error-codes 40022 */}
{/* Generated: 2025-11-07T01-37-30-412Z */}
{/* Sources:
     - Analysis: https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40022-analysis.md
     - Knowledge: https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40022-knowledge.md
     - Editorial notes: https://github.com/ably/ably-os/blob/b819713/src/prompts/errors/editorial-notes.md
*/}
{/* Key Approach: Document both API Streamer deprecation (primary) and Control API validation errors (secondary) */}
{/* Citations: Complete source attribution with line numbers available at bottom of document */}

This error occurs when attempting to use deprecated API Streamer channels or when resource validation fails in the Control API.

| Error code | HTTP status code | Category | Retryable |
| ---------- | ---------------- | -------- | --------- |
| 40022 | 400 / 422 | Client error (deprecation / validation) | No |

## Error messages

The following error messages can be returned with error code 40022:

| Message | Description |
| ------- | ----------- |
| API Streamer is no longer offered, contact support@ably.com for more information | Attempt to use deprecated exchange channels. |
| Invalid resource | Control API validation failure with details in response. |

## Impact

This error prevents the current operation from completing. Specifically:

- **API Streamer errors**: Channel attachment fails completely, preventing all operations on exchange channels.
- **Control API errors**: The requested resource operation fails but does not affect existing resources.

This is a client error that will not be automatically retried. For API Streamer errors, you must migrate to supported channel patterns. For Control API validation errors, you must fix the validation issues before retrying.

## Troubleshooting

The following are common causes and how to resolve them for error 40022:

### API Streamer deprecation

| Error messages |
| -------------- |
| API Streamer is no longer offered, contact support@ably.com for more information |

This occurs when:

- Attempting to attach to channels starting with `[product:`.
- Using legacy exchange channel patterns (xchg channels).
- Following outdated documentation that references API Streamer.

{/* Source: Analysis from https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40022-analysis.md lines 16-55 */}

To resolve this:

- Remove or replace any channels starting with `[product:` from your application.
- Use standard Ably channel naming patterns instead.
- Contact support@ably.com for assistance migrating from API Streamer to supported alternatives.

{/* Source: Knowledge from https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40022-knowledge.md lines 24-31 */}

### Control API validation errors

| Error messages |
| -------------- |
| Invalid resource |

This occurs when:

- Creating rules with incompatible `enveloped` and `requestMode` settings.
- Referencing non-existent resources (queues, API keys).
- Using invalid regions or parameters.
- Providing duplicate resource names.

{/* Source: Analysis from https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40022-analysis.md lines 76-83 */}

To resolve this:

Check the `details` field in the error response for specific validation failures:

#### Rule configuration issues

For enveloped/requestMode errors:
- Use `enveloped=true` with `requestMode=batch`.
- Use `enveloped=false` with `requestMode=single`.
- Some rule types (CloudFlare, IFTTT, Zapier) don't support the enveloped parameter.

{/* Source: Knowledge from https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40022-knowledge.md lines 37-40, 56-67, 125-129 */}

#### Queue region validation

For invalid region errors:
- Use valid regions: `us-east-1-a`, `eu-west-1-a`.
- Check the error details for the complete list of supported regions.

{/* Source: Knowledge from https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40022-knowledge.md lines 69-71 */}

#### Resource not found

For missing resource errors:
- Verify the queue ID exists before creating AMQP rules.
- Ensure API keys referenced in rules are valid.
- Check that all resource IDs in your request are correct.

{/* Source: Knowledge from https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40022-knowledge.md lines 42-45 */}

## Related errors

The following errors can be related to error 40022:

| Error code | Description |
| ---------- | ----------- |
| [40000 - Bad request](/docs/platform/errors/codes/40000) | General client request error that may occur alongside validation failures. |
| [40400 - Not found](/docs/platform/errors/codes/40400) | Resource not found error that may precede 40022 validation errors. |

## Need further help?

Contact [Ably support](https://ably.com/support) if you're still experiencing issues after trying the steps listed above.

You'll need to provide:

- Your account ID and app ID.
- The full error message including the error code.
- Steps to reproduce the issue.
- Any relevant code snippets (without any sensitive credentials).
- The SDK and version you're using.

### Resources

The following resources provide further context or assistance with this error:

- [Channel naming conventions](https://ably.com/docs/channels)
- [Control API documentation](https://ably.com/docs/account/control-api)
- [Integration rules](https://ably.com/docs/general/integrations)

{/* =============================================== */}
{/* INTERNAL DOCUMENTATION (NOT RENDERED) */}
{/* =============================================== */}

{/* SOURCES USED (ALWAYS use GitHub URLs with current SHA, never local paths):
- Analysis File: https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40022-analysis.md
- Knowledge File: https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40022-knowledge.md
- Editorial Notes: https://github.com/ably/ably-os/blob/b819713/src/prompts/errors/editorial-notes.md - No specific error-specific notes for 40022
- Existing Documentation: None found
*/}

{/* CONTENT DECISIONS:
- FAQ Content Preserved: Migration path advice from https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40022-knowledge.md lines 24-31
- Content Excluded: Detailed implementation variations across SDKs (not needed for customer resolution)
- Recommendations Source:
  - API Streamer: Contact support for migration (knowledge lines 31, 89)
  - Control API: Check details field (knowledge lines 123)
- Code Examples Rationale: No code examples included as resolution involves configuration changes, not code changes
*/}

{/* ATTRIBUTION BY SECTION:
- Common Causes:
  - API Streamer: Based on analysis findings in https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40022-analysis.md lines 16-55
  - Control API validation: From analysis at https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40022-analysis.md lines 59-83
- Resolution Steps:
  - API Streamer migration: Knowledge from https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40022-knowledge.md lines 118-120
  - Rule configuration: Knowledge from https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40022-knowledge.md lines 125-129
  - Queue regions: Knowledge from https://github.com/ably/ably-os/blob/b819713/output/error-codes/research/40022-knowledge.md lines 69-71
*/}

{/* URL Validation Completed: 2025-11-07T01-37-30-412Z */}
{/* External URLs verified: 3 | Corrected: 3 | Exempted internal: 6 */}

{/* IMPROVEMENT INSTRUCTIONS:
To improve this error code documentation:
1. First approach: Update editorial-notes.md in ably-os repository with specific guidance for error 40022
2. Regenerate: Run `./bin/ably-os errors document-error-codes 40022 --force`
3. For broader improvements: Review and update ably-os prompt templates
4. Context: See https://github.com/ably/ably-os/blob/b819713/docs/ERROR_COMMANDS_GUIDE.md
5. Source repository: https://github.com/ably/ably-os
*/}